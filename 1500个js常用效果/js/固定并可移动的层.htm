<style>
<!--
BODY{FONT-FAMILY: 宋体; FONT-SIZE: 12.6px;
SCROLLBAR-HIGHLIGHT-COLOR: buttonface;
SCROLLBAR-SHADOW-COLOR: buttonface;
SCROLLBAR-3DLIGHT-COLOR: buttonhighlight;
SCROLLBAR-TRACK-COLOR: #eeeeee;
SCROLLBAR-DARKSHADOW-COLOR: buttonshadow}
td,form,select {FONT-SIZE: 12px; LINE-HEIGHT: 20px}
input {FONT-SIZE: 12px; BORDER: #000000 1px solid;height: 18px; BACKGROUND-color: #f7f7ff; COLOR: #000000;}
.small {FONT-SIZE: 1px; LINE-HEIGHT: 1px}
.mid {FONT-SIZE: 12px;LINE-HEIGHT: 20px}
A:active {COLOR: #ff0000; TEXT-DECORATION: none}
A:hover {COLOR: #ff0000; TEXT-DECORATION: underline}
A:link {COLOR: #000000; TEXT-DECORATION: none}
A:visited {COLOR: #000000; TEXT-DECORATION: none}
-->
</style>
 
<html>
<head>
<title>仲夏夜--js特效--固定并可移动的层</title>
<meta http-equiv="Content-Type" content="text/html; charset=gb2312">
<LINK href="css/the9.css" 
rel=stylesheet type=text/css>
<style type="text/css">
<!--
.zf {  border: #999999; border-style: solid; border-top-width: 1px; border-right-width: 1px; border-bottom-width: 1px; border-left-width: 1px}
-->
</style>
<script src="ad.js"></script>
</head>
<body bgcolor=#FFFFFF>

<div align="center" > 
****************
    <tr> 
      **********
    </tr>
  </table>
  <table width="770" border="0" cellspacing="0" cellpadding="0" class="zf1">
    <tr>
      ***********
      ************
      *************
          <tr>
**************
 <SCRIPT LANGUAGE="JavaScript">
<!-- Begin
function addbookmark()
{
bookmarkurl="http://5icat.net.ru"
bookmarktitle="欢迎光临仲夏夜"
if (document.all)
window.external.AddFavorite(bookmarkurl,bookmarktitle)
}
//  End -->
</script>
***************</div></td>
          </tr>
          <tr>
            <td height="15"><div align="center"><img src="images/little2.gif" width="9" height="9">
 <span  onclick="var strHref=window.location.href;this.style.behavior='url(#default#homepage)';this.setHomePage('http://5icat.net.ru');"  style="CURSOR: hand"> 设为首页</a></span></div></td>
          </tr>
          <tr>
            <td><div align="center"><img src="images/little3.gif" width="9" height="9"><script src="../mail.js"></script></div></td>
          </tr>
        </table></td>
    </tr>
  </table>
   <table width="770" border="0" cellspacing="0" cellpadding="0" class="zf1">
    <tr> 
      <td  height="20"><table width="768" height="19" border="0" align="center" cellpadding="0" cellspacing="0" background="images/menubg.gif">    
          <script src="js.js"></script>
        </table></td>
    </tr>
  </table>
  <table width="770" border="0" cellspacing="0" cellpadding="0" bgcolor="#CCCCCC"class="zf1">
    <tr>
      <td class="zf3"><script language="JavaScript">
<!--
var enabled = 0; today = new Date();
var day; var date;
if(today.getDay()==0) day = "星期日"
if(today.getDay()==1) day = "星期一"
if(today.getDay()==2) day = "星期二"
if(today.getDay()==3) day = "星期三"
if(today.getDay()==4) day = "星期四"
if(today.getDay()==5) day = "星期五"
if(today.getDay()==6) day = "星期六"
date = "" + (today.getYear()) + "年" + (today.getMonth() + 1 ) + "月" + today.getDate() + "日  " + day +"";
document.write("<font color=black>" + date + "</font>");
-->
</script></td><td align=right>****************</td>
    </tr>
  </table>
<!--<IFRAME width=770 height=60 style="backgroundcolor: #CCCCCC" marginwidth="0" marginheight="0"  frameborder="0" scrolling="NO"   src="ad_top.htm"></IFRAME> -->
  <table width="770" border="0" cellspacing="0" cellpadding="0" >
    <tr>
      <td height="2"></td>
    </tr>
  </table>
  <table width="770" border="0" cellspacing="10" cellpadding="0" bgcolor="#CCCCCC">
    <tr> 
      <td bgcolor="#FFFFFF" height="501" valign="top"> 
        <div align="center"> <br>
          
          
 <table width="700" border="0" cellspacing="0" cellpadding="0">
            <tr>
              <td width="200">&nbsp;</td>
              <td> 
                <table width="300" border="1" cellspacing="0" cellpadding="0" align="center">
                  <tr> 
                    <td bgcolor="#CCCCCC" height="20" width="15">&nbsp;</td>
                    <td bgcolor="#999999" height="20" width="260"> 
					
                      <div align="center"><font color="#FFFFFF" size="3">固定并可移动的层</font></div>
                    </td>
                    <td bgcolor="#CCCCCC" height="20" width="17">&nbsp;</td>
                  </tr>
                </table>
              </td>
              <td width="10"><a href="UserCollect.asp?action=add&id=451" target="Collect">****************</a></td>
            </tr>
          </table>
          <br>
          <fieldset style="width:500;height:50"><legend>效果显示区</legend> 
         
你不拖动它时它是固定在某一方位的
<STYLE type=text/css>
#floater {
	LEFT: 500px; POSITION: absolute; TOP: 120px; VISIBILITY: visible; WIDTH: 125px; Z-INDEX: 10
}
</STYLE>
<DIV align=center id=floater style="HEIGHT: 98px; WIDTH: 240px;">
<TABLE bgColor=#deefaa border=1 borderColor=#008ff0 borderColorDark=#00dd00 
borderColorLight=#ff0033 cellPadding=2 cellSpacing=1 width="98%">
  <TBODY>
  <TR>
    <TD width="100%">
      <P align=center>欢迎大家光临“网络编程站”<BR>JavaScript专栏！</P></TD></TR>
  <TR>
    <TD width="100%">&nbsp;&nbsp;&nbsp;欢迎光临网络编程站，有什么意见和建议请尽管提出来，你的意见就是对我们的促进，我们会尽量为你们服务的.请多多支持我们的工作，成长中的每一步都会有你的足迹！！！<BR>&nbsp;&nbsp;&nbsp; 
      你若有什么好的建议和意见，可以给我<A 
      href="mailto:webmaster@javascript2000.com"><FONT color=#ff0000 
      size=2>来信</FONT></A>，你若有好的例子，站长更希望能向你请教和学习。</TD></TR></TBODY></TABLE></DIV>
<SCRIPT language=JavaScript>                              
self.onError=null;                              
currentX = currentY = 0;                               
whichIt = null;                                         
lastScrollX = 0; lastScrollY = 0;                              
NS = (document.layers) ? 1 : 0;                             
IE = (document.all) ? 1: 0;                              
<!-- STALKER CODE -->                              
function heartBeat() {                              
if(IE) { diffY = document.body.scrollTop; diffX = document.body.scrollLeft; }                             if(NS) { diffY = self.pageYOffset; diffX = self.pageXOffset; }           
if(diffY != lastScrollY) {            
percent = .1 * (diffY - lastScrollY);    
if(percent > 0) percent = Math.ceil(percent); 
else percent = Math.floor(percent);  
if(IE) document.all.floater.style.pixelTop += percent;  
if(NS) document.floater.top += percent;                 
lastScrollY = lastScrollY + percent;      
}                       
if(diffX != lastScrollX) {       
percent = .1 * (diffX - lastScrollX);     
if(percent > 0) percent = Math.ceil(percent);       
else percent = Math.floor(percent);                   
if(IE) document.all.floater.style.pixelLeft += percent;        
if(NS) document.floater.left += percent;       
lastScrollX = lastScrollX + percent;                     
}	                          
}                         
<!-- /STALKER CODE -->              
<!-- DRAG DROP CODE -->              
function checkFocus(x,y) {         
stalkerx = document.floater.pageX;     
stalkery = document.floater.pageY;                        
stalkerwidth = document.floater.clip.width;              
stalkerheight = document.floater.clip.height;                         
if( (x > stalkerx && x < (stalkerx+stalkerwidth)) && (y > stalkery && y < (stalkery+stalkerheight))) return true;                      
else return false;        
}                     
function grabIt(e) {            
if(IE) {                            
whichIt = event.srcElement; 
while (whichIt.id.indexOf("floater") == -1) {    
whichIt = whichIt.parentElement;                           
if (whichIt == null) { return true; }         
 }                            
whichIt.style.pixelLeft = whichIt.offsetLeft;                              
whichIt.style.pixelTop = whichIt.offsetTop;                          
currentX = (event.clientX + document.body.scrollLeft);                       
currentY = (event.clientY + document.body.scrollTop); 	                      
} else {                             
window.captureEvents(Event.MOUSEMOVE);    
if(checkFocus (e.pageX,e.pageY)) {                            
whichIt = document.floater;                              
stalkerTouchedX = e.pageX-document.floater.pageX;      
StalkerTouchedY = e.pageY-document.floater.pageY;          
}                              
}                            
return true;                        
}                            
function moveIt(e) {               
if (whichIt == null) { return false; }       
if(IE) {                             
newX = (event.clientX + document.body.scrollLeft);                           
newY = (event.clientY + document.body.scrollTop);                
distanceX = (newX - currentX);    distanceY = (newY - currentY);   
currentX = newX;    currentY = newY;                       
whichIt.style.pixelLeft += distanceX;                          
whichIt.style.pixelTop += distanceY;                      
if(whichIt.style.pixelTop < document.body.scrollTop) whichIt.style.pixelTop = document.body.scrollTop;    if(whichIt.style.pixelLeft < document.body.scrollLeft) whichIt.style.pixelLeft = document.body.scrollLeft; if(whichIt.style.pixelLeft > document.body.offsetWidth - document.body.scrollLeft - whichIt.style.pixelWidth - 20) whichIt.style.pixelLeft = document.body.offsetWidth - whichIt.style.pixelWidth - 20;
if(whichIt.style.pixelTop > document.body.offsetHeight + document.body.scrollTop - whichIt.style.pixelHeight - 5) whichIt.style.pixelTop = document.body.offsetHeight + document.body.scrollTop - whichIt.style.pixelHeight - 5;  
event.returnValue = false;  
} else {   
whichIt.moveTo(e.pageX-StalkerTouchedX,e.pageY-StalkerTouchedY); 
if(whichIt.left < 0+self.pageXOffset) whichIt.left = 0+self.pageXOffset; 
if(whichIt.top < 0+self.pageYOffset) whichIt.top = 0+self.pageYOffset;  
if( (whichIt.left + whichIt.clip.width) >= (window.innerWidth+self.pageXOffset-17)) whichIt.left = ((window.innerWidth+self.pageXOffset)-whichIt.clip.width)-17; 
if( (whichIt.top + whichIt.clip.height) >= (window.innerHeight+self.pageYOffset-17)) whichIt.top = ((window.innerHeight+self.pageYOffset)-whichIt.clip.height)-17; 
return false;} 
return false;  
}   
function dropIt() {     
whichIt = null;     
if(NS) window.releaseEvents (Event.MOUSEMOVE);  
return true;             
	}                     
<!-- DRAG DROP CODE -->  
if(NS) {    
window.captureEvents(Event.MOUSEUP|Event.MOUSEDOWN);
window.onmousedown = grabIt;
window.onmousemove = moveIt; 
window.onmouseup = dropIt; 
}              
if(IE) {                     
document.onmousedown = grabIt;    
document.onmousemove = moveIt;   
document.onmouseup = dropIt;          
	}                         
if(NS || IE) action = window.setInterval("heartBeat()",1);   
</SCRIPT></fieldset>

<br><br><br>
          <table width="500" border="0" cellspacing="0" cellpadding="0">
            <tr>
              <td>
                <table width="500" border="0" cellspacing="0" cellpadding="0">
                  <tr> 
                    <td bgcolor="#CCCCCC" width="15" height="16">&nbsp;</td>
                    <td width="96" bgcolor="#000000" height="16"> 
                      <div align="center"><font color="#FFFFFF">脚本说明：</font></div>
                    </td>
                    <td width="389" height="16">&nbsp;</td>
                  </tr>
                </table>
              </td>
            </tr>
            <tr>
              <td class="zf">
                <textarea name="textfield" cols="80" rows="10" class="textfield">脚本说明: 
&nbsp;
把如下代码加入<body>区域中
&nbsp;你不拖动它时它是固定在某一方位的
&lt;STYLE type=text/css&gt;
#floater {
	LEFT: 500px; POSITION: absolute; TOP: 120px; VISIBILITY: visible; WIDTH: 125px; Z-INDEX: 10
}
&lt;/STYLE&gt;
&lt;DIV align=center id=floater style=&quot;HEIGHT: 98px; WIDTH: 240px;&quot;&gt;
&lt;TABLE bgColor=#deefaa border=1 borderColor=#008ff0 borderColorDark=#00dd00 
borderColorLight=#ff0033 cellPadding=2 cellSpacing=1 width=&quot;98%&quot;&gt;
  &lt;TBODY&gt;
  &lt;TR&gt;
    &lt;TD width=&quot;100%&quot;&gt;
      &lt;P align=center&gt;欢迎大家光临“网络编程站”&lt;BR&gt;JavaScript专栏！&lt;/P&gt;&lt;/TD&gt;&lt;/TR&gt;
  &lt;TR&gt;
    &lt;TD width=&quot;100%&quot;&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;欢迎光临网络编程站，有什么意见和建议请尽管提出来，你的意见就是对我们的促进，我们会尽量为你们服务的.请多多支持我们的工作，成长中的每一步都会有你的足迹！！！&lt;BR&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp; 
      你若有什么好的建议和意见，可以给我&lt;A 
      href=&quot;mailto:webmaster@javascript2000.com&quot;&gt;&lt;FONT color=#ff0000 
      size=2&gt;来信&lt;/FONT&gt;&lt;/A&gt;，你若有好的例子，站长更希望能向你请教和学习。&lt;/TD&gt;&lt;/TR&gt;&lt;/TBODY&gt;&lt;/TABLE&gt;&lt;/DIV&gt;
&lt;SCRIPT language=JavaScript&gt;                              
self.onError=null;                              
currentX = currentY = 0;                               
whichIt = null;                                         
lastScrollX = 0; lastScrollY = 0;                              
NS = (document.layers) ? 1 : 0;                             
IE = (document.all) ? 1: 0;                              
&lt;!-- STALKER CODE --&gt;                              
function heartBeat() {                              
if(IE) { diffY = document.body.scrollTop; diffX = document.body.scrollLeft; }                             if(NS) { diffY = self.pageYOffset; diffX = self.pageXOffset; }           
if(diffY != lastScrollY) {            
percent = .1 * (diffY - lastScrollY);    
if(percent &gt; 0) percent = Math.ceil(percent); 
else percent = Math.floor(percent);  
if(IE) document.all.floater.style.pixelTop += percent;  
if(NS) document.floater.top += percent;                 
lastScrollY = lastScrollY + percent;      
}                       
if(diffX != lastScrollX) {       
percent = .1 * (diffX - lastScrollX);     
if(percent &gt; 0) percent = Math.ceil(percent);       
else percent = Math.floor(percent);                   
if(IE) document.all.floater.style.pixelLeft += percent;        
if(NS) document.floater.left += percent;       
lastScrollX = lastScrollX + percent;                     
}	                          
}                         
&lt;!-- /STALKER CODE --&gt;              
&lt;!-- DRAG DROP CODE --&gt;              
function checkFocus(x,y) {         
stalkerx = document.floater.pageX;     
stalkery = document.floater.pageY;                        
stalkerwidth = document.floater.clip.width;              
stalkerheight = document.floater.clip.height;                         
if( (x &gt; stalkerx &amp;&amp; x &lt; (stalkerx+stalkerwidth)) &amp;&amp; (y &gt; stalkery &amp;&amp; y &lt; (stalkery+stalkerheight))) return true;                      
else return false;        
}                     
function grabIt(e) {            
if(IE) {                            
whichIt = event.srcElement; 
while (whichIt.id.indexOf(&quot;floater&quot;) == -1) {    
whichIt = whichIt.parentElement;                           
if (whichIt == null) { return true; }         
 }                            
whichIt.style.pixelLeft = whichIt.offsetLeft;                              
whichIt.style.pixelTop = whichIt.offsetTop;                          
currentX = (event.clientX + document.body.scrollLeft);                       
currentY = (event.clientY + document.body.scrollTop); 	                      
} else {                             
window.captureEvents(Event.MOUSEMOVE);    
if(checkFocus (e.pageX,e.pageY)) {                            
whichIt = document.floater;                              
stalkerTouchedX = e.pageX-document.floater.pageX;      
StalkerTouchedY = e.pageY-document.floater.pageY;          
}                              
}                            
return true;                        
}                            
function moveIt(e) {               
if (whichIt == null) { return false; }       
if(IE) {                             
newX = (event.clientX + document.body.scrollLeft);                           
newY = (event.clientY + document.body.scrollTop);                
distanceX = (newX - currentX);    distanceY = (newY - currentY);   
currentX = newX;    currentY = newY;                       
whichIt.style.pixelLeft += distanceX;                          
whichIt.style.pixelTop += distanceY;                      
if(whichIt.style.pixelTop &lt; document.body.scrollTop) whichIt.style.pixelTop = document.body.scrollTop;    if(whichIt.style.pixelLeft &lt; document.body.scrollLeft) whichIt.style.pixelLeft = document.body.scrollLeft; if(whichIt.style.pixelLeft &gt; document.body.offsetWidth - document.body.scrollLeft - whichIt.style.pixelWidth - 20) whichIt.style.pixelLeft = document.body.offsetWidth - whichIt.style.pixelWidth - 20;
if(whichIt.style.pixelTop &gt; document.body.offsetHeight + document.body.scrollTop - whichIt.style.pixelHeight - 5) whichIt.style.pixelTop = document.body.offsetHeight + document.body.scrollTop - whichIt.style.pixelHeight - 5;  
event.returnValue = false;  
} else {   
whichIt.moveTo(e.pageX-StalkerTouchedX,e.pageY-StalkerTouchedY); 
if(whichIt.left &lt; 0+self.pageXOffset) whichIt.left = 0+self.pageXOffset; 
if(whichIt.top &lt; 0+self.pageYOffset) whichIt.top = 0+self.pageYOffset;  
if( (whichIt.left + whichIt.clip.width) &gt;= (window.innerWidth+self.pageXOffset-17)) whichIt.left = ((window.innerWidth+self.pageXOffset)-whichIt.clip.width)-17; 
if( (whichIt.top + whichIt.clip.height) &gt;= (window.innerHeight+self.pageYOffset-17)) whichIt.top = ((window.innerHeight+self.pageYOffset)-whichIt.clip.height)-17; 
return false;} 
return false;  
}   
function dropIt() {     
whichIt = null;     
if(NS) window.releaseEvents (Event.MOUSEMOVE);  
return true;             
	}                     
&lt;!-- DRAG DROP CODE --&gt;  
if(NS) {    
window.captureEvents(Event.MOUSEUP|Event.MOUSEDOWN);
window.onmousedown = grabIt;
window.onmousemove = moveIt; 
window.onmouseup = dropIt; 
}              
if(IE) {                     
document.onmousedown = grabIt;    
document.onmousemove = moveIt;   
document.onmouseup = dropIt;          
	}                         
if(NS || IE) action = window.setInterval(&quot;heartBeat()&quot;,1);   
&lt;/SCRIPT&gt;



&nbsp;

</textarea>
              </td>
            </tr>
          </table>
        </div>
      </td>
    </tr>
  </table>
  <hr width="770">
   <table width="770" border="0" cellspacing="0" cellpadding="0" height="21">
    <tr>
      <td bgcolor="#CCCCCC" valign="middle">
        <div align="center"><script language=javascript src=buttom.js></script></div>
      </td>
    </tr>
    <tr>
      <td>
        <div align="center"></div>
      </td>
    </tr>
  </table>
</div>
</body>
</html>
