<style>
<!--
BODY{FONT-FAMILY: 宋体; FONT-SIZE: 12.6px;
SCROLLBAR-HIGHLIGHT-COLOR: buttonface;
SCROLLBAR-SHADOW-COLOR: buttonface;
SCROLLBAR-3DLIGHT-COLOR: buttonhighlight;
SCROLLBAR-TRACK-COLOR: #eeeeee;
SCROLLBAR-DARKSHADOW-COLOR: buttonshadow}
td,form,select {FONT-SIZE: 12px; LINE-HEIGHT: 20px}
input {FONT-SIZE: 12px; BORDER: #000000 1px solid;height: 18px; BACKGROUND-color: #f7f7ff; COLOR: #000000;}
.small {FONT-SIZE: 1px; LINE-HEIGHT: 1px}
.mid {FONT-SIZE: 12px;LINE-HEIGHT: 20px}
A:active {COLOR: #ff0000; TEXT-DECORATION: none}
A:hover {COLOR: #ff0000; TEXT-DECORATION: underline}
A:link {COLOR: #000000; TEXT-DECORATION: none}
A:visited {COLOR: #000000; TEXT-DECORATION: none}
-->
</style>
 
<html>
<head>
<title>仲夏夜--js特效--颜色改变选择</title>
<meta http-equiv="Content-Type" content="text/html; charset=gb2312">
<LINK href="css/the9.css" 
rel=stylesheet type=text/css>
<style type="text/css">
<!--
.zf {  border: #999999; border-style: solid; border-top-width: 1px; border-right-width: 1px; border-bottom-width: 1px; border-left-width: 1px}
-->
</style>
<script src="ad.js"></script>
</head>
<body bgcolor=#FFFFFF>

<div align="center" > 
****************
    <tr> 
      **********
    </tr>
  </table>
  <table width="770" border="0" cellspacing="0" cellpadding="0" class="zf1">
    <tr>
      ***********
      ************
      *************
          <tr>
**************
 <SCRIPT LANGUAGE="JavaScript">
<!-- Begin
function addbookmark()
{
bookmarkurl="http://5icat.net.ru"
bookmarktitle="欢迎光临仲夏夜"
if (document.all)
window.external.AddFavorite(bookmarkurl,bookmarktitle)
}
//  End -->
</script>
***************</div></td>
          </tr>
          <tr>
            <td height="15"><div align="center"><img src="images/little2.gif" width="9" height="9">
 <span  onclick="var strHref=window.location.href;this.style.behavior='url(#default#homepage)';this.setHomePage('http://5icat.net.ru');"  style="CURSOR: hand"> 设为首页</a></span></div></td>
          </tr>
          <tr>
            <td><div align="center"><img src="images/little3.gif" width="9" height="9"><script src="../mail.js"></script></div></td>
          </tr>
        </table></td>
    </tr>
  </table>
   <table width="770" border="0" cellspacing="0" cellpadding="0" class="zf1">
    <tr> 
      <td  height="20"><table width="768" height="19" border="0" align="center" cellpadding="0" cellspacing="0" background="images/menubg.gif">    
          <script src="js.js"></script>
        </table></td>
    </tr>
  </table>
  <table width="770" border="0" cellspacing="0" cellpadding="0" bgcolor="#CCCCCC"class="zf1">
    <tr>
      <td class="zf3"><script language="JavaScript">
<!--
var enabled = 0; today = new Date();
var day; var date;
if(today.getDay()==0) day = "星期日"
if(today.getDay()==1) day = "星期一"
if(today.getDay()==2) day = "星期二"
if(today.getDay()==3) day = "星期三"
if(today.getDay()==4) day = "星期四"
if(today.getDay()==5) day = "星期五"
if(today.getDay()==6) day = "星期六"
date = "" + (today.getYear()) + "年" + (today.getMonth() + 1 ) + "月" + today.getDate() + "日  " + day +"";
document.write("<font color=black>" + date + "</font>");
-->
</script></td><td align=right>****************</td>
    </tr>
  </table>
<!--<IFRAME width=770 height=60 style="backgroundcolor: #CCCCCC" marginwidth="0" marginheight="0"  frameborder="0" scrolling="NO"   src="ad_top.htm"></IFRAME> -->
  <table width="770" border="0" cellspacing="0" cellpadding="0" >
    <tr>
      <td height="2"></td>
    </tr>
  </table>
  <table width="770" border="0" cellspacing="10" cellpadding="0" bgcolor="#CCCCCC">
    <tr> 
      <td bgcolor="#FFFFFF" height="501" valign="top"> 
        <div align="center"> <br>
          
          
 <table width="700" border="0" cellspacing="0" cellpadding="0">
            <tr>
              <td width="200">&nbsp;</td>
              <td> 
                <table width="300" border="1" cellspacing="0" cellpadding="0" align="center">
                  <tr> 
                    <td bgcolor="#CCCCCC" height="20" width="15">&nbsp;</td>
                    <td bgcolor="#999999" height="20" width="260"> 
					
                      <div align="center"><font color="#FFFFFF" size="3">颜色改变选择</font></div>
                    </td>
                    <td bgcolor="#CCCCCC" height="20" width="17">&nbsp;</td>
                  </tr>
                </table>
              </td>
              <td width="10"><a href="UserCollect.asp?action=add&id=335" target="Collect">****************</a></td>
            </tr>
          </table>
          <br>
          <fieldset style="width:500;height:50"><legend>效果显示区</legend> 
         
<SCRIPT LANGUAGE="JavaScript">
<!-- Begin
function showBGColor()
{
  if(document.clrForm.bgRandom.checked == true)
    document.bgColor = document.clrForm.bgColor.value = getRandom();
  else
  {
    if(document.clrForm.bgColor.value.search(/^#[a-f0-9]{6}$/ig) == -1)
      alert('Invalid background color');
    else
      document.bgColor = document.clrForm.bgColor.value;
  }
}
function showTXTColor()
{
  if(document.clrForm.txtRandom.checked == true)
    txtChg.style.color = document.clrForm.txtColor.value = getRandom();
  else
  {
    if(document.clrForm.txtColor.value.search(/^#[a-f0-9]{6}$/ig) == -1)
      alert('Invalid font color');
    else
      txtChg.style.color = document.clrForm.txtColor.value;
  }
}
var pool = new Array("0","1","2","3","4","5","6","7","8","9","A","B","C","D","E","F");
function getRandom()
{
  var clr = '';
  for(i=0; i<6; i++)
  {
    num = Math.round(Math.random() * (pool.length-1));
    clr += pool[num];
  }
  return '#'+ clr;
}
function saveColor(field)
{
  if(field == "bgColor")  // bgColor field
    opt = document.clrForm.bgColor.value.toUpperCase();
  else // txtColor field
    opt = document.clrForm.txtColor.value.toUpperCase();
  if(opt != '')
  {
    i = document.clrForm.saveList.options.length;
    for(j=0; j < i; j++)
    {
      if(document.clrForm.saveList.options[j].value == opt)
        return;
    }
    document.clrForm.saveList.options[i] = new Option(opt, opt);
    document.clrForm.saveList.selectedIndex = i;
  }
}
function putColor(field)
{
  if(field == "bgColor")  // bgColor field
  {
    if(document.clrForm.saveList.selectedIndex >= 0)
    {
      document.clrForm.bgRandom.checked = false;
      document.clrForm.bgColor.value = document.clrForm.saveList.options[document.clrForm.saveList.selectedIndex].value;
      showBGColor();
    }
  }
  else // txtColor field
  {
    if(document.clrForm.saveList.selectedIndex >= 0)
    {
      document.clrForm.txtRandom.checked = false;
      document.clrForm.txtColor.value = document.clrForm.saveList.options[document.clrForm.saveList.selectedIndex].value;
      showTXTColor();
    }
  }
}
//  End -->
</script>
<div align="center">
<form name="clrForm">
<table bgcolor="white" border="1">
<tr>
  <td align="left" valign="top"><font face="verdana" size="-1">
    <b>背景颜色:</b><br>
    <input type="text" name="bgColor" value="#FFFFFF" size="8" maxlength="7" onkeyup="document.clrForm.bgRandom.checked=false;">
    <input type="button" name="addBG" value="保存 ->" onclick="saveColor('bgColor');"><br>
    <input type="checkbox" name="bgRandom"> 随机颜色<br>
    <input type="button" value="显示效果" onclick="showBGColor()">
    </font>
  </td>
  <td align="center" valign="top"><font face="verdana" size="-1">
    <b>颜色保存列表:</b><br>
    <select name="saveList" size="2">
    </select><br>
    <input type="button" name="fillBG" value="<- 左移" onclick="putColor('bgColor');">
    <input type="button" name="fillTXT" value="右移 ->" onclick="putColor('txtColor');">
    </font>
  </td>
  <td align="right" valign="top"><font face="verdana" size="-1">
    <b>文字颜色:</b><br>
    <input type="button" name="addTXT" value="<- 保存" onclick="saveColor('txtColor');">
    <input type="text" name="txtColor" value="#000000" size="8" maxlength="7" onkeyup="document.clrForm.txtRandom.checked=false;"><br>
    <input type="checkbox" name="txtRandom"> 随机颜色<br>
    <input type="button" value="显示效果" onclick="showTXTColor()">
    </font>
  </td>
</tr>
</table>
<h2 id=txtChg align=center>请在上面进行选择</h2>
</form>
</div>
</fieldset>

<br><br><br>
          <table width="500" border="0" cellspacing="0" cellpadding="0">
            <tr>
              <td>
                <table width="500" border="0" cellspacing="0" cellpadding="0">
                  <tr> 
                    <td bgcolor="#CCCCCC" width="15" height="16">&nbsp;</td>
                    <td width="96" bgcolor="#000000" height="16"> 
                      <div align="center"><font color="#FFFFFF">脚本说明：</font></div>
                    </td>
                    <td width="389" height="16">&nbsp;</td>
                  </tr>
                </table>
              </td>
            </tr>
            <tr>
              <td class="zf">
                <textarea name="textfield" cols="80" rows="10" class="textfield">脚本说明: 
&nbsp;
把如下代码加入<body>区域中
&nbsp;&lt;SCRIPT LANGUAGE=&quot;JavaScript&quot;&gt;
&lt;!-- Begin
function showBGColor()
{
  if(document.clrForm.bgRandom.checked == true)
    document.bgColor = document.clrForm.bgColor.value = getRandom();
  else
  {
    if(document.clrForm.bgColor.value.search(/^#[a-f0-9]{6}$/ig) == -1)
      alert('Invalid background color');
    else
      document.bgColor = document.clrForm.bgColor.value;
  }
}
function showTXTColor()
{
  if(document.clrForm.txtRandom.checked == true)
    txtChg.style.color = document.clrForm.txtColor.value = getRandom();
  else
  {
    if(document.clrForm.txtColor.value.search(/^#[a-f0-9]{6}$/ig) == -1)
      alert('Invalid font color');
    else
      txtChg.style.color = document.clrForm.txtColor.value;
  }
}
var pool = new Array(&quot;0&quot;,&quot;1&quot;,&quot;2&quot;,&quot;3&quot;,&quot;4&quot;,&quot;5&quot;,&quot;6&quot;,&quot;7&quot;,&quot;8&quot;,&quot;9&quot;,&quot;A&quot;,&quot;B&quot;,&quot;C&quot;,&quot;D&quot;,&quot;E&quot;,&quot;F&quot;);
function getRandom()
{
  var clr = '';
  for(i=0; i&lt;6; i++)
  {
    num = Math.round(Math.random() * (pool.length-1));
    clr += pool[num];
  }
  return '#'+ clr;
}
function saveColor(field)
{
  if(field == &quot;bgColor&quot;)  // bgColor field
    opt = document.clrForm.bgColor.value.toUpperCase();
  else // txtColor field
    opt = document.clrForm.txtColor.value.toUpperCase();
  if(opt != '')
  {
    i = document.clrForm.saveList.options.length;
    for(j=0; j &lt; i; j++)
    {
      if(document.clrForm.saveList.options[j].value == opt)
        return;
    }
    document.clrForm.saveList.options[i] = new Option(opt, opt);
    document.clrForm.saveList.selectedIndex = i;
  }
}
function putColor(field)
{
  if(field == &quot;bgColor&quot;)  // bgColor field
  {
    if(document.clrForm.saveList.selectedIndex &gt;= 0)
    {
      document.clrForm.bgRandom.checked = false;
      document.clrForm.bgColor.value = document.clrForm.saveList.options[document.clrForm.saveList.selectedIndex].value;
      showBGColor();
    }
  }
  else // txtColor field
  {
    if(document.clrForm.saveList.selectedIndex &gt;= 0)
    {
      document.clrForm.txtRandom.checked = false;
      document.clrForm.txtColor.value = document.clrForm.saveList.options[document.clrForm.saveList.selectedIndex].value;
      showTXTColor();
    }
  }
}
//  End --&gt;
&lt;/script&gt;
&lt;div align=&quot;center&quot;&gt;
&lt;form name=&quot;clrForm&quot;&gt;
&lt;table bgcolor=&quot;white&quot; border=&quot;1&quot;&gt;
&lt;tr&gt;
  &lt;td align=&quot;left&quot; valign=&quot;top&quot;&gt;&lt;font face=&quot;verdana&quot; size=&quot;-1&quot;&gt;
    &lt;b&gt;背景颜色:&lt;/b&gt;&lt;br&gt;
    &lt;input type=&quot;text&quot; name=&quot;bgColor&quot; value=&quot;#FFFFFF&quot; size=&quot;8&quot; maxlength=&quot;7&quot; onkeyup=&quot;document.clrForm.bgRandom.checked=false;&quot;&gt;
    &lt;input type=&quot;button&quot; name=&quot;addBG&quot; value=&quot;保存 -&gt;&quot; onclick=&quot;saveColor('bgColor');&quot;&gt;&lt;br&gt;
    &lt;input type=&quot;checkbox&quot; name=&quot;bgRandom&quot;&gt; 随机颜色&lt;br&gt;
    &lt;input type=&quot;button&quot; value=&quot;显示效果&quot; onclick=&quot;showBGColor()&quot;&gt;
    &lt;/font&gt;
  &lt;/td&gt;
  &lt;td align=&quot;center&quot; valign=&quot;top&quot;&gt;&lt;font face=&quot;verdana&quot; size=&quot;-1&quot;&gt;
    &lt;b&gt;颜色保存列表:&lt;/b&gt;&lt;br&gt;
    &lt;select name=&quot;saveList&quot; size=&quot;2&quot;&gt;
    &lt;/select&gt;&lt;br&gt;
    &lt;input type=&quot;button&quot; name=&quot;fillBG&quot; value=&quot;&lt;- 左移&quot; onclick=&quot;putColor('bgColor');&quot;&gt;
    &lt;input type=&quot;button&quot; name=&quot;fillTXT&quot; value=&quot;右移 -&gt;&quot; onclick=&quot;putColor('txtColor');&quot;&gt;
    &lt;/font&gt;
  &lt;/td&gt;
  &lt;td align=&quot;right&quot; valign=&quot;top&quot;&gt;&lt;font face=&quot;verdana&quot; size=&quot;-1&quot;&gt;
    &lt;b&gt;文字颜色:&lt;/b&gt;&lt;br&gt;
    &lt;input type=&quot;button&quot; name=&quot;addTXT&quot; value=&quot;&lt;- 保存&quot; onclick=&quot;saveColor('txtColor');&quot;&gt;
    &lt;input type=&quot;text&quot; name=&quot;txtColor&quot; value=&quot;#000000&quot; size=&quot;8&quot; maxlength=&quot;7&quot; onkeyup=&quot;document.clrForm.txtRandom.checked=false;&quot;&gt;&lt;br&gt;
    &lt;input type=&quot;checkbox&quot; name=&quot;txtRandom&quot;&gt; 随机颜色&lt;br&gt;
    &lt;input type=&quot;button&quot; value=&quot;显示效果&quot; onclick=&quot;showTXTColor()&quot;&gt;
    &lt;/font&gt;
  &lt;/td&gt;
&lt;/tr&gt;
&lt;/table&gt;
&lt;h2 id=txtChg align=center&gt;请在上面进行选择&lt;/h2&gt;
&lt;/form&gt;
&lt;/div&gt;




&nbsp;

</textarea>
              </td>
            </tr>
          </table>
        </div>
      </td>
    </tr>
  </table>
  <hr width="770">
   <table width="770" border="0" cellspacing="0" cellpadding="0" height="21">
    <tr>
      <td bgcolor="#CCCCCC" valign="middle">
        <div align="center"><script language=javascript src=buttom.js></script></div>
      </td>
    </tr>
    <tr>
      <td>
        <div align="center"></div>
      </td>
    </tr>
  </table>
</div>
</body>
</html>
