<style>
<!--
BODY{FONT-FAMILY: 宋体; FONT-SIZE: 12.6px;
SCROLLBAR-HIGHLIGHT-COLOR: buttonface;
SCROLLBAR-SHADOW-COLOR: buttonface;
SCROLLBAR-3DLIGHT-COLOR: buttonhighlight;
SCROLLBAR-TRACK-COLOR: #eeeeee;
SCROLLBAR-DARKSHADOW-COLOR: buttonshadow}
td,form,select {FONT-SIZE: 12px; LINE-HEIGHT: 20px}
input {FONT-SIZE: 12px; BORDER: #000000 1px solid;height: 18px; BACKGROUND-color: #f7f7ff; COLOR: #000000;}
.small {FONT-SIZE: 1px; LINE-HEIGHT: 1px}
.mid {FONT-SIZE: 12px;LINE-HEIGHT: 20px}
A:active {COLOR: #ff0000; TEXT-DECORATION: none}
A:hover {COLOR: #ff0000; TEXT-DECORATION: underline}
A:link {COLOR: #000000; TEXT-DECORATION: none}
A:visited {COLOR: #000000; TEXT-DECORATION: none}
-->
</style>
 
<html>
<head>
<title>仲夏夜--js特效--双人小游戏</title>
<meta http-equiv="Content-Type" content="text/html; charset=gb2312">
<LINK href="css/the9.css" 
rel=stylesheet type=text/css>
<style type="text/css">
<!--
.zf {  border: #999999; border-style: solid; border-top-width: 1px; border-right-width: 1px; border-bottom-width: 1px; border-left-width: 1px}
-->
</style>
<script src="ad.js"></script>
</head>
<body bgcolor=#FFFFFF>

<div align="center" > 
****************
    <tr> 
      **********
    </tr>
  </table>
  <table width="770" border="0" cellspacing="0" cellpadding="0" class="zf1">
    <tr>
      ***********
      ************
      *************
          <tr>
**************
 <SCRIPT LANGUAGE="JavaScript">
<!-- Begin
function addbookmark()
{
bookmarkurl="http://5icat.net.ru"
bookmarktitle="欢迎光临仲夏夜"
if (document.all)
window.external.AddFavorite(bookmarkurl,bookmarktitle)
}
//  End -->
</script>
***************</div></td>
          </tr>
          <tr>
            <td height="15"><div align="center"><img src="images/little2.gif" width="9" height="9">
 <span  onclick="var strHref=window.location.href;this.style.behavior='url(#default#homepage)';this.setHomePage('http://5icat.net.ru');"  style="CURSOR: hand"> 设为首页</a></span></div></td>
          </tr>
          <tr>
            <td><div align="center"><img src="images/little3.gif" width="9" height="9"><script src="../mail.js"></script></div></td>
          </tr>
        </table></td>
    </tr>
  </table>
   <table width="770" border="0" cellspacing="0" cellpadding="0" class="zf1">
    <tr> 
      <td  height="20"><table width="768" height="19" border="0" align="center" cellpadding="0" cellspacing="0" background="images/menubg.gif">    
          <script src="js.js"></script>
        </table></td>
    </tr>
  </table>
  <table width="770" border="0" cellspacing="0" cellpadding="0" bgcolor="#CCCCCC"class="zf1">
    <tr>
      <td class="zf3"><script language="JavaScript">
<!--
var enabled = 0; today = new Date();
var day; var date;
if(today.getDay()==0) day = "星期日"
if(today.getDay()==1) day = "星期一"
if(today.getDay()==2) day = "星期二"
if(today.getDay()==3) day = "星期三"
if(today.getDay()==4) day = "星期四"
if(today.getDay()==5) day = "星期五"
if(today.getDay()==6) day = "星期六"
date = "" + (today.getYear()) + "年" + (today.getMonth() + 1 ) + "月" + today.getDate() + "日  " + day +"";
document.write("<font color=black>" + date + "</font>");
-->
</script></td><td align=right>****************</td>
    </tr>
  </table>
<!--<IFRAME width=770 height=60 style="backgroundcolor: #CCCCCC" marginwidth="0" marginheight="0"  frameborder="0" scrolling="NO"   src="ad_top.htm"></IFRAME> -->
  <table width="770" border="0" cellspacing="0" cellpadding="0" >
    <tr>
      <td height="2"></td>
    </tr>
  </table>
  <table width="770" border="0" cellspacing="10" cellpadding="0" bgcolor="#CCCCCC">
    <tr> 
      <td bgcolor="#FFFFFF" height="501" valign="top"> 
        <div align="center"> <br>
          
          
 <table width="700" border="0" cellspacing="0" cellpadding="0">
            <tr>
              <td width="200">&nbsp;</td>
              <td> 
                <table width="300" border="1" cellspacing="0" cellpadding="0" align="center">
                  <tr> 
                    <td bgcolor="#CCCCCC" height="20" width="15">&nbsp;</td>
                    <td bgcolor="#999999" height="20" width="260"> 
					
                      <div align="center"><font color="#FFFFFF" size="3">双人小游戏</font></div>
                    </td>
                    <td bgcolor="#CCCCCC" height="20" width="17">&nbsp;</td>
                  </tr>
                </table>
              </td>
              <td width="10"><a href="UserCollect.asp?action=add&id=1452" target="Collect">****************</a></td>
            </tr>
          </table>
          <br>
          <fieldset style="width:500;height:50"><legend>效果显示区</legend> 
         
<script>
function ShowMenu(bMenu) {
document.all.idFinder.style.display = (bMenu) ? "none" : "block" 
document.all.idMenu.style.display = (bMenu) ? "block" : "none"
idML.className = (bMenu) ? "cOn" : "cOff"
idRL.className = (bMenu) ? "cOff" : "cOn"
return false
}
</script>
<style>
<!--
A.cOn {text-decoration:none;font-weight:bolder}
#article {font: 12pt Verdana, geneva, arial, sans-serif;  background: white; color: black; padding: 10pt 15pt 0 5pt}
#article P.start {text-indent: 0pt}
#article P {margin-top:0pt;font-size:10pt;text-indent:12pt}
#article #author {margin-bottom:5pt;text-indent:0pt;font-style: italic}
#pageList P {padding-top:10pt}
#article H3 {font-weight:bold}
#article DL, UL, OL {font-size: 10pt}
-->
</style>
<script>
<!--
function addList(url,desc) {
if ((navigator.appName=="Netscape") || (parseInt(navigator.appVersion)>=4)) {
var w=window.open("","_IDHTML_LIST_","top=0,left=0,width=475,height=150,history=no,menubar=no,status=no,resizable=no")
var d=w.document
if (!w._init) {
d.open()
d.write("<TITLE>Loading...</TITLE><EM>Loading...</EM>")
d.close()
d.location.replace("/assist/listing.asp?url="+escape(url)+"&desc="+escape(desc))  
w.opener=self    
window.status="Personal Assistant (Adding): " + desc
} else {
window.status=w.addOption(url,desc)    
w.focus()
}
}
else
alert("Your browser does not support the personal assistant.")
return false
}
// -->
</script>

<style>
#board {font-family: arial}
.dot {position: absolute; width: 5px; height: 5px; font-size: 0pt; background: black}
#line {position: absolute; font-size: 0pt; height: 5px}
.p1 {position: absolute; font-size: 0pt;background: navy}
.p2 {position: absolute; font-size: 0pt;  background: red}
.p1B {position: absolute; font-size: 8pt; color: navy;text-align: center; font-weight: bold}
.p2B {position: absolute; font-size: 8pt; color: red; text-align: center; font-weight: bold}
</style>
<style type="text/css">
<!--
body {  font-family: "宋体"; font-size: 9pt; margin-top: 0px; margin-left: 0px; margin-right: 0px}
A { COLOR: black; FONT-SIZE: 13px; FONT-WEIGHT: 400; TEXT-DECORATION: none }
 A:hover { COLOR: red; FONT-SIZE: 13px; FONT-WEIGHT: 400; TEXT-DECORATION: underline }
a:active     { font: 9pt "宋体"; cursor: hand; color: #FF0033 }

-->
</style>
<meta http-equiv="Content-Type" content="text/html; charset=gb2312">
<SCRIPT LANGUAGE="JavaScript">
<!-- Begin
var timerRunning = false;
var timezone = "Greenwich Mean Time";
var adjust = 0;

function timeCheck(tzone, diff) {
if (timerRunning) {

clearTimeout(updatetime);
timerRunning = false; }
gmtOffset=eval(diff+adjust);
timezone = tzone;
checkDateTime();
}

function checkDateTime () {
var today = new Date();
var year = today.getYear() + 1900;
var month = today.getMonth()+1;
var date = today.getDate();
var day = today.getDay();
var hour = today.getHours();
var minute = today.getMinutes();
var second = today.getSeconds();

var lastSat = date - (day+1);
while (lastSat < 32) lastSat+=7;
if (lastSat > 31) lastSat+=-7;
var firstSat = date - (day+1);
while (firstSat > 0) firstSat+=-7;
if (firstSat < 1) firstSat+=7;
if ((((month == 4) && (date >= firstSat)) || month > 4) && 
(month < 11 || ((month == 10) && day <= lastSat))) adjust += 60;
yourOffset = (new Date()).getTimezoneOffset();
yourOffset = yourOffset + adjust;

var xx = navigator.appName
var xy = navigator.appVersion;
xy = xy.substring(0,1);
if ((xy == 4) && (xx == "Netscape")) yourOffset = yourOffset+adjust;
if ((((month == 4) && (date > 20)) || month > 4) && (month < 11 || ((month == 10) &&
day < 30))) adjust -= 60;

ourDifference = eval(gmtOffset - yourOffset);
var half = eval(ourDifference % 60);
ourDifference = Math.round(ourDifference / 60);
hour = eval(hour - ourDifference);
var m = new Array("",
"Jan","Feb","Mar",
"Apr","May","Jun",
"Jul","Aug","Sept",
"Oct","Nov","Dec");
var leap = eval(year % 4);

if ((half == -30) || (half == 30)) minute += 30;
if (minute > 59) minute -= 60, hour++;
if (minute < 0) minute += 60, hour--;
if (hour > 23) hour -= 24, date += 1;
if (((month == 4) || (month == 6) || 
(month == 9) || (month == 11)) && (date==31)) date = 1, month ++;
if (((month == 2) && (date > 28)) && (leap != 0)) date = 1, month ++;
if ((month == 2) && (date > 29)) date = 1, month++;
if (hour < 0) hour += 24, date --;
if ((date == 32) && (month == 12)) month = m[1], date = 1, year++;
if (date == 32) date = 1, month++;
if ((date < 1) && (month == 1)) month= m[12], date = 31, year--;
if (date < 1) date = 31, month --;
if (((month == 4) || (month == 6) || 
(month== 9) || (month == 11)) && (date == 31)) date = 30;
if ((month == 2) && (date > 28)) date = 29;
if (((month == 2) && (date > 28)) && (leap != 0)) date=28;
for (i=1; i<13; i++) {
if (month == i) {
month = m[i]; break;
   }
}

var dateTime = hour;
dateTime = ((dateTime < 10) ? "0":"") + dateTime;
dateTime = "   " + dateTime;
dateTime += ((minute < 10) ? ":0" : ":") + minute;
dateTime += ((second < 10) ? ":0" : ":") + second;
dateTime += (hour >= 12) ? " PM, " : " AM, ";
dateTime += month + " " + date + ", " + year;

document.clock.zonetime.value = dateTime;
document.clock.zonename.value = timezone;
updatetime=setTimeout("checkDateTime()", 900);
timerRunning = true;
}
// End -->
</SCRIPT>
<table CELLPADDING="0" CELLSPACING="0" BORDER="0" width="509">
  <tr>
    <td WIDTH="10"></td>
    <td valign="top" WIDTH="499" ID="article"><p class="start" STYLE="text-align: left"><font
    size="+2" style="font-weight:bold;font-size: 14pt"><b>看谁围的框子多？</b></font></p>
    <p>这是一个双人游戏，蓝色的先行，看谁围的框子多，谁就赢。</p>
    <p STYLE="margin-top: 5pt"><script>
  /* DHTML Dots is copyright 1998 insideDHTML.com, LLC. All rights reserved.
     DHTML Dots cannot be reproduced in any manner without prior consent from insideDHTML.com */

  var scale= 25
  var size = 5

  var totalSize = ((size+1)*scale) + 6
  var cache = new Object()
  var move=0,point=0
  var player = true

  function initCache() {
    cache.x = 0
    cache.y = 0
    cache.red = 0
    cache.navy = 0
    move=0,point=0    
  }

  function updateScore() {
    document.all.red.innerText = cache.red
    document.all.navy.innerText = cache.navy
    if ((cache.red+cache.navy)==((size-1)*(size-1))) {
      board.onclick = null
      document.all.message.innerText = "Game Over!"
    }
     
  }

  function fillPos(x,y) {
    document.all.board.insertAdjacentHTML("beforeEnd","<DIV class=" + (player ? "p1B" : "p2B") + " ID=\"point"+point+"\">" + (player ? "N" : "R") + "</DIV>")
    var el = document.all["point"+point].style
    el.pixelTop = (y*scale)+5
    el.pixelLeft = (x*scale)+5
    el.pixelWidth = scale - 5
    el.pixelHeight = scale - 5

  }

  function checkBoard(x,y,dir, player) {
    var piece=0
    if ("vertical"==dir) {
      if ((x==size) || (x>1)) {
        var bPos = boardArray[x-1][y]
        var nextV = boardArray[x-1][y+1]
        if ((bPos["vertical"]) && (bPos["horizontal"]) && (nextV["horizontal"])) {
          point++
          piece++
          fillPos(x-1,y)
        }
      } 
      if ((x==1) || (x<size)) {
          var nextV = boardArray[x+1][y]
          var nextH = boardArray[x][y+1]
          if ((nextV["vertical"]) && (nextH["horizontal"]) && (boardArray[x][y]["horizontal"])) {
            point++
            piece++
            fillPos(x,y)
          }
      }   
    }    
    else {
      if ((y==size) || (y>1)) {
        var nextV = boardArray[x+1][y-1]
        var bPos = boardArray[x][y-1]
        if ((bPos["vertical"]) && (bPos["horizontal"]) && (nextV["vertical"])) {
          point++
          piece++
          fillPos(x,y-1)
        } 
      }
      if ((y==1) || (y<size)) {
        var nextV = boardArray[x+1][y]
        var nextH = boardArray[x][y+1]
        if ((nextV["vertical"]) && (nextH["horizontal"]) && (boardArray[x][y]["vertical"])) {
          point++
          piece++
          fillPos(x,y)
        }
      }
    } 
    if (piece>0) {
      if (player)
       cache.navy+=piece
      else
       cache.red+=piece
      document.all.message.innerText = "Score! Go Again."
      updateScore()
      return player
    }
    else
      return !player
        
  }

  function doMouseMove() {
    if (event.srcElement.className!="dot") {
      var x = Math.floor(event.offsetX / scale) 
      var y = Math.floor(event.offsetY / scale) 
      var dirX = (event.offsetX % scale)
      var dirY = (event.offsetY % scale)
      if ((x<size+1) && (y<size+1) && (y>0) && (x>0)) {
        if (dirX>=dirY) {
          if (x<size) {
            line.style.pixelHeight = 5 
            line.style.pixelWidth = scale  - 5
            line.style.pixelTop = (y * scale) 
            line.style.pixelLeft = (x * scale) + 5
            cache.direction = "horizontal"
          }
        } else
        {
          if (y<size) { 
            line.style.pixelWidth = 5 
            line.style.pixelHeight = scale - 5
            line.style.pixelTop = (y * scale) + 5
            line.style.pixelLeft = x * scale
            cache.direction = "vertical"
          }
        }
        cache.x = x
        cache.y = y
      }
    }
    
  }

  function doClick() {

    if (cache.x==0) return
    if (boardArray[cache.x][cache.y][cache.direction])
      document.all.message.innerText="That spot is taken! Choose again"
    else {
      document.all.board.insertAdjacentHTML("beforeEnd","<DIV class=" + (player ? "p1" : "p2") + " ID=move"+move+"></DIV>")
      var el = document.all["move"+move]
      el.style.top = line.style.top 
      el.style.left = line.style.left 
      el.style.width = line.style.width
      el.style.height = line.style.height
      boardArray[cache.x][cache.y][cache.direction]=true
      var nextPlayer = checkBoard(cache.x,cache.y,cache.direction, player)
      if (nextPlayer!=player) {
        player = nextPlayer
        if (player) {
          document.all.message.innerText = "Navy players turn"
          line.style.border = "1px navy solid"
        }
        else {
          document.all.message.innerText = "Red players turn"
          line.style.border = "1px red solid"
        }
      }
    }

 
    move++
  }

  function buildDiv(x,y, scale) {
    return ("<DIV CLASS=dot STYLE=\"top:" +  (x*scale) + "; left: " + (y*scale) + "\"></DIV>")
  }   

  var boardArray = new Object


  function buildBoard() {
    initCache()
    board = ("<DIV ID=line STYLE=\"border: 1px navy solid; width: 0; height: 0\"></DIV>")
    boardArray = new Object()
    for (var x=1; x < size+1; x++) {
      boardArray[x] = new Object()
      for (var y=1; y < size+1; y++) {
        boardArray[x][y] = new Object
        boardArray[x][y]["vertical"] = false
        boardArray[x][y]["horizontal"] = false
        board+=(buildDiv(x,y, scale))
      }
    }

    return board
  }

  function createGame() {
    size=parseInt(document.all.setSize.value)
    if (size>12)
      size=12
    if (size<3)
      size=3
    document.all.setSize.value = size
    document.all.board.innerHTML = buildBoard()
    document.all.board.onclick = doClick
    totalSize = ((size+1)*scale) + 6
    document.all.board.style.pixelWidth = totalSize
    document.all.board.style.pixelHeight = totalSize
    document.all.message.innerText = "Navy player goes first. Good Luck!"
    updateScore()    
  }
  document.write("<DIV ID=board STYLE=\"position: relative; height: "+ totalSize + "; width:" + totalSize + "; border: 1px black solid\">" + buildBoard() + "</DIV>")
  document.all.board.onmousemove = doMouseMove
  document.all.board.onclick = doClick

</script> </p>
    <div STYLE="margin-left: 10pt; margin-top: 5pt"><p class="start" ID="message">Navy player 
    goes first. Good Luck!</p>
    <dd><br>
      <table border="1" width="100">
        <tr>
          <td style="color: red"><b>Red</b></td>
          <td ID="red">0</td>
        </tr>
        <tr>
          <td style="color: navy"><b>Navy</b></td>
          <td ID="navy">0</td>
        </tr>
      </table>
      <p><br>
      </p>
      <table width="200">
        <tr>
          <td>游戏大小: </td>
          <td><input TYPE="Text" VALUE="5" ID="setSize" SIZE="2"></td>
        </tr>
        <tr>
          <td COLSPAN="2" align="center"><input TYPE="button" ONCLICK="createGame()"
          VALUE="New Game"></td>
        </tr>
      </table> <p CLASS="copyright">　</p>
    </dd>
    </div></td>
  </tr>
</table></fieldset>

<br><br><br>
          <table width="500" border="0" cellspacing="0" cellpadding="0">
            <tr>
              <td>
                <table width="500" border="0" cellspacing="0" cellpadding="0">
                  <tr> 
                    <td bgcolor="#CCCCCC" width="15" height="16">&nbsp;</td>
                    <td width="96" bgcolor="#000000" height="16"> 
                      <div align="center"><font color="#FFFFFF">脚本说明：</font></div>
                    </td>
                    <td width="389" height="16">&nbsp;</td>
                  </tr>
                </table>
              </td>
            </tr>
            <tr>
              <td class="zf">
                <textarea name="textfield" cols="80" rows="10" class="textfield">脚本说明: 
&nbsp;
把如下代码加入<body>区域中
&nbsp;&lt;script&gt;
function ShowMenu(bMenu) {
document.all.idFinder.style.display = (bMenu) ? &quot;none&quot; : &quot;block&quot; 
document.all.idMenu.style.display = (bMenu) ? &quot;block&quot; : &quot;none&quot;
idML.className = (bMenu) ? &quot;cOn&quot; : &quot;cOff&quot;
idRL.className = (bMenu) ? &quot;cOff&quot; : &quot;cOn&quot;
return false
}
&lt;/script&gt;
&lt;style&gt;
&lt;!--
A.cOn {text-decoration:none;font-weight:bolder}
#article {font: 12pt Verdana, geneva, arial, sans-serif;  background: white; color: black; padding: 10pt 15pt 0 5pt}
#article P.start {text-indent: 0pt}
#article P {margin-top:0pt;font-size:10pt;text-indent:12pt}
#article #author {margin-bottom:5pt;text-indent:0pt;font-style: italic}
#pageList P {padding-top:10pt}
#article H3 {font-weight:bold}
#article DL, UL, OL {font-size: 10pt}
--&gt;
&lt;/style&gt;
&lt;script&gt;
&lt;!--
function addList(url,desc) {
if ((navigator.appName==&quot;Netscape&quot;) || (parseInt(navigator.appVersion)&gt;=4)) {
var w=window.open(&quot;&quot;,&quot;_IDHTML_LIST_&quot;,&quot;top=0,left=0,width=475,height=150,history=no,menubar=no,status=no,resizable=no&quot;)
var d=w.document
if (!w._init) {
d.open()
d.write(&quot;&lt;TITLE&gt;Loading...&lt;/TITLE&gt;&lt;EM&gt;Loading...&lt;/EM&gt;&quot;)
d.close()
d.location.replace(&quot;/assist/listing.asp?url=&quot;+escape(url)+&quot;&amp;desc=&quot;+escape(desc))  
w.opener=self    
window.status=&quot;Personal Assistant (Adding): &quot; + desc
} else {
window.status=w.addOption(url,desc)    
w.focus()
}
}
else
alert(&quot;Your browser does not support the personal assistant.&quot;)
return false
}
// --&gt;
&lt;/script&gt;

&lt;style&gt;
#board {font-family: arial}
.dot {position: absolute; width: 5px; height: 5px; font-size: 0pt; background: black}
#line {position: absolute; font-size: 0pt; height: 5px}
.p1 {position: absolute; font-size: 0pt;background: navy}
.p2 {position: absolute; font-size: 0pt;  background: red}
.p1B {position: absolute; font-size: 8pt; color: navy;text-align: center; font-weight: bold}
.p2B {position: absolute; font-size: 8pt; color: red; text-align: center; font-weight: bold}
&lt;/style&gt;
&lt;style type=&quot;text/css&quot;&gt;
&lt;!--
body {  font-family: &quot;宋体&quot;; font-size: 9pt; margin-top: 0px; margin-left: 0px; margin-right: 0px}
A { COLOR: black; FONT-SIZE: 13px; FONT-WEIGHT: 400; TEXT-DECORATION: none }
 A:hover { COLOR: red; FONT-SIZE: 13px; FONT-WEIGHT: 400; TEXT-DECORATION: underline }
a:active     { font: 9pt &quot;宋体&quot;; cursor: hand; color: #FF0033 }

--&gt;
&lt;/style&gt;
&lt;meta http-equiv=&quot;Content-Type&quot; content=&quot;text/html; charset=gb2312&quot;&gt;
&lt;SCRIPT LANGUAGE=&quot;JavaScript&quot;&gt;
&lt;!-- Begin
var timerRunning = false;
var timezone = &quot;Greenwich Mean Time&quot;;
var adjust = 0;

function timeCheck(tzone, diff) {
if (timerRunning) {

clearTimeout(updatetime);
timerRunning = false; }
gmtOffset=eval(diff+adjust);
timezone = tzone;
checkDateTime();
}

function checkDateTime () {
var today = new Date();
var year = today.getYear() + 1900;
var month = today.getMonth()+1;
var date = today.getDate();
var day = today.getDay();
var hour = today.getHours();
var minute = today.getMinutes();
var second = today.getSeconds();

var lastSat = date - (day+1);
while (lastSat &lt; 32) lastSat+=7;
if (lastSat &gt; 31) lastSat+=-7;
var firstSat = date - (day+1);
while (firstSat &gt; 0) firstSat+=-7;
if (firstSat &lt; 1) firstSat+=7;
if ((((month == 4) &amp;&amp; (date &gt;= firstSat)) || month &gt; 4) &amp;&amp; 
(month &lt; 11 || ((month == 10) &amp;&amp; day &lt;= lastSat))) adjust += 60;
yourOffset = (new Date()).getTimezoneOffset();
yourOffset = yourOffset + adjust;

var xx = navigator.appName
var xy = navigator.appVersion;
xy = xy.substring(0,1);
if ((xy == 4) &amp;&amp; (xx == &quot;Netscape&quot;)) yourOffset = yourOffset+adjust;
if ((((month == 4) &amp;&amp; (date &gt; 20)) || month &gt; 4) &amp;&amp; (month &lt; 11 || ((month == 10) &amp;&amp;
day &lt; 30))) adjust -= 60;

ourDifference = eval(gmtOffset - yourOffset);
var half = eval(ourDifference % 60);
ourDifference = Math.round(ourDifference / 60);
hour = eval(hour - ourDifference);
var m = new Array(&quot;&quot;,
&quot;Jan&quot;,&quot;Feb&quot;,&quot;Mar&quot;,
&quot;Apr&quot;,&quot;May&quot;,&quot;Jun&quot;,
&quot;Jul&quot;,&quot;Aug&quot;,&quot;Sept&quot;,
&quot;Oct&quot;,&quot;Nov&quot;,&quot;Dec&quot;);
var leap = eval(year % 4);

if ((half == -30) || (half == 30)) minute += 30;
if (minute &gt; 59) minute -= 60, hour++;
if (minute &lt; 0) minute += 60, hour--;
if (hour &gt; 23) hour -= 24, date += 1;
if (((month == 4) || (month == 6) || 
(month == 9) || (month == 11)) &amp;&amp; (date==31)) date = 1, month ++;
if (((month == 2) &amp;&amp; (date &gt; 28)) &amp;&amp; (leap != 0)) date = 1, month ++;
if ((month == 2) &amp;&amp; (date &gt; 29)) date = 1, month++;
if (hour &lt; 0) hour += 24, date --;
if ((date == 32) &amp;&amp; (month == 12)) month = m[1], date = 1, year++;
if (date == 32) date = 1, month++;
if ((date &lt; 1) &amp;&amp; (month == 1)) month= m[12], date = 31, year--;
if (date &lt; 1) date = 31, month --;
if (((month == 4) || (month == 6) || 
(month== 9) || (month == 11)) &amp;&amp; (date == 31)) date = 30;
if ((month == 2) &amp;&amp; (date &gt; 28)) date = 29;
if (((month == 2) &amp;&amp; (date &gt; 28)) &amp;&amp; (leap != 0)) date=28;
for (i=1; i&lt;13; i++) {
if (month == i) {
month = m[i]; break;
   }
}

var dateTime = hour;
dateTime = ((dateTime &lt; 10) ? &quot;0&quot;:&quot;&quot;) + dateTime;
dateTime = &quot;   &quot; + dateTime;
dateTime += ((minute &lt; 10) ? &quot;:0&quot; : &quot;:&quot;) + minute;
dateTime += ((second &lt; 10) ? &quot;:0&quot; : &quot;:&quot;) + second;
dateTime += (hour &gt;= 12) ? &quot; PM, &quot; : &quot; AM, &quot;;
dateTime += month + &quot; &quot; + date + &quot;, &quot; + year;

document.clock.zonetime.value = dateTime;
document.clock.zonename.value = timezone;
updatetime=setTimeout(&quot;checkDateTime()&quot;, 900);
timerRunning = true;
}
// End --&gt;
&lt;/SCRIPT&gt;
&lt;table CELLPADDING=&quot;0&quot; CELLSPACING=&quot;0&quot; BORDER=&quot;0&quot; width=&quot;509&quot;&gt;
  &lt;tr&gt;
    &lt;td WIDTH=&quot;10&quot;&gt;&lt;/td&gt;
    &lt;td valign=&quot;top&quot; WIDTH=&quot;499&quot; ID=&quot;article&quot;&gt;&lt;p class=&quot;start&quot; STYLE=&quot;text-align: left&quot;&gt;&lt;font
    size=&quot;+2&quot; style=&quot;font-weight:bold;font-size: 14pt&quot;&gt;&lt;b&gt;看谁围的框子多？&lt;/b&gt;&lt;/font&gt;&lt;/p&gt;
    &lt;p&gt;这是一个双人游戏，蓝色的先行，看谁围的框子多，谁就赢。&lt;/p&gt;
    &lt;p STYLE=&quot;margin-top: 5pt&quot;&gt;&lt;script&gt;
  /* DHTML Dots is copyright 1998 insideDHTML.com, LLC. All rights reserved.
     DHTML Dots cannot be reproduced in any manner without prior consent from insideDHTML.com */

  var scale= 25
  var size = 5

  var totalSize = ((size+1)*scale) + 6
  var cache = new Object()
  var move=0,point=0
  var player = true

  function initCache() {
    cache.x = 0
    cache.y = 0
    cache.red = 0
    cache.navy = 0
    move=0,point=0    
  }

  function updateScore() {
    document.all.red.innerText = cache.red
    document.all.navy.innerText = cache.navy
    if ((cache.red+cache.navy)==((size-1)*(size-1))) {
      board.onclick = null
      document.all.message.innerText = &quot;Game Over!&quot;
    }
     
  }

  function fillPos(x,y) {
    document.all.board.insertAdjacentHTML(&quot;beforeEnd&quot;,&quot;&lt;DIV class=&quot; + (player ? &quot;p1B&quot; : &quot;p2B&quot;) + &quot; ID=\&quot;point&quot;+point+&quot;\&quot;&gt;&quot; + (player ? &quot;N&quot; : &quot;R&quot;) + &quot;&lt;/DIV&gt;&quot;)
    var el = document.all[&quot;point&quot;+point].style
    el.pixelTop = (y*scale)+5
    el.pixelLeft = (x*scale)+5
    el.pixelWidth = scale - 5
    el.pixelHeight = scale - 5

  }

  function checkBoard(x,y,dir, player) {
    var piece=0
    if (&quot;vertical&quot;==dir) {
      if ((x==size) || (x&gt;1)) {
        var bPos = boardArray[x-1][y]
        var nextV = boardArray[x-1][y+1]
        if ((bPos[&quot;vertical&quot;]) &amp;&amp; (bPos[&quot;horizontal&quot;]) &amp;&amp; (nextV[&quot;horizontal&quot;])) {
          point++
          piece++
          fillPos(x-1,y)
        }
      } 
      if ((x==1) || (x&lt;size)) {
          var nextV = boardArray[x+1][y]
          var nextH = boardArray[x][y+1]
          if ((nextV[&quot;vertical&quot;]) &amp;&amp; (nextH[&quot;horizontal&quot;]) &amp;&amp; (boardArray[x][y][&quot;horizontal&quot;])) {
            point++
            piece++
            fillPos(x,y)
          }
      }   
    }    
    else {
      if ((y==size) || (y&gt;1)) {
        var nextV = boardArray[x+1][y-1]
        var bPos = boardArray[x][y-1]
        if ((bPos[&quot;vertical&quot;]) &amp;&amp; (bPos[&quot;horizontal&quot;]) &amp;&amp; (nextV[&quot;vertical&quot;])) {
          point++
          piece++
          fillPos(x,y-1)
        } 
      }
      if ((y==1) || (y&lt;size)) {
        var nextV = boardArray[x+1][y]
        var nextH = boardArray[x][y+1]
        if ((nextV[&quot;vertical&quot;]) &amp;&amp; (nextH[&quot;horizontal&quot;]) &amp;&amp; (boardArray[x][y][&quot;vertical&quot;])) {
          point++
          piece++
          fillPos(x,y)
        }
      }
    } 
    if (piece&gt;0) {
      if (player)
       cache.navy+=piece
      else
       cache.red+=piece
      document.all.message.innerText = &quot;Score! Go Again.&quot;
      updateScore()
      return player
    }
    else
      return !player
        
  }

  function doMouseMove() {
    if (event.srcElement.className!=&quot;dot&quot;) {
      var x = Math.floor(event.offsetX / scale) 
      var y = Math.floor(event.offsetY / scale) 
      var dirX = (event.offsetX % scale)
      var dirY = (event.offsetY % scale)
      if ((x&lt;size+1) &amp;&amp; (y&lt;size+1) &amp;&amp; (y&gt;0) &amp;&amp; (x&gt;0)) {
        if (dirX&gt;=dirY) {
          if (x&lt;size) {
            line.style.pixelHeight = 5 
            line.style.pixelWidth = scale  - 5
            line.style.pixelTop = (y * scale) 
            line.style.pixelLeft = (x * scale) + 5
            cache.direction = &quot;horizontal&quot;
          }
        } else
        {
          if (y&lt;size) { 
            line.style.pixelWidth = 5 
            line.style.pixelHeight = scale - 5
            line.style.pixelTop = (y * scale) + 5
            line.style.pixelLeft = x * scale
            cache.direction = &quot;vertical&quot;
          }
        }
        cache.x = x
        cache.y = y
      }
    }
    
  }

  function doClick() {

    if (cache.x==0) return
    if (boardArray[cache.x][cache.y][cache.direction])
      document.all.message.innerText=&quot;That spot is taken! Choose again&quot;
    else {
      document.all.board.insertAdjacentHTML(&quot;beforeEnd&quot;,&quot;&lt;DIV class=&quot; + (player ? &quot;p1&quot; : &quot;p2&quot;) + &quot; ID=move&quot;+move+&quot;&gt;&lt;/DIV&gt;&quot;)
      var el = document.all[&quot;move&quot;+move]
      el.style.top = line.style.top 
      el.style.left = line.style.left 
      el.style.width = line.style.width
      el.style.height = line.style.height
      boardArray[cache.x][cache.y][cache.direction]=true
      var nextPlayer = checkBoard(cache.x,cache.y,cache.direction, player)
      if (nextPlayer!=player) {
        player = nextPlayer
        if (player) {
          document.all.message.innerText = &quot;Navy players turn&quot;
          line.style.border = &quot;1px navy solid&quot;
        }
        else {
          document.all.message.innerText = &quot;Red players turn&quot;
          line.style.border = &quot;1px red solid&quot;
        }
      }
    }

 
    move++
  }

  function buildDiv(x,y, scale) {
    return (&quot;&lt;DIV CLASS=dot STYLE=\&quot;top:&quot; +  (x*scale) + &quot;; left: &quot; + (y*scale) + &quot;\&quot;&gt;&lt;/DIV&gt;&quot;)
  }   

  var boardArray = new Object


  function buildBoard() {
    initCache()
    board = (&quot;&lt;DIV ID=line STYLE=\&quot;border: 1px navy solid; width: 0; height: 0\&quot;&gt;&lt;/DIV&gt;&quot;)
    boardArray = new Object()
    for (var x=1; x &lt; size+1; x++) {
      boardArray[x] = new Object()
      for (var y=1; y &lt; size+1; y++) {
        boardArray[x][y] = new Object
        boardArray[x][y][&quot;vertical&quot;] = false
        boardArray[x][y][&quot;horizontal&quot;] = false
        board+=(buildDiv(x,y, scale))
      }
    }

    return board
  }

  function createGame() {
    size=parseInt(document.all.setSize.value)
    if (size&gt;12)
      size=12
    if (size&lt;3)
      size=3
    document.all.setSize.value = size
    document.all.board.innerHTML = buildBoard()
    document.all.board.onclick = doClick
    totalSize = ((size+1)*scale) + 6
    document.all.board.style.pixelWidth = totalSize
    document.all.board.style.pixelHeight = totalSize
    document.all.message.innerText = &quot;Navy player goes first. Good Luck!&quot;
    updateScore()    
  }
  document.write(&quot;&lt;DIV ID=board STYLE=\&quot;position: relative; height: &quot;+ totalSize + &quot;; width:&quot; + totalSize + &quot;; border: 1px black solid\&quot;&gt;&quot; + buildBoard() + &quot;&lt;/DIV&gt;&quot;)
  document.all.board.onmousemove = doMouseMove
  document.all.board.onclick = doClick

&lt;/script&gt; &lt;/p&gt;
    &lt;div STYLE=&quot;margin-left: 10pt; margin-top: 5pt&quot;&gt;&lt;p class=&quot;start&quot; ID=&quot;message&quot;&gt;Navy player 
    goes first. Good Luck!&lt;/p&gt;
    &lt;dd&gt;&lt;br&gt;
      &lt;table border=&quot;1&quot; width=&quot;100&quot;&gt;
        &lt;tr&gt;
          &lt;td style=&quot;color: red&quot;&gt;&lt;b&gt;Red&lt;/b&gt;&lt;/td&gt;
          &lt;td ID=&quot;red&quot;&gt;0&lt;/td&gt;
        &lt;/tr&gt;
        &lt;tr&gt;
          &lt;td style=&quot;color: navy&quot;&gt;&lt;b&gt;Navy&lt;/b&gt;&lt;/td&gt;
          &lt;td ID=&quot;navy&quot;&gt;0&lt;/td&gt;
        &lt;/tr&gt;
      &lt;/table&gt;
      &lt;p&gt;&lt;br&gt;
      &lt;/p&gt;
      &lt;table width=&quot;200&quot;&gt;
        &lt;tr&gt;
          &lt;td&gt;游戏大小: &lt;/td&gt;
          &lt;td&gt;&lt;input TYPE=&quot;Text&quot; VALUE=&quot;5&quot; ID=&quot;setSize&quot; SIZE=&quot;2&quot;&gt;&lt;/td&gt;
        &lt;/tr&gt;
        &lt;tr&gt;
          &lt;td COLSPAN=&quot;2&quot; align=&quot;center&quot;&gt;&lt;input TYPE=&quot;button&quot; ONCLICK=&quot;createGame()&quot;
          VALUE=&quot;New Game&quot;&gt;&lt;/td&gt;
        &lt;/tr&gt;
      &lt;/table&gt; &lt;p CLASS=&quot;copyright&quot;&gt;　&lt;/p&gt;
    &lt;/dd&gt;
    &lt;/div&gt;&lt;/td&gt;
  &lt;/tr&gt;
&lt;/table&gt;



&nbsp;

</textarea>
              </td>
            </tr>
          </table>
        </div>
      </td>
    </tr>
  </table>
  <hr width="770">
   <table width="770" border="0" cellspacing="0" cellpadding="0" height="21">
    <tr>
      <td bgcolor="#CCCCCC" valign="middle">
        <div align="center"><script language=javascript src=buttom.js></script></div>
      </td>
    </tr>
    <tr>
      <td>
        <div align="center"></div>
      </td>
    </tr>
  </table>
</div>
</body>
</html>
