<style>
<!--
BODY{FONT-FAMILY: 宋体; FONT-SIZE: 12.6px;
SCROLLBAR-HIGHLIGHT-COLOR: buttonface;
SCROLLBAR-SHADOW-COLOR: buttonface;
SCROLLBAR-3DLIGHT-COLOR: buttonhighlight;
SCROLLBAR-TRACK-COLOR: #eeeeee;
SCROLLBAR-DARKSHADOW-COLOR: buttonshadow}
td,form,select {FONT-SIZE: 12px; LINE-HEIGHT: 20px}
input {FONT-SIZE: 12px; BORDER: #000000 1px solid;height: 18px; BACKGROUND-color: #f7f7ff; COLOR: #000000;}
.small {FONT-SIZE: 1px; LINE-HEIGHT: 1px}
.mid {FONT-SIZE: 12px;LINE-HEIGHT: 20px}
A:active {COLOR: #ff0000; TEXT-DECORATION: none}
A:hover {COLOR: #ff0000; TEXT-DECORATION: underline}
A:link {COLOR: #000000; TEXT-DECORATION: none}
A:visited {COLOR: #000000; TEXT-DECORATION: none}
-->
</style>
 
<html>
<head>
<title>仲夏夜--js特效--全球时间表</title>
<meta http-equiv="Content-Type" content="text/html; charset=gb2312">
<LINK href="css/the9.css" 
rel=stylesheet type=text/css>
<style type="text/css">
<!--
.zf {  border: #999999; border-style: solid; border-top-width: 1px; border-right-width: 1px; border-bottom-width: 1px; border-left-width: 1px}
-->
</style>
<script src="ad.js"></script>
</head>
<body bgcolor="#ffffff" OnLoad="timeCheck(timezone, 0)">

<div align="center" > 
****************
    <tr> 
      **********
    </tr>
  </table>
  <table width="770" border="0" cellspacing="0" cellpadding="0" class="zf1">
    <tr>
      ***********
      ************
      *************
          <tr>
**************
 <SCRIPT LANGUAGE="JavaScript">
<!-- Begin
function addbookmark()
{
bookmarkurl="http://5icat.net.ru"
bookmarktitle="欢迎光临仲夏夜"
if (document.all)
window.external.AddFavorite(bookmarkurl,bookmarktitle)
}
//  End -->
</script>
***************</div></td>
          </tr>
          <tr>
            <td height="15"><div align="center"><img src="images/little2.gif" width="9" height="9">
 <span  onclick="var strHref=window.location.href;this.style.behavior='url(#default#homepage)';this.setHomePage('http://5icat.net.ru');"  style="CURSOR: hand"> 设为首页</a></span></div></td>
          </tr>
          <tr>
            <td><div align="center"><img src="images/little3.gif" width="9" height="9"><script src="../mail.js"></script></div></td>
          </tr>
        </table></td>
    </tr>
  </table>
   <table width="770" border="0" cellspacing="0" cellpadding="0" class="zf1">
    <tr> 
      <td  height="20"><table width="768" height="19" border="0" align="center" cellpadding="0" cellspacing="0" background="images/menubg.gif">    
          <script src="js.js"></script>
        </table></td>
    </tr>
  </table>
  <table width="770" border="0" cellspacing="0" cellpadding="0" bgcolor="#CCCCCC"class="zf1">
    <tr>
      <td class="zf3"><script language="JavaScript">
<!--
var enabled = 0; today = new Date();
var day; var date;
if(today.getDay()==0) day = "星期日"
if(today.getDay()==1) day = "星期一"
if(today.getDay()==2) day = "星期二"
if(today.getDay()==3) day = "星期三"
if(today.getDay()==4) day = "星期四"
if(today.getDay()==5) day = "星期五"
if(today.getDay()==6) day = "星期六"
date = "" + (today.getYear()) + "年" + (today.getMonth() + 1 ) + "月" + today.getDate() + "日  " + day +"";
document.write("<font color=black>" + date + "</font>");
-->
</script></td><td align=right>****************</td>
    </tr>
  </table>
<!--<IFRAME width=770 height=60 style="backgroundcolor: #CCCCCC" marginwidth="0" marginheight="0"  frameborder="0" scrolling="NO"   src="ad_top.htm"></IFRAME> -->
  <table width="770" border="0" cellspacing="0" cellpadding="0" >
    <tr>
      <td height="2"></td>
    </tr>
  </table>
  <table width="770" border="0" cellspacing="10" cellpadding="0" bgcolor="#CCCCCC">
    <tr> 
      <td bgcolor="#FFFFFF" height="501" valign="top"> 
        <div align="center"> <br>
          
          
 <table width="700" border="0" cellspacing="0" cellpadding="0">
            <tr>
              <td width="200">&nbsp;</td>
              <td> 
                <table width="300" border="1" cellspacing="0" cellpadding="0" align="center">
                  <tr> 
                    <td bgcolor="#CCCCCC" height="20" width="15">&nbsp;</td>
                    <td bgcolor="#999999" height="20" width="260"> 
					
                      <div align="center"><font color="#FFFFFF" size="3">全球时间表</font></div>
                    </td>
                    <td bgcolor="#CCCCCC" height="20" width="17">&nbsp;</td>
                  </tr>
                </table>
              </td>
              <td width="10"><a href="UserCollect.asp?action=add&id=41" target="Collect">****************</a></td>
            </tr>
          </table>
          <br>
          <fieldset style="width:500;height:50"><legend>效果显示区</legend> 
         
<script language="JavaScript">
<!-- Begin
var timerRunning = false;
var timezone = "格林尼治标准时间";
var adjust = 0;

function timeCheck(tzone, diff) {
if (timerRunning) {
clearTimeout(updatetime);
timerRunning = false; }
gmtOffset=eval(diff+adjust);
timezone = tzone;
checkDateTime();
}

function checkDateTime () {
var today = new Date();
var year = today.getYear() + 00;
var month = today.getMonth()+1;
var date = today.getDate();
var day = today.getDay();
var hour = today.getHours();
var minute = today.getMinutes();
var second = today.getSeconds();

var lastSat = date - (day+1);
while (lastSat < 32) lastSat+=7;
if (lastSat > 31) lastSat+=-7;
var firstSat = date - (day+1);
while (firstSat > 0) firstSat+=-7;
if (firstSat < 1) firstSat+=7;
if ((((month == 4) && (date >= firstSat)) || month > 4) && 
(month < 11 || ((month == 10) && day <= lastSat))) adjust += 60;
yourOffset = (new Date()).getTimezoneOffset();
yourOffset = yourOffset + adjust;

var xx = navigator.appName
var xy = navigator.appVersion;
xy = xy.substring(0,1);
if ((xy == 4) && (xx == "Netscape")) yourOffset = yourOffset+adjust;
if ((((month == 4) && (date > 20)) || month > 4) && (month < 11 || ((month == 10) &&
day < 30))) adjust -= 60;

ourDifference = eval(gmtOffset - yourOffset);
var half = eval(ourDifference % 60);
ourDifference = Math.round(ourDifference / 60);
hour = eval(hour - ourDifference);
var m = new Array("",
"1","2","3",
"4","5","6",
"7","8","9",
"10","11","12");
var leap = eval(year % 4);

if ((half == -30) || (half == 30)) minute += 30;
if (minute > 59) minute -= 60, hour++;
if (minute < 0) minute += 60, hour--;
if (hour > 23) hour -= 24, date += 1;
if (((month == 4) || (month == 6) || 
(month == 9) || (month == 11)) && (date==31)) date = 1, month ++;
if (((month == 2) && (date > 28)) && (leap != 0)) date = 1, month ++;
if ((month == 2) && (date > 29)) date = 1, month++;
if (hour < 0) hour += 24, date --;
if ((date == 32) && (month == 12)) month = m[1], date = 1, year++;
if (date == 32) date = 1, month++;
if ((date < 1) && (month == 1)) month= m[12], date = 31, year--;
if (date < 1) date = 31, month --;
if (((month == 4) || (month == 6) || 
(month== 9) || (month == 11)) && (date == 31)) date = 30;
if ((month == 2) && (date > 28)) date = 29;
if (((month == 2) && (date > 28)) && (leap != 0)) date=28;
for (i=1; i<13; i++) {
if (month == i) {
month = m[i]; break;
   }
}

var dateTime = hour;
dateTime = ((dateTime < 10) ? "0":"") + dateTime;
dateTime = " " + dateTime;
dateTime += ((minute < 10) ? ":0" : ":") + minute;
dateTime += ((second < 10) ? ":0" : ":") + second;
dateTime += (hour >= 12) ? "下午, " : "上午, ";
dateTime += year + "年" + month + "月" + date + "日" ;

document.clock.zonetime.value = dateTime;
document.clock.zonename.value = timezone;
updatetime=setTimeout("checkDateTime()", 900);
timerRunning = true;
}
// End -->
</script>
                  <br>
                  <form name=clock>
                    <input type=text name=zonetime size=28>
                    <br>
                    <br>
                    <b>当前的地区</b><br>
                    <input type=text name=zonename size=21>
                    <br>
                    <br>
                    <table border=1 cellpadding=5>
                      <tr> 
                        <td align=center> 
                          <input type=button value="太平洋" onClick="timeCheck(this.value, +480)" name="button">
                        </td>
                        <td align=center> 
                          <input type=button value="中心" onClick="timeCheck(this.value, +420)" name="button">
                        </td>
                        <td align=center> 
                          <input type=button value="东方" onClick="timeCheck(this.value, +300)" name="button">
                        </td>
                      </tr>
                      <tr> 
                        <td align=center> 
                          <input type=button value="夏威夷" onClick="timeCheck(this.value, +600)" name="button">
                        </td>
                        <td align=center> 
                          <input type=button value="墨西哥" onClick="timeCheck(this.value, +360)" name="button">
                        </td>
                        <td align=center> 
                          <input type=button value="新德里" onClick="timeCheck(this.value, -330)" name="button">
                        </td>
                      </tr>
                      <tr> 
                        <td align=center> 
                          <input type=button value="北京" onClick="timeCheck(this.value, -420)" name="button">
                        </td>
                        <td align=center> 
                          <input type=button value="东京" onClick="timeCheck(this.value, -540)" name="button">
                        </td>
                        <td align=center> 
                          <input type=button value="伦敦" onClick="timeCheck(this.value, +0)" name="button">
                        </td>
                      </tr>
                    </table>
                    </form>
</fieldset>

<br><br><br>
          <table width="500" border="0" cellspacing="0" cellpadding="0">
            <tr>
              <td>
                <table width="500" border="0" cellspacing="0" cellpadding="0">
                  <tr> 
                    <td bgcolor="#CCCCCC" width="15" height="16">&nbsp;</td>
                    <td width="96" bgcolor="#000000" height="16"> 
                      <div align="center"><font color="#FFFFFF">脚本说明：</font></div>
                    </td>
                    <td width="389" height="16">&nbsp;</td>
                  </tr>
                </table>
              </td>
            </tr>
            <tr>
              <td class="zf">
                <textarea name="textfield" cols="80" rows="10" class="textfield">脚本说明: 
&nbsp;
第一步:把如下代码加入<body>区域中
&nbsp;&lt;script language=&quot;JavaScript&quot;&gt;
&lt;!-- Begin
var timerRunning = false;
var timezone = &quot;格林尼治标准时间&quot;;
var adjust = 0;

function timeCheck(tzone, diff) {
if (timerRunning) {
clearTimeout(updatetime);
timerRunning = false; }
gmtOffset=eval(diff+adjust);
timezone = tzone;
checkDateTime();
}

function checkDateTime () {
var today = new Date();
var year = today.getYear() + 00;
var month = today.getMonth()+1;
var date = today.getDate();
var day = today.getDay();
var hour = today.getHours();
var minute = today.getMinutes();
var second = today.getSeconds();

var lastSat = date - (day+1);
while (lastSat &lt; 32) lastSat+=7;
if (lastSat &gt; 31) lastSat+=-7;
var firstSat = date - (day+1);
while (firstSat &gt; 0) firstSat+=-7;
if (firstSat &lt; 1) firstSat+=7;
if ((((month == 4) &amp;&amp; (date &gt;= firstSat)) || month &gt; 4) &amp;&amp; 
(month &lt; 11 || ((month == 10) &amp;&amp; day &lt;= lastSat))) adjust += 60;
yourOffset = (new Date()).getTimezoneOffset();
yourOffset = yourOffset + adjust;

var xx = navigator.appName
var xy = navigator.appVersion;
xy = xy.substring(0,1);
if ((xy == 4) &amp;&amp; (xx == &quot;Netscape&quot;)) yourOffset = yourOffset+adjust;
if ((((month == 4) &amp;&amp; (date &gt; 20)) || month &gt; 4) &amp;&amp; (month &lt; 11 || ((month == 10) &amp;&amp;
day &lt; 30))) adjust -= 60;

ourDifference = eval(gmtOffset - yourOffset);
var half = eval(ourDifference % 60);
ourDifference = Math.round(ourDifference / 60);
hour = eval(hour - ourDifference);
var m = new Array(&quot;&quot;,
&quot;1&quot;,&quot;2&quot;,&quot;3&quot;,
&quot;4&quot;,&quot;5&quot;,&quot;6&quot;,
&quot;7&quot;,&quot;8&quot;,&quot;9&quot;,
&quot;10&quot;,&quot;11&quot;,&quot;12&quot;);
var leap = eval(year % 4);

if ((half == -30) || (half == 30)) minute += 30;
if (minute &gt; 59) minute -= 60, hour++;
if (minute &lt; 0) minute += 60, hour--;
if (hour &gt; 23) hour -= 24, date += 1;
if (((month == 4) || (month == 6) || 
(month == 9) || (month == 11)) &amp;&amp; (date==31)) date = 1, month ++;
if (((month == 2) &amp;&amp; (date &gt; 28)) &amp;&amp; (leap != 0)) date = 1, month ++;
if ((month == 2) &amp;&amp; (date &gt; 29)) date = 1, month++;
if (hour &lt; 0) hour += 24, date --;
if ((date == 32) &amp;&amp; (month == 12)) month = m[1], date = 1, year++;
if (date == 32) date = 1, month++;
if ((date &lt; 1) &amp;&amp; (month == 1)) month= m[12], date = 31, year--;
if (date &lt; 1) date = 31, month --;
if (((month == 4) || (month == 6) || 
(month== 9) || (month == 11)) &amp;&amp; (date == 31)) date = 30;
if ((month == 2) &amp;&amp; (date &gt; 28)) date = 29;
if (((month == 2) &amp;&amp; (date &gt; 28)) &amp;&amp; (leap != 0)) date=28;
for (i=1; i&lt;13; i++) {
if (month == i) {
month = m[i]; break;
   }
}

var dateTime = hour;
dateTime = ((dateTime &lt; 10) ? &quot;0&quot;:&quot;&quot;) + dateTime;
dateTime = &quot; &quot; + dateTime;
dateTime += ((minute &lt; 10) ? &quot;:0&quot; : &quot;:&quot;) + minute;
dateTime += ((second &lt; 10) ? &quot;:0&quot; : &quot;:&quot;) + second;
dateTime += (hour &gt;= 12) ? &quot;下午, &quot; : &quot;上午, &quot;;
dateTime += year + &quot;年&quot; + month + &quot;月&quot; + date + &quot;日&quot; ;

document.clock.zonetime.value = dateTime;
document.clock.zonename.value = timezone;
updatetime=setTimeout(&quot;checkDateTime()&quot;, 900);
timerRunning = true;
}
// End --&gt;
&lt;/script&gt;
                  &lt;br&gt;
                  &lt;form name=clock&gt;
                    &lt;input type=text name=zonetime size=28&gt;
                    &lt;br&gt;
                    &lt;br&gt;
                    &lt;b&gt;当前的地区&lt;/b&gt;&lt;br&gt;
                    &lt;input type=text name=zonename size=21&gt;
                    &lt;br&gt;
                    &lt;br&gt;
                    &lt;table border=1 cellpadding=5&gt;
                      &lt;tr&gt; 
                        &lt;td align=center&gt; 
                          &lt;input type=button value=&quot;太平洋&quot; onClick=&quot;timeCheck(this.value, +480)&quot; name=&quot;button&quot;&gt;
                        &lt;/td&gt;
                        &lt;td align=center&gt; 
                          &lt;input type=button value=&quot;中心&quot; onClick=&quot;timeCheck(this.value, +420)&quot; name=&quot;button&quot;&gt;
                        &lt;/td&gt;
                        &lt;td align=center&gt; 
                          &lt;input type=button value=&quot;东方&quot; onClick=&quot;timeCheck(this.value, +300)&quot; name=&quot;button&quot;&gt;
                        &lt;/td&gt;
                      &lt;/tr&gt;
                      &lt;tr&gt; 
                        &lt;td align=center&gt; 
                          &lt;input type=button value=&quot;夏威夷&quot; onClick=&quot;timeCheck(this.value, +600)&quot; name=&quot;button&quot;&gt;
                        &lt;/td&gt;
                        &lt;td align=center&gt; 
                          &lt;input type=button value=&quot;墨西哥&quot; onClick=&quot;timeCheck(this.value, +360)&quot; name=&quot;button&quot;&gt;
                        &lt;/td&gt;
                        &lt;td align=center&gt; 
                          &lt;input type=button value=&quot;新德里&quot; onClick=&quot;timeCheck(this.value, -330)&quot; name=&quot;button&quot;&gt;
                        &lt;/td&gt;
                      &lt;/tr&gt;
                      &lt;tr&gt; 
                        &lt;td align=center&gt; 
                          &lt;input type=button value=&quot;北京&quot; onClick=&quot;timeCheck(this.value, -420)&quot; name=&quot;button&quot;&gt;
                        &lt;/td&gt;
                        &lt;td align=center&gt; 
                          &lt;input type=button value=&quot;东京&quot; onClick=&quot;timeCheck(this.value, -540)&quot; name=&quot;button&quot;&gt;
                        &lt;/td&gt;
                        &lt;td align=center&gt; 
                          &lt;input type=button value=&quot;伦敦&quot; onClick=&quot;timeCheck(this.value, +0)&quot; name=&quot;button&quot;&gt;
                        &lt;/td&gt;
                      &lt;/tr&gt;
                    &lt;/table&gt;
                    &lt;/form&gt;




&nbsp;
第二步:把如下代码加入<body>区域中<body bgcolor="#ffffff" OnLoad="timeCheck(timezone, 0)">
</textarea>
              </td>
            </tr>
          </table>
        </div>
      </td>
    </tr>
  </table>
  <hr width="770">
   <table width="770" border="0" cellspacing="0" cellpadding="0" height="21">
    <tr>
      <td bgcolor="#CCCCCC" valign="middle">
        <div align="center"><script language=javascript src=buttom.js></script></div>
      </td>
    </tr>
    <tr>
      <td>
        <div align="center"></div>
      </td>
    </tr>
  </table>
</div>
</body>
</html>
