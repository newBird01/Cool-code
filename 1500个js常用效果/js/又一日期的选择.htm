<style>
<!--
BODY{FONT-FAMILY: 宋体; FONT-SIZE: 12.6px;
SCROLLBAR-HIGHLIGHT-COLOR: buttonface;
SCROLLBAR-SHADOW-COLOR: buttonface;
SCROLLBAR-3DLIGHT-COLOR: buttonhighlight;
SCROLLBAR-TRACK-COLOR: #eeeeee;
SCROLLBAR-DARKSHADOW-COLOR: buttonshadow}
td,form,select {FONT-SIZE: 12px; LINE-HEIGHT: 20px}
input {FONT-SIZE: 12px; BORDER: #000000 1px solid;height: 18px; BACKGROUND-color: #f7f7ff; COLOR: #000000;}
.small {FONT-SIZE: 1px; LINE-HEIGHT: 1px}
.mid {FONT-SIZE: 12px;LINE-HEIGHT: 20px}
A:active {COLOR: #ff0000; TEXT-DECORATION: none}
A:hover {COLOR: #ff0000; TEXT-DECORATION: underline}
A:link {COLOR: #000000; TEXT-DECORATION: none}
A:visited {COLOR: #000000; TEXT-DECORATION: none}
-->
</style>
 
<html>
<head>
<title>仲夏夜--js特效--又一日期的选择</title>
<meta http-equiv="Content-Type" content="text/html; charset=gb2312">
<LINK href="css/the9.css" 
rel=stylesheet type=text/css>
<style type="text/css">
<!--
.zf {  border: #999999; border-style: solid; border-top-width: 1px; border-right-width: 1px; border-bottom-width: 1px; border-left-width: 1px}
-->
</style>
<script src="ad.js"></script>
</head>
<body bgcolor=#FFFFFF>

<div align="center" > 
****************
    <tr> 
      **********
    </tr>
  </table>
  <table width="770" border="0" cellspacing="0" cellpadding="0" class="zf1">
    <tr>
      ***********
      ************
      *************
          <tr>
**************
 <SCRIPT LANGUAGE="JavaScript">
<!-- Begin
function addbookmark()
{
bookmarkurl="http://5icat.net.ru"
bookmarktitle="欢迎光临仲夏夜"
if (document.all)
window.external.AddFavorite(bookmarkurl,bookmarktitle)
}
//  End -->
</script>
***************</div></td>
          </tr>
          <tr>
            <td height="15"><div align="center"><img src="images/little2.gif" width="9" height="9">
 <span  onclick="var strHref=window.location.href;this.style.behavior='url(#default#homepage)';this.setHomePage('http://5icat.net.ru');"  style="CURSOR: hand"> 设为首页</a></span></div></td>
          </tr>
          <tr>
            <td><div align="center"><img src="images/little3.gif" width="9" height="9"><script src="../mail.js"></script></div></td>
          </tr>
        </table></td>
    </tr>
  </table>
   <table width="770" border="0" cellspacing="0" cellpadding="0" class="zf1">
    <tr> 
      <td  height="20"><table width="768" height="19" border="0" align="center" cellpadding="0" cellspacing="0" background="images/menubg.gif">    
          <script src="js.js"></script>
        </table></td>
    </tr>
  </table>
  <table width="770" border="0" cellspacing="0" cellpadding="0" bgcolor="#CCCCCC"class="zf1">
    <tr>
      <td class="zf3"><script language="JavaScript">
<!--
var enabled = 0; today = new Date();
var day; var date;
if(today.getDay()==0) day = "星期日"
if(today.getDay()==1) day = "星期一"
if(today.getDay()==2) day = "星期二"
if(today.getDay()==3) day = "星期三"
if(today.getDay()==4) day = "星期四"
if(today.getDay()==5) day = "星期五"
if(today.getDay()==6) day = "星期六"
date = "" + (today.getYear()) + "年" + (today.getMonth() + 1 ) + "月" + today.getDate() + "日  " + day +"";
document.write("<font color=black>" + date + "</font>");
-->
</script></td><td align=right>****************</td>
    </tr>
  </table>
<!--<IFRAME width=770 height=60 style="backgroundcolor: #CCCCCC" marginwidth="0" marginheight="0"  frameborder="0" scrolling="NO"   src="ad_top.htm"></IFRAME> -->
  <table width="770" border="0" cellspacing="0" cellpadding="0" >
    <tr>
      <td height="2"></td>
    </tr>
  </table>
  <table width="770" border="0" cellspacing="10" cellpadding="0" bgcolor="#CCCCCC">
    <tr> 
      <td bgcolor="#FFFFFF" height="501" valign="top"> 
        <div align="center"> <br>
          
          
 <table width="700" border="0" cellspacing="0" cellpadding="0">
            <tr>
              <td width="200">&nbsp;</td>
              <td> 
                <table width="300" border="1" cellspacing="0" cellpadding="0" align="center">
                  <tr> 
                    <td bgcolor="#CCCCCC" height="20" width="15">&nbsp;</td>
                    <td bgcolor="#999999" height="20" width="260"> 
					
                      <div align="center"><font color="#FFFFFF" size="3">又一日期的选择</font></div>
                    </td>
                    <td bgcolor="#CCCCCC" height="20" width="17">&nbsp;</td>
                  </tr>
                </table>
              </td>
              <td width="10"><a href="UserCollect.asp?action=add&id=1520" target="Collect">****************</a></td>
            </tr>
          </table>
          <br>
          <fieldset style="width:500;height:50"><legend>效果显示区</legend> 
         
<script language="javascript">


// default settings
var fontFace="verdana";
var fontSize=9;

var titleWidth=90;
var titleMode=1;
var dayWidth=12;
var dayDigits=1;

var titleColor="#cccccc";
var daysColor="#cccccc";
var bodyColor="#ffffff";
var dayColor="#ffffff";
var currentDayColor="#333333";
var footColor="#cccccc";
var borderColor="#333333";

var titleFontColor = "#333333";
var daysFontColor = "#333333";
var dayFontColor = "#333333";
var currentDayFontColor = "#ffffff";
var footFontColor = "#333333";

var calFormat = "yyyy/mm/dd";

var weekDay = 0;
// ------

// codes
var calWidth=200, calHeight=200, calOffsetX=-200, calOffsetY=16;
var calWin=null;
var winX=0, winY=0;
var cal="cal";
var cals=new Array();
var currentCal=null;

var yxMonths=new Array("January", "February", "March", "April", "May", "June", "July", "August", "September", "October", "November", "December");
var yxDays=new Array("Sunday", "Monday", "Tuesday", "Wednesday", "Thursday", "Friday", "Saturday", "Sunday");
var yxLinks=new Array("[close]", "[clear]");

var isOpera=(navigator.userAgent.indexOf("Opera")!=-1)?true:false;
var isOpera5=(navigator.appVersion.indexOf("MSIE 5")!=-1 && navigator.userAgent.indexOf("Opera 5")!=-1)?true:false;
var isOpera6=(navigator.appVersion.indexOf("MSIE 5")!=-1 && navigator.userAgent.indexOf("Opera 6")!=-1)?true:false;
var isN6=(navigator.userAgent.indexOf("Gecko")!=-1);
var isN4=(document.layers)?true:false;
var isMac=(navigator.userAgent.indexOf("Mac")!=-1);
var isIE=(document.all && !isOpera && (!isMac || navigator.appVersion.indexOf("MSIE 4")==-1))?true:false;

if (isN4) {
  fontSize+=2;
}

var span2="</span>";

function span1(tag) {
  return "<span class='"+tag+"'>";
}
function spanx(tag, color) {
  return "."+tag+" { font-family:"+fontFace+"; font-size:"+fontSize+"px; color:"+color+"; }\n";
}

function a1(tag) {
  return "<a class='"+tag+"' href=";
}

function ax(tag, color) {
  return "."+tag+" { text-decoration:none; color:"+color+"; }\n";
}

function calOBJ(name, title, field, form) {
  this.name = name;
  this.title = title;
  this.field = field;
  this.formName = form;
  this.form = null
}

function setFont(font, size) {
  if (font != "") {
    fontFace=font;
  }
  if (size > 0) {
    fontSize=size;

    if (isN4) {
      fontSize+=2;
    }
  }
}

function setWidth(tWidth, tMode, dWidth, dDigits) {
  if (tWidth > 0) {
    titleWidth=tWidth;
  }
  if (tMode == 1 || tMode == 2) {
    titleMode=tMode;
  }
  if (dWidth > 0) {
    dayWidth=dWidth;
  }
  if (dDigits > 0) {
    dayDigits=dDigits;
  }
}

function setColor(tColor, dsColor, bColor, dColor, cdColor, fColor, bdColor) {
  if (tColor != "") {
    titleColor=tColor;
  }
  if (dsColor != "") {
    daysColor=dsColor;
  }
  if (bColor != "") {
    bodyColor=bColor;
  }
  if (dColor != "") {
    dayColor=dColor;
  }
  if (cdColor != "") {
    currentDayColor=cdColor;
  }
  if (fColor != "") {
    footColor=fColor;
  }
  if (bdColor != "") {
    borderColor=bdColor;
  }
}

function setFontColor(tColorFont, dsColorFont, dColorFont, cdColorFont, fColorFont) {
  if (tColorFont != "") {
    titleFontColor=tColorFont;
  }
  if (dsColorFont != "") {
    daysFontColor=dsColorFont;
  }
  if (dColorFont != "") {
    dayFontColor=dColorFont;
  }
  if (cdColorFont != "") {
    currentDayFontColor=cdColorFont;
  }
  if (fColorFont != "") {
    footFontColor=fColorFont;
  }
}

function setFormat(format) {
  calFormat = format;
}

function setSize(width, height, ox, oy) {
  if (width > 0) {
    calWidth=width;
  }
  if (height > 0) {
    calHeight=height;
  }

  calOffsetX=ox;
  calOffsetY=oy;
}

function setWeekDay(wDay) {
  if (wDay == 0 || wDay == 1) {
    weekDay = wDay;
  }
}

function setMonthNames(janName, febName, marName, aprName, mayName, junName, julName, augName, sepName, octName, novName, decName) {
  if (janName != "") {
    yxMonths[0] = janName;
  }
  if (febName != "") {
    yxMonths[1] = febName;
  }
  if (marName != "") {
    yxMonths[2] = marName;
  }
  if (aprName != "") {
    yxMonths[3] = aprName;
  }
  if (mayName != "") {
    yxMonths[4] = mayName;
  }
  if (junName != "") {
    yxMonths[5] = junName;
  }
  if (julName != "") {
    yxMonths[6] = julName;
  }
  if (augName != "") {
    yxMonths[7] = augName;
  }
  if (sepName != "") {
    yxMonths[8] = sepName;
  }
  if (octName != "") {
    yxMonths[9] = octName;
  }
  if (novName != "") {
    yxMonths[10] = novName;
  }
  if (decName != "") {
    yxMonths[11] = decName;
  }
}

function setDayNames(sunName, monName, tueName, wedName, thuName, friName, satName) {
  if (sunName != "") {
    yxDays[0] = sunName;
    yxDays[7] = sunName;
  }
  if (monName != "") {
    yxDays[1] = monName;
  }
  if (tueName != "") {
    yxDays[2] = tueName;
  }
  if (wedName != "") {
    yxDays[3] = wedName;
  }
  if (thuName != "") {
    yxDays[4] = thuName;
  }
  if (friName != "") {
    yxDays[5] = friName;
  }
  if (satName != "") {
    yxDays[6] = satName;
  }
}

function setLinkNames(closeLink, clearLink) {
  if (closeLink != "") {
    yxLinks[0] = closeLink;
  }
  if (clearLink != "") {
    yxLinks[1] = clearLink;
  }
}

function addCalendar(name, title, field, form) {
  cals[cals.length] = new calOBJ(name, title, field, form);
}

function findCalendar(name) {
  for (var i = 0; i < cals.length; i++) {
    if (cals[i].name == name) {
      if (cals[i].form == null) {
        if (cals[i].formName == "") {
          if (document.forms[0]) {
            cals[i].form = document.forms[0];
          }
        }
        else if (document.forms[cals[i].formName]) {
          cals[i].form = document.forms[cals[i].formName];
        }
      }

      return cals[i];
    }
  }

  return null;
}

function getDayName(y,m,d) {
  var wd=new Date(y,m,d);
  return yxDays[wd.getDay()].substring(0,3);
}

function getMonthFromName(m3) {
  for (var i = 0; i < yxMonths.length; i++) {
    if (yxMonths[i].toLowerCase().substring(0,3) == m3.toLowerCase()) {
      return i;
    }
  }

  return 0;
}

function getFormat() {
  var calF = calFormat;

  calF = calF.replace(/\\/g, '\\\\');
  calF = calF.replace(/\//g, '\\\/');
  calF = calF.replace(/\[/g, '\\\[');
  calF = calF.replace(/\]/g, '\\\]');
  calF = calF.replace(/\(/g, '\\\(');
  calF = calF.replace(/\)/g, '\\\)');
  calF = calF.replace(/\{/g, '\\\{');
  calF = calF.replace(/\}/g, '\\\}');
  calF = calF.replace(/\</g, '\\\<');
  calF = calF.replace(/\>/g, '\\\>');
  calF = calF.replace(/\|/g, '\\\|');
  calF = calF.replace(/\*/g, '\\\*');
  calF = calF.replace(/\?/g, '\\\?');
  calF = calF.replace(/\+/g, '\\\+');
  calF = calF.replace(/\^/g, '\\\^');
  calF = calF.replace(/\$/g, '\\\$');

  calF = calF.replace(/dd/i, '\\d\\d');
  calF = calF.replace(/mm/i, '\\d\\d');
  calF = calF.replace(/yyyy/i, '\\d\\d\\d\\d');
  calF = calF.replace(/day/i, '\\w\\w\\w');
  calF = calF.replace(/mon/i, '\\w\\w\\w');

  return new RegExp(calF);
}

function getDateNumbers(date) {
  var y, m, d;

  var yIdx = calFormat.search(/yyyy/i);
  var mIdx = calFormat.search(/mm/i);
  var m3Idx = calFormat.search(/mon/i);
  var dIdx = calFormat.search(/dd/i);

  y=date.substring(yIdx,yIdx+4)-0;
  if (mIdx != -1) {
    m=date.substring(mIdx,mIdx+2)-1;
  }
  else {
    var m = getMonthFromName(date.substring(m3Idx,m3Idx+3));
  }
  d=date.substring(dIdx,dIdx+2)-0;

  return new Array(y,m,d);
}

function hideCal() {
  calWin.close();
  calWin = null;
  window.status = "";
}

function getLeftIE(x,m) {
  var dx=0;
  if (x.tagName=="TD"){
    dx=x.offsetLeft;
  }
  else if (x.tagName=="TABLE") {
    dx=x.offsetLeft;
    if (m) { dx+=(x.cellPadding!=""?parseInt(x.cellPadding):2); m=false; }
  }
  return dx+(x.parentElement.tagName=="BODY"?0:getLeftIE(x.parentElement,m));
}
function getTopIE(x,m) {
  var dy=0;
  if (x.tagName=="TR"){
    dy=x.offsetTop;
  }
  else if (x.tagName=="TABLE") {
    dy=x.offsetTop;
    if (m) { dy+=(x.cellPadding!=""?parseInt(x.cellPadding):2); m=false; }
  }
  return dy+(x.parentElement.tagName=="BODY"?0:getTopIE(x.parentElement,m));
}

function getLeftN4(l) { return l.pageX; }
function getTopN4(l) { return l.pageY; }

function getLeftN6(l) { return l.offsetLeft; }
function getTopN6(l) { return l.offsetTop; }

function lastDay(d) {
  var yy=d.getFullYear(), mm=d.getMonth();
  for (var i=31; i>=28; i--) {
    var nd=new Date(yy,mm,i);
    if (mm == nd.getMonth()) {
      return i;
    }
  }
}

function firstDay(d) {
  var yy=d.getFullYear(), mm=d.getMonth();
  var fd=new Date(yy,mm,1);
  return fd.getDay();
}

function dayDisplay(i) {
  if (dayDigits == 0) {
    return yxDays[i];
  }
  else {
    return yxDays[i].substring(0,dayDigits);
  }
}

function calTitle(d) {
  var yy=d.getFullYear(), mm=yxMonths[d.getMonth()];
  var s;

  if (titleMode == 2) {
    s="<tr align='center' bgcolor='"+titleColor+"'><td colspan='7'>\n<table cellpadding='0' cellspacing='0' border='0'><tr align='center' valign='middle'><td align='right'>"+span1("title")+"<b>"+a1("titlea")+"'javascript:if(window.opener && !window.opener.closed && window.opener.moveYear) window.opener.moveYear(-10)'> ?</a> "+a1("titlea")+"'javascript:if(window.opener && !window.opener.closed && window.opener.moveYear) window.opener.moveYear(-1)'>? </a></b>"+span2+"</td><td width='"+titleWidth+"'><b>"+span1("title")+yy+span2+"</b></td><td align='left'>"+span1("title")+"<b>"+a1("titlea")+"'javascript:if (window.opener && !window.opener.closed && window.opener.moveYear) window.opener.moveYear(1)'> ?</a> "+a1("titlea")+"'javascript:if (window.opener && !window.opener.closed && window.opener.moveYear) window.opener.moveYear(10)'>? </a></b>"+span2+"</td></tr><tr align='center' valign='middle'><td align='right'>"+span1("title")+"<b>"+a1("titlea")+"'javascript:if (window.opener && !window.opener.closed && window.opener.prepMonth) window.opener.prepMonth("+d.getMonth()+")'> ? </a></b>"+span2+"</td><td width='"+titleWidth+"'><b>"+span1("title")+mm+span2+"</b></td><td align='left'>"+span1("title")+"<b>"+a1("titlea")+"'javascript:if (window.opener && !window.opener.closed && window.opener.nextMonth) window.opener.nextMonth("+d.getMonth()+")'> ? </a></b>"+span2+"</td></tr></table>\n</td></tr><tr align='center' bgcolor='"+daysColor+"'>";
  }
  else {
    s="<tr align='center' bgcolor='"+titleColor+"'><td colspan='7'>\n<table cellpadding='0' cellspacing='0' border='0'><tr align='center' valign='middle'><td>"+span1("title")+"<b>"+a1("titlea")+"'javascript:if(window.opener && !window.opener.closed && window.opener.moveYear) window.opener.moveYear(-1)'> ?</a> "+a1("titlea")+"'javascript:if (window.opener && !window.opener.closed && window.opener.prepMonth) window.opener.prepMonth("+d.getMonth()+")'>? </a></b>"+span2+"</td><td width='"+titleWidth+"'><nobr><b>"+span1("title")+mm+" "+yy+span2+"</b></nobr></td><td>"+span1("title")+"<b>"+a1("titlea")+"'javascript:if (window.opener && !window.opener.closed && window.opener.nextMonth) window.opener.nextMonth("+d.getMonth()+")'> ?</a> "+a1("titlea")+"'javascript:if(window.opener && !window.opener.closed && window.opener.moveYear) window.opener.moveYear(1)'>? </a></b>"+span2+"</td></tr></table>\n</td></tr><tr align='center' bgcolor='"+daysColor+"'>";
  }

  for (var i=weekDay; i<weekDay+7; i++) {
    s+="<td width='"+dayWidth+"'>"+span1("days")+dayDisplay(i)+span2+"</td>";
  }

  s+="</tr>";

  return s;
}

function calHeader() {
  return "<head>\n<title>"+currentCal.title+"</title>\n<style type='text/css'>\n"+spanx("title",titleFontColor)+spanx("days",daysFontColor)+spanx("foot",footColor)+spanx("day",dayFontColor)+spanx("currentDay",currentDayFontColor)+ax("titlea",titleFontColor)+ax("daya",dayFontColor)+ax("currenta",currentDayFontColor)+ax("foota",footFontColor)+"</style>\n</head>\n<body>\n<table align='center' border='0' bgcolor='"+borderColor+"' cellspacing='0' cellpadding='1'><tr><td>\n<table cellspacing='1' cellpadding='3' border='0'>";
}

function calFooter() {
  return "<tr bgcolor='"+footColor+"'><td colspan='7' align='center'>"+span1("foot")+"<b>"+a1("foota")+"'javascript:if (window.opener && !window.opener.closed && window.opener.hideCal) window.opener.hideCal()'>"+yxLinks[0]+"</a>  "+a1("foota")+"'javascript:if (window.opener && !window.opener.closed && window.opener.clearDate) window.opener.clearDate()'>"+yxLinks[1]+"</a></b>"+span2+"</td></tr></table>\n</td></tr></table>\n</body>";
}

function calBody(d,day) {
  var s="", dayCount=1, fd=firstDay(d), ld=lastDay(d);

  if (weekDay > 0 && fd == 0) {
    fd = 7;
  }

  for (var i=0; i<6; i++) {
    s+="<tr align='center' bgcolor='"+bodyColor+"'>";
    for (var j=weekDay; j<weekDay+7; j++) {
      if (i*7+j<fd || dayCount>ld) {
        s+="<td>"+span1("day")+" "+span2+"</td>";
      }
      else {
        var bgColor=dayColor;
        var fgTag="day";
        var fgTagA="daya";
        if (dayCount==day) { 
          bgColor=currentDayColor; 
          fgTag="currentDay";
          fgTagA="currenta";
        }
        
        s+="<td bgcolor='"+bgColor+"'>"+span1(fgTag)+a1(fgTagA)+"'javascript: if (window.opener && !window.opener.closed && window.opener.pickDate) window.opener.pickDate("+dayCount+")'>"+(dayCount++)+"</a>"+span2+"</td>";
      }
    }
    s+="</tr>";
  }

  return s;
}

function moveYear(dy) {
  cY+=dy;
  var nd=new Date(cY,cM,1);
  changeCal(nd);
}

function prepMonth(m) {
  cM=m-1;
  if (cM<0) { cM=11; cY--; }
  var nd=new Date(cY,cM,1);
  changeCal(nd);
}

function nextMonth(m) {
  cM=m+1;
  if (cM>11) { cM=0; cY++;}
  var nd=new Date(cY,cM,1);
  changeCal(nd);
}

function changeCal(d) {
  var dd = 0;

  if (currentCal != null) {
    var calRE = getFormat();

    if (currentCal.form[currentCal.field].value!="" && calRE.test(currentCal.form[currentCal.field].value)) {
      var cd = getDateNumbers(currentCal.form[currentCal.field].value);
      if (cd[0] == d.getFullYear() && cd[1] == d.getMonth()) {
        dd=cd[2];
      }
    }
    else {
      var cd = new Date();
      if (cd.getFullYear() == d.getFullYear() && cd.getMonth() == d.getMonth()) {
        dd=cd.getDate();
      }
    }
  }

  var calendar=calHeader()+calTitle(d)+calBody(d,dd)+calFooter();

  calWin.document.open();
  calWin.document.write(calendar);
  calWin.document.close();
}

function markClick(e) {
  if (isIE || isOpera6) {
    winX=event.screenX;
    winY=event.screenY;
  }
  else if (isN4 || isN6) {
    winX=e.screenX;
    winY=e.screenY;

    document.routeEvent(e);
  }

  return true;
}

function showCal(name) {
  var lastCal=currentCal;
  var d=new Date(), hasCal=false;

  currentCal = findCalendar(name);

  if (currentCal != null && currentCal.form != null && currentCal.form[currentCal.field]) {
    var calRE = getFormat();

    if (currentCal.form[currentCal.field].value!="" && calRE.test(currentCal.form[currentCal.field].value)) {
      var cd = getDateNumbers(currentCal.form[currentCal.field].value);
      d=new Date(cd[0],cd[1],cd[2]);

      cY=cd[0];
      cM=cd[1];
      dd=cd[2];
    }
    else {
      cY=d.getFullYear();
      cM=d.getMonth();
      dd=d.getDate();
    }

    var calendar=calHeader()+calTitle(d)+calBody(d,dd)+calFooter();

    if (calWin != null && !calWin.closed) {
      hasCal=true;
      calWin.moveTo(winX+calOffsetX,winY+calOffsetY);
    }

    if (!hasCal) {
      if (isIE || isOpera6) {
        calWin=window.open("","cal","toolbar=0,width="+calWidth+",height="+calHeight+",left="+(winX+calOffsetX)+",top="+(winY+calOffsetY));
      }
      else {
        calWin=window.open("","cal","toolbar=0,width="+calWidth+",height="+calHeight+",screenx="+(winX+calOffsetX)+",screeny="+(winY+calOffsetY));
      }
    }

    calWin.document.open();
    calWin.document.write(calendar);
    calWin.document.close();

    calWin.focus();
  }
  else {
    if (currentCal == null) {
      window.status = "Calendar ["+name+"] not found.";
    }
    else if (!currentCal.form) {
      window.status = "Form ["+currentCal.formName+"] not found.";
    }
    else if (!currentCal.form[currentCal.field]) {
      window.status = "Form Field ["+currentCal.formName+"."+currentCal.field+"] not found.";
    }

    if (lastCal != null) {
      currentCal = lastCal;
    }
  }
}

function get2Digits(n) {
  return ((n<10)?"0":"")+n;
}

function clearDate() {
  currentCal.form[currentCal.field].value="";
  hideCal();
}

function pickDate(d) {
  hideCal();
  window.focus();

  var date=calFormat;
  date = date.replace(/yyyy/i, cY);
  date = date.replace(/mm/i, get2Digits(cM+1));
  date = date.replace(/MON/, yxMonths[cM].substring(0,3).toUpperCase());
  date = date.replace(/Mon/i, yxMonths[cM].substring(0,3));
  date = date.replace(/dd/i, get2Digits(d));
  date = date.replace(/DAY/, getDayName(cY,cM,d).toUpperCase());
  date = date.replace(/day/i, getDayName(cY,cM,d));

  currentCal.form[currentCal.field].value=date;
  // IE5/Mac needs focus to show the value, weird.
  currentCal.form[currentCal.field].focus();
}
// ------

// user functions
function checkDate(name) {
  var thisCal = findCalendar(name);

  if (thisCal != null && thisCal.form != null && thisCal.form[thisCal.field]) {
    var calRE = getFormat();

    if (calRE.test(thisCal.form[thisCal.field].value)) {
      return 0;
    }
    else {
      return 1;
    }
  }
  else {
    return 2;
  }
}

function getCurrentDate() {
  var date=calFormat, d = new Date();
  date = date.replace(/yyyy/i, d.getFullYear());
  date = date.replace(/mm/i, get2Digits(d.getMonth()+1));
  date = date.replace(/dd/i, get2Digits(d.getDate()));

  return date;
}

function compareDates(date1, date2) {
  var calRE = getFormat();
  var d1, d2;

  if (calRE.test(date1)) {
    d1 = getNumbers(date1);
  }
  else {
    d1 = getNumbers(getCurrentDate());
  }

  if (calRE.test(date2)) {
    d2 = getNumbers(date2);
  }
  else {
    d2 = getNumbers(getCurrentDate());
  }

  var dStr1 = d1[0] + "" + d1[1] + "" + d1[2];
  var dStr2 = d2[0] + "" + d2[1] + "" + d2[2];

  if (dStr1 == dStr2) {
    return 0;
  }
  else if (dStr1 > dStr2) {
    return 1;
  }
  else {
    return -1;
  }
}

function getNumbers(date) {
  var calRE = getFormat();
  var y, m, d;

  if (calRE.test(date)) {
    var yIdx = calFormat.search(/yyyy/i);
    var mIdx = calFormat.search(/mm/i);
    var m3Idx = calFormat.search(/mon/i);
    var dIdx = calFormat.search(/dd/i);

    y=date.substring(yIdx,yIdx+4);
    if (mIdx != -1) {
      m=date.substring(mIdx,mIdx+2);
    }
    else {
      var mm=getMonthFromName(date.substring(m3Idx,m3Idx+3))+1;
      m=(mm<10)?("0"+mm):(""+mm);
    }
    d=date.substring(dIdx,dIdx+2);

    return new Array(y,m,d);
  }
  else {
    return new Array("", "", "");
  }
}
// ------

if (isN4 || isN6) {
  document.captureEvents(Event.CLICK);
}
document.onclick=markClick;

</script>
<script language="javascript">

//Define calendar(s): addCalendar ("Unique Calendar Name", "Window title", "Form element's name", Form name")
addCalendar("Calendar1", "Select Date", "firstinput", "sampleform");
addCalendar("Calendar2", "Select Date", "secondinput", "sampleform");

// default settings for English
// Uncomment desired lines and modify its values
// setFont("verdana", 9);
 setWidth(90, 1, 15, 1);
// setColor("#cccccc", "#cccccc", "#ffffff", "#ffffff", "#333333", "#cccccc", "#333333");
// setFontColor("#333333", "#333333", "#333333", "#ffffff", "#333333");
// setFormat("yyyy/mm/dd");
// setSize(200, 200, -200, 16);

// setWeekDay(0);
// setMonthNames("January", "February", "March", "April", "May", "June", "July", "August", "September", "October", "November", "December");
// setDayNames("Sunday", "Monday", "Tuesday", "Wednesday", "Thursday", "Friday", "Saturday");
// setLinkNames("[Close]", "[Clear]");
</script>
<form name="sampleform">
<input type="text" name="firstinput" size=20> <small><a href="javascript:showCal('Calendar1')">选择日期一</a></small>
<p><input type="text" name="secondinput" size=20> <small><a href="javascript:showCal('Calendar2')">选择日期二</a></small>
</form>
</fieldset>

<br><br><br>
          <table width="500" border="0" cellspacing="0" cellpadding="0">
            <tr>
              <td>
                <table width="500" border="0" cellspacing="0" cellpadding="0">
                  <tr> 
                    <td bgcolor="#CCCCCC" width="15" height="16">&nbsp;</td>
                    <td width="96" bgcolor="#000000" height="16"> 
                      <div align="center"><font color="#FFFFFF">脚本说明：</font></div>
                    </td>
                    <td width="389" height="16">&nbsp;</td>
                  </tr>
                </table>
              </td>
            </tr>
            <tr>
              <td class="zf">
                <textarea name="textfield" cols="80" rows="10" class="textfield">脚本说明: 
&nbsp;
把如下代码加入<body>区域中
&nbsp;&lt;script language=&quot;javascript&quot;&gt;


// default settings
var fontFace=&quot;verdana&quot;;
var fontSize=9;

var titleWidth=90;
var titleMode=1;
var dayWidth=12;
var dayDigits=1;

var titleColor=&quot;#cccccc&quot;;
var daysColor=&quot;#cccccc&quot;;
var bodyColor=&quot;#ffffff&quot;;
var dayColor=&quot;#ffffff&quot;;
var currentDayColor=&quot;#333333&quot;;
var footColor=&quot;#cccccc&quot;;
var borderColor=&quot;#333333&quot;;

var titleFontColor = &quot;#333333&quot;;
var daysFontColor = &quot;#333333&quot;;
var dayFontColor = &quot;#333333&quot;;
var currentDayFontColor = &quot;#ffffff&quot;;
var footFontColor = &quot;#333333&quot;;

var calFormat = &quot;yyyy/mm/dd&quot;;

var weekDay = 0;
// ------

// codes
var calWidth=200, calHeight=200, calOffsetX=-200, calOffsetY=16;
var calWin=null;
var winX=0, winY=0;
var cal=&quot;cal&quot;;
var cals=new Array();
var currentCal=null;

var yxMonths=new Array(&quot;January&quot;, &quot;February&quot;, &quot;March&quot;, &quot;April&quot;, &quot;May&quot;, &quot;June&quot;, &quot;July&quot;, &quot;August&quot;, &quot;September&quot;, &quot;October&quot;, &quot;November&quot;, &quot;December&quot;);
var yxDays=new Array(&quot;Sunday&quot;, &quot;Monday&quot;, &quot;Tuesday&quot;, &quot;Wednesday&quot;, &quot;Thursday&quot;, &quot;Friday&quot;, &quot;Saturday&quot;, &quot;Sunday&quot;);
var yxLinks=new Array(&quot;[close]&quot;, &quot;[clear]&quot;);

var isOpera=(navigator.userAgent.indexOf(&quot;Opera&quot;)!=-1)?true:false;
var isOpera5=(navigator.appVersion.indexOf(&quot;MSIE 5&quot;)!=-1 &amp;&amp; navigator.userAgent.indexOf(&quot;Opera 5&quot;)!=-1)?true:false;
var isOpera6=(navigator.appVersion.indexOf(&quot;MSIE 5&quot;)!=-1 &amp;&amp; navigator.userAgent.indexOf(&quot;Opera 6&quot;)!=-1)?true:false;
var isN6=(navigator.userAgent.indexOf(&quot;Gecko&quot;)!=-1);
var isN4=(document.layers)?true:false;
var isMac=(navigator.userAgent.indexOf(&quot;Mac&quot;)!=-1);
var isIE=(document.all &amp;&amp; !isOpera &amp;&amp; (!isMac || navigator.appVersion.indexOf(&quot;MSIE 4&quot;)==-1))?true:false;

if (isN4) {
  fontSize+=2;
}

var span2=&quot;&lt;/span&gt;&quot;;

function span1(tag) {
  return &quot;&lt;span class='&quot;+tag+&quot;'&gt;&quot;;
}
function spanx(tag, color) {
  return &quot;.&quot;+tag+&quot; { font-family:&quot;+fontFace+&quot;; font-size:&quot;+fontSize+&quot;px; color:&quot;+color+&quot;; }\n&quot;;
}

function a1(tag) {
  return &quot;&lt;a class='&quot;+tag+&quot;' href=&quot;;
}

function ax(tag, color) {
  return &quot;.&quot;+tag+&quot; { text-decoration:none; color:&quot;+color+&quot;; }\n&quot;;
}

function calOBJ(name, title, field, form) {
  this.name = name;
  this.title = title;
  this.field = field;
  this.formName = form;
  this.form = null
}

function setFont(font, size) {
  if (font != &quot;&quot;) {
    fontFace=font;
  }
  if (size &gt; 0) {
    fontSize=size;

    if (isN4) {
      fontSize+=2;
    }
  }
}

function setWidth(tWidth, tMode, dWidth, dDigits) {
  if (tWidth &gt; 0) {
    titleWidth=tWidth;
  }
  if (tMode == 1 || tMode == 2) {
    titleMode=tMode;
  }
  if (dWidth &gt; 0) {
    dayWidth=dWidth;
  }
  if (dDigits &gt; 0) {
    dayDigits=dDigits;
  }
}

function setColor(tColor, dsColor, bColor, dColor, cdColor, fColor, bdColor) {
  if (tColor != &quot;&quot;) {
    titleColor=tColor;
  }
  if (dsColor != &quot;&quot;) {
    daysColor=dsColor;
  }
  if (bColor != &quot;&quot;) {
    bodyColor=bColor;
  }
  if (dColor != &quot;&quot;) {
    dayColor=dColor;
  }
  if (cdColor != &quot;&quot;) {
    currentDayColor=cdColor;
  }
  if (fColor != &quot;&quot;) {
    footColor=fColor;
  }
  if (bdColor != &quot;&quot;) {
    borderColor=bdColor;
  }
}

function setFontColor(tColorFont, dsColorFont, dColorFont, cdColorFont, fColorFont) {
  if (tColorFont != &quot;&quot;) {
    titleFontColor=tColorFont;
  }
  if (dsColorFont != &quot;&quot;) {
    daysFontColor=dsColorFont;
  }
  if (dColorFont != &quot;&quot;) {
    dayFontColor=dColorFont;
  }
  if (cdColorFont != &quot;&quot;) {
    currentDayFontColor=cdColorFont;
  }
  if (fColorFont != &quot;&quot;) {
    footFontColor=fColorFont;
  }
}

function setFormat(format) {
  calFormat = format;
}

function setSize(width, height, ox, oy) {
  if (width &gt; 0) {
    calWidth=width;
  }
  if (height &gt; 0) {
    calHeight=height;
  }

  calOffsetX=ox;
  calOffsetY=oy;
}

function setWeekDay(wDay) {
  if (wDay == 0 || wDay == 1) {
    weekDay = wDay;
  }
}

function setMonthNames(janName, febName, marName, aprName, mayName, junName, julName, augName, sepName, octName, novName, decName) {
  if (janName != &quot;&quot;) {
    yxMonths[0] = janName;
  }
  if (febName != &quot;&quot;) {
    yxMonths[1] = febName;
  }
  if (marName != &quot;&quot;) {
    yxMonths[2] = marName;
  }
  if (aprName != &quot;&quot;) {
    yxMonths[3] = aprName;
  }
  if (mayName != &quot;&quot;) {
    yxMonths[4] = mayName;
  }
  if (junName != &quot;&quot;) {
    yxMonths[5] = junName;
  }
  if (julName != &quot;&quot;) {
    yxMonths[6] = julName;
  }
  if (augName != &quot;&quot;) {
    yxMonths[7] = augName;
  }
  if (sepName != &quot;&quot;) {
    yxMonths[8] = sepName;
  }
  if (octName != &quot;&quot;) {
    yxMonths[9] = octName;
  }
  if (novName != &quot;&quot;) {
    yxMonths[10] = novName;
  }
  if (decName != &quot;&quot;) {
    yxMonths[11] = decName;
  }
}

function setDayNames(sunName, monName, tueName, wedName, thuName, friName, satName) {
  if (sunName != &quot;&quot;) {
    yxDays[0] = sunName;
    yxDays[7] = sunName;
  }
  if (monName != &quot;&quot;) {
    yxDays[1] = monName;
  }
  if (tueName != &quot;&quot;) {
    yxDays[2] = tueName;
  }
  if (wedName != &quot;&quot;) {
    yxDays[3] = wedName;
  }
  if (thuName != &quot;&quot;) {
    yxDays[4] = thuName;
  }
  if (friName != &quot;&quot;) {
    yxDays[5] = friName;
  }
  if (satName != &quot;&quot;) {
    yxDays[6] = satName;
  }
}

function setLinkNames(closeLink, clearLink) {
  if (closeLink != &quot;&quot;) {
    yxLinks[0] = closeLink;
  }
  if (clearLink != &quot;&quot;) {
    yxLinks[1] = clearLink;
  }
}

function addCalendar(name, title, field, form) {
  cals[cals.length] = new calOBJ(name, title, field, form);
}

function findCalendar(name) {
  for (var i = 0; i &lt; cals.length; i++) {
    if (cals[i].name == name) {
      if (cals[i].form == null) {
        if (cals[i].formName == &quot;&quot;) {
          if (document.forms[0]) {
            cals[i].form = document.forms[0];
          }
        }
        else if (document.forms[cals[i].formName]) {
          cals[i].form = document.forms[cals[i].formName];
        }
      }

      return cals[i];
    }
  }

  return null;
}

function getDayName(y,m,d) {
  var wd=new Date(y,m,d);
  return yxDays[wd.getDay()].substring(0,3);
}

function getMonthFromName(m3) {
  for (var i = 0; i &lt; yxMonths.length; i++) {
    if (yxMonths[i].toLowerCase().substring(0,3) == m3.toLowerCase()) {
      return i;
    }
  }

  return 0;
}

function getFormat() {
  var calF = calFormat;

  calF = calF.replace(/\\/g, '\\\\');
  calF = calF.replace(/\//g, '\\\/');
  calF = calF.replace(/\[/g, '\\\[');
  calF = calF.replace(/\]/g, '\\\]');
  calF = calF.replace(/\(/g, '\\\(');
  calF = calF.replace(/\)/g, '\\\)');
  calF = calF.replace(/\{/g, '\\\{');
  calF = calF.replace(/\}/g, '\\\}');
  calF = calF.replace(/\&lt;/g, '\\\&lt;');
  calF = calF.replace(/\&gt;/g, '\\\&gt;');
  calF = calF.replace(/\|/g, '\\\|');
  calF = calF.replace(/\*/g, '\\\*');
  calF = calF.replace(/\?/g, '\\\?');
  calF = calF.replace(/\+/g, '\\\+');
  calF = calF.replace(/\^/g, '\\\^');
  calF = calF.replace(/\$/g, '\\\$');

  calF = calF.replace(/dd/i, '\\d\\d');
  calF = calF.replace(/mm/i, '\\d\\d');
  calF = calF.replace(/yyyy/i, '\\d\\d\\d\\d');
  calF = calF.replace(/day/i, '\\w\\w\\w');
  calF = calF.replace(/mon/i, '\\w\\w\\w');

  return new RegExp(calF);
}

function getDateNumbers(date) {
  var y, m, d;

  var yIdx = calFormat.search(/yyyy/i);
  var mIdx = calFormat.search(/mm/i);
  var m3Idx = calFormat.search(/mon/i);
  var dIdx = calFormat.search(/dd/i);

  y=date.substring(yIdx,yIdx+4)-0;
  if (mIdx != -1) {
    m=date.substring(mIdx,mIdx+2)-1;
  }
  else {
    var m = getMonthFromName(date.substring(m3Idx,m3Idx+3));
  }
  d=date.substring(dIdx,dIdx+2)-0;

  return new Array(y,m,d);
}

function hideCal() {
  calWin.close();
  calWin = null;
  window.status = &quot;&quot;;
}

function getLeftIE(x,m) {
  var dx=0;
  if (x.tagName==&quot;TD&quot;){
    dx=x.offsetLeft;
  }
  else if (x.tagName==&quot;TABLE&quot;) {
    dx=x.offsetLeft;
    if (m) { dx+=(x.cellPadding!=&quot;&quot;?parseInt(x.cellPadding):2); m=false; }
  }
  return dx+(x.parentElement.tagName==&quot;BODY&quot;?0:getLeftIE(x.parentElement,m));
}
function getTopIE(x,m) {
  var dy=0;
  if (x.tagName==&quot;TR&quot;){
    dy=x.offsetTop;
  }
  else if (x.tagName==&quot;TABLE&quot;) {
    dy=x.offsetTop;
    if (m) { dy+=(x.cellPadding!=&quot;&quot;?parseInt(x.cellPadding):2); m=false; }
  }
  return dy+(x.parentElement.tagName==&quot;BODY&quot;?0:getTopIE(x.parentElement,m));
}

function getLeftN4(l) { return l.pageX; }
function getTopN4(l) { return l.pageY; }

function getLeftN6(l) { return l.offsetLeft; }
function getTopN6(l) { return l.offsetTop; }

function lastDay(d) {
  var yy=d.getFullYear(), mm=d.getMonth();
  for (var i=31; i&gt;=28; i--) {
    var nd=new Date(yy,mm,i);
    if (mm == nd.getMonth()) {
      return i;
    }
  }
}

function firstDay(d) {
  var yy=d.getFullYear(), mm=d.getMonth();
  var fd=new Date(yy,mm,1);
  return fd.getDay();
}

function dayDisplay(i) {
  if (dayDigits == 0) {
    return yxDays[i];
  }
  else {
    return yxDays[i].substring(0,dayDigits);
  }
}

function calTitle(d) {
  var yy=d.getFullYear(), mm=yxMonths[d.getMonth()];
  var s;

  if (titleMode == 2) {
    s=&quot;&lt;tr align='center' bgcolor='&quot;+titleColor+&quot;'&gt;&lt;td colspan='7'&gt;\n&lt;table cellpadding='0' cellspacing='0' border='0'&gt;&lt;tr align='center' valign='middle'&gt;&lt;td align='right'&gt;&quot;+span1(&quot;title&quot;)+&quot;&lt;b&gt;&quot;+a1(&quot;titlea&quot;)+&quot;'javascript:if(window.opener &amp;&amp; !window.opener.closed &amp;&amp; window.opener.moveYear) window.opener.moveYear(-10)'&gt; ?&lt;/a&gt; &quot;+a1(&quot;titlea&quot;)+&quot;'javascript:if(window.opener &amp;&amp; !window.opener.closed &amp;&amp; window.opener.moveYear) window.opener.moveYear(-1)'&gt;? &lt;/a&gt;&lt;/b&gt;&quot;+span2+&quot;&lt;/td&gt;&lt;td width='&quot;+titleWidth+&quot;'&gt;&lt;b&gt;&quot;+span1(&quot;title&quot;)+yy+span2+&quot;&lt;/b&gt;&lt;/td&gt;&lt;td align='left'&gt;&quot;+span1(&quot;title&quot;)+&quot;&lt;b&gt;&quot;+a1(&quot;titlea&quot;)+&quot;'javascript:if (window.opener &amp;&amp; !window.opener.closed &amp;&amp; window.opener.moveYear) window.opener.moveYear(1)'&gt; ?&lt;/a&gt; &quot;+a1(&quot;titlea&quot;)+&quot;'javascript:if (window.opener &amp;&amp; !window.opener.closed &amp;&amp; window.opener.moveYear) window.opener.moveYear(10)'&gt;? &lt;/a&gt;&lt;/b&gt;&quot;+span2+&quot;&lt;/td&gt;&lt;/tr&gt;&lt;tr align='center' valign='middle'&gt;&lt;td align='right'&gt;&quot;+span1(&quot;title&quot;)+&quot;&lt;b&gt;&quot;+a1(&quot;titlea&quot;)+&quot;'javascript:if (window.opener &amp;&amp; !window.opener.closed &amp;&amp; window.opener.prepMonth) window.opener.prepMonth(&quot;+d.getMonth()+&quot;)'&gt; ? &lt;/a&gt;&lt;/b&gt;&quot;+span2+&quot;&lt;/td&gt;&lt;td width='&quot;+titleWidth+&quot;'&gt;&lt;b&gt;&quot;+span1(&quot;title&quot;)+mm+span2+&quot;&lt;/b&gt;&lt;/td&gt;&lt;td align='left'&gt;&quot;+span1(&quot;title&quot;)+&quot;&lt;b&gt;&quot;+a1(&quot;titlea&quot;)+&quot;'javascript:if (window.opener &amp;&amp; !window.opener.closed &amp;&amp; window.opener.nextMonth) window.opener.nextMonth(&quot;+d.getMonth()+&quot;)'&gt; ? &lt;/a&gt;&lt;/b&gt;&quot;+span2+&quot;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;\n&lt;/td&gt;&lt;/tr&gt;&lt;tr align='center' bgcolor='&quot;+daysColor+&quot;'&gt;&quot;;
  }
  else {
    s=&quot;&lt;tr align='center' bgcolor='&quot;+titleColor+&quot;'&gt;&lt;td colspan='7'&gt;\n&lt;table cellpadding='0' cellspacing='0' border='0'&gt;&lt;tr align='center' valign='middle'&gt;&lt;td&gt;&quot;+span1(&quot;title&quot;)+&quot;&lt;b&gt;&quot;+a1(&quot;titlea&quot;)+&quot;'javascript:if(window.opener &amp;&amp; !window.opener.closed &amp;&amp; window.opener.moveYear) window.opener.moveYear(-1)'&gt; ?&lt;/a&gt; &quot;+a1(&quot;titlea&quot;)+&quot;'javascript:if (window.opener &amp;&amp; !window.opener.closed &amp;&amp; window.opener.prepMonth) window.opener.prepMonth(&quot;+d.getMonth()+&quot;)'&gt;? &lt;/a&gt;&lt;/b&gt;&quot;+span2+&quot;&lt;/td&gt;&lt;td width='&quot;+titleWidth+&quot;'&gt;&lt;nobr&gt;&lt;b&gt;&quot;+span1(&quot;title&quot;)+mm+&quot; &quot;+yy+span2+&quot;&lt;/b&gt;&lt;/nobr&gt;&lt;/td&gt;&lt;td&gt;&quot;+span1(&quot;title&quot;)+&quot;&lt;b&gt;&quot;+a1(&quot;titlea&quot;)+&quot;'javascript:if (window.opener &amp;&amp; !window.opener.closed &amp;&amp; window.opener.nextMonth) window.opener.nextMonth(&quot;+d.getMonth()+&quot;)'&gt; ?&lt;/a&gt; &quot;+a1(&quot;titlea&quot;)+&quot;'javascript:if(window.opener &amp;&amp; !window.opener.closed &amp;&amp; window.opener.moveYear) window.opener.moveYear(1)'&gt;? &lt;/a&gt;&lt;/b&gt;&quot;+span2+&quot;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;\n&lt;/td&gt;&lt;/tr&gt;&lt;tr align='center' bgcolor='&quot;+daysColor+&quot;'&gt;&quot;;
  }

  for (var i=weekDay; i&lt;weekDay+7; i++) {
    s+=&quot;&lt;td width='&quot;+dayWidth+&quot;'&gt;&quot;+span1(&quot;days&quot;)+dayDisplay(i)+span2+&quot;&lt;/td&gt;&quot;;
  }

  s+=&quot;&lt;/tr&gt;&quot;;

  return s;
}

function calHeader() {
  return &quot;&lt;head&gt;\n&lt;title&gt;&quot;+currentCal.title+&quot;&lt;/title&gt;\n&lt;style type='text/css'&gt;\n&quot;+spanx(&quot;title&quot;,titleFontColor)+spanx(&quot;days&quot;,daysFontColor)+spanx(&quot;foot&quot;,footColor)+spanx(&quot;day&quot;,dayFontColor)+spanx(&quot;currentDay&quot;,currentDayFontColor)+ax(&quot;titlea&quot;,titleFontColor)+ax(&quot;daya&quot;,dayFontColor)+ax(&quot;currenta&quot;,currentDayFontColor)+ax(&quot;foota&quot;,footFontColor)+&quot;&lt;/style&gt;\n&lt;/head&gt;\n&lt;body&gt;\n&lt;table align='center' border='0' bgcolor='&quot;+borderColor+&quot;' cellspacing='0' cellpadding='1'&gt;&lt;tr&gt;&lt;td&gt;\n&lt;table cellspacing='1' cellpadding='3' border='0'&gt;&quot;;
}

function calFooter() {
  return &quot;&lt;tr bgcolor='&quot;+footColor+&quot;'&gt;&lt;td colspan='7' align='center'&gt;&quot;+span1(&quot;foot&quot;)+&quot;&lt;b&gt;&quot;+a1(&quot;foota&quot;)+&quot;'javascript:if (window.opener &amp;&amp; !window.opener.closed &amp;&amp; window.opener.hideCal) window.opener.hideCal()'&gt;&quot;+yxLinks[0]+&quot;&lt;/a&gt;  &quot;+a1(&quot;foota&quot;)+&quot;'javascript:if (window.opener &amp;&amp; !window.opener.closed &amp;&amp; window.opener.clearDate) window.opener.clearDate()'&gt;&quot;+yxLinks[1]+&quot;&lt;/a&gt;&lt;/b&gt;&quot;+span2+&quot;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;\n&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;\n&lt;/body&gt;&quot;;
}

function calBody(d,day) {
  var s=&quot;&quot;, dayCount=1, fd=firstDay(d), ld=lastDay(d);

  if (weekDay &gt; 0 &amp;&amp; fd == 0) {
    fd = 7;
  }

  for (var i=0; i&lt;6; i++) {
    s+=&quot;&lt;tr align='center' bgcolor='&quot;+bodyColor+&quot;'&gt;&quot;;
    for (var j=weekDay; j&lt;weekDay+7; j++) {
      if (i*7+j&lt;fd || dayCount&gt;ld) {
        s+=&quot;&lt;td&gt;&quot;+span1(&quot;day&quot;)+&quot; &quot;+span2+&quot;&lt;/td&gt;&quot;;
      }
      else {
        var bgColor=dayColor;
        var fgTag=&quot;day&quot;;
        var fgTagA=&quot;daya&quot;;
        if (dayCount==day) { 
          bgColor=currentDayColor; 
          fgTag=&quot;currentDay&quot;;
          fgTagA=&quot;currenta&quot;;
        }
        
        s+=&quot;&lt;td bgcolor='&quot;+bgColor+&quot;'&gt;&quot;+span1(fgTag)+a1(fgTagA)+&quot;'javascript: if (window.opener &amp;&amp; !window.opener.closed &amp;&amp; window.opener.pickDate) window.opener.pickDate(&quot;+dayCount+&quot;)'&gt;&quot;+(dayCount++)+&quot;&lt;/a&gt;&quot;+span2+&quot;&lt;/td&gt;&quot;;
      }
    }
    s+=&quot;&lt;/tr&gt;&quot;;
  }

  return s;
}

function moveYear(dy) {
  cY+=dy;
  var nd=new Date(cY,cM,1);
  changeCal(nd);
}

function prepMonth(m) {
  cM=m-1;
  if (cM&lt;0) { cM=11; cY--; }
  var nd=new Date(cY,cM,1);
  changeCal(nd);
}

function nextMonth(m) {
  cM=m+1;
  if (cM&gt;11) { cM=0; cY++;}
  var nd=new Date(cY,cM,1);
  changeCal(nd);
}

function changeCal(d) {
  var dd = 0;

  if (currentCal != null) {
    var calRE = getFormat();

    if (currentCal.form[currentCal.field].value!=&quot;&quot; &amp;&amp; calRE.test(currentCal.form[currentCal.field].value)) {
      var cd = getDateNumbers(currentCal.form[currentCal.field].value);
      if (cd[0] == d.getFullYear() &amp;&amp; cd[1] == d.getMonth()) {
        dd=cd[2];
      }
    }
    else {
      var cd = new Date();
      if (cd.getFullYear() == d.getFullYear() &amp;&amp; cd.getMonth() == d.getMonth()) {
        dd=cd.getDate();
      }
    }
  }

  var calendar=calHeader()+calTitle(d)+calBody(d,dd)+calFooter();

  calWin.document.open();
  calWin.document.write(calendar);
  calWin.document.close();
}

function markClick(e) {
  if (isIE || isOpera6) {
    winX=event.screenX;
    winY=event.screenY;
  }
  else if (isN4 || isN6) {
    winX=e.screenX;
    winY=e.screenY;

    document.routeEvent(e);
  }

  return true;
}

function showCal(name) {
  var lastCal=currentCal;
  var d=new Date(), hasCal=false;

  currentCal = findCalendar(name);

  if (currentCal != null &amp;&amp; currentCal.form != null &amp;&amp; currentCal.form[currentCal.field]) {
    var calRE = getFormat();

    if (currentCal.form[currentCal.field].value!=&quot;&quot; &amp;&amp; calRE.test(currentCal.form[currentCal.field].value)) {
      var cd = getDateNumbers(currentCal.form[currentCal.field].value);
      d=new Date(cd[0],cd[1],cd[2]);

      cY=cd[0];
      cM=cd[1];
      dd=cd[2];
    }
    else {
      cY=d.getFullYear();
      cM=d.getMonth();
      dd=d.getDate();
    }

    var calendar=calHeader()+calTitle(d)+calBody(d,dd)+calFooter();

    if (calWin != null &amp;&amp; !calWin.closed) {
      hasCal=true;
      calWin.moveTo(winX+calOffsetX,winY+calOffsetY);
    }

    if (!hasCal) {
      if (isIE || isOpera6) {
        calWin=window.open(&quot;&quot;,&quot;cal&quot;,&quot;toolbar=0,width=&quot;+calWidth+&quot;,height=&quot;+calHeight+&quot;,left=&quot;+(winX+calOffsetX)+&quot;,top=&quot;+(winY+calOffsetY));
      }
      else {
        calWin=window.open(&quot;&quot;,&quot;cal&quot;,&quot;toolbar=0,width=&quot;+calWidth+&quot;,height=&quot;+calHeight+&quot;,screenx=&quot;+(winX+calOffsetX)+&quot;,screeny=&quot;+(winY+calOffsetY));
      }
    }

    calWin.document.open();
    calWin.document.write(calendar);
    calWin.document.close();

    calWin.focus();
  }
  else {
    if (currentCal == null) {
      window.status = &quot;Calendar [&quot;+name+&quot;] not found.&quot;;
    }
    else if (!currentCal.form) {
      window.status = &quot;Form [&quot;+currentCal.formName+&quot;] not found.&quot;;
    }
    else if (!currentCal.form[currentCal.field]) {
      window.status = &quot;Form Field [&quot;+currentCal.formName+&quot;.&quot;+currentCal.field+&quot;] not found.&quot;;
    }

    if (lastCal != null) {
      currentCal = lastCal;
    }
  }
}

function get2Digits(n) {
  return ((n&lt;10)?&quot;0&quot;:&quot;&quot;)+n;
}

function clearDate() {
  currentCal.form[currentCal.field].value=&quot;&quot;;
  hideCal();
}

function pickDate(d) {
  hideCal();
  window.focus();

  var date=calFormat;
  date = date.replace(/yyyy/i, cY);
  date = date.replace(/mm/i, get2Digits(cM+1));
  date = date.replace(/MON/, yxMonths[cM].substring(0,3).toUpperCase());
  date = date.replace(/Mon/i, yxMonths[cM].substring(0,3));
  date = date.replace(/dd/i, get2Digits(d));
  date = date.replace(/DAY/, getDayName(cY,cM,d).toUpperCase());
  date = date.replace(/day/i, getDayName(cY,cM,d));

  currentCal.form[currentCal.field].value=date;
  // IE5/Mac needs focus to show the value, weird.
  currentCal.form[currentCal.field].focus();
}
// ------

// user functions
function checkDate(name) {
  var thisCal = findCalendar(name);

  if (thisCal != null &amp;&amp; thisCal.form != null &amp;&amp; thisCal.form[thisCal.field]) {
    var calRE = getFormat();

    if (calRE.test(thisCal.form[thisCal.field].value)) {
      return 0;
    }
    else {
      return 1;
    }
  }
  else {
    return 2;
  }
}

function getCurrentDate() {
  var date=calFormat, d = new Date();
  date = date.replace(/yyyy/i, d.getFullYear());
  date = date.replace(/mm/i, get2Digits(d.getMonth()+1));
  date = date.replace(/dd/i, get2Digits(d.getDate()));

  return date;
}

function compareDates(date1, date2) {
  var calRE = getFormat();
  var d1, d2;

  if (calRE.test(date1)) {
    d1 = getNumbers(date1);
  }
  else {
    d1 = getNumbers(getCurrentDate());
  }

  if (calRE.test(date2)) {
    d2 = getNumbers(date2);
  }
  else {
    d2 = getNumbers(getCurrentDate());
  }

  var dStr1 = d1[0] + &quot;&quot; + d1[1] + &quot;&quot; + d1[2];
  var dStr2 = d2[0] + &quot;&quot; + d2[1] + &quot;&quot; + d2[2];

  if (dStr1 == dStr2) {
    return 0;
  }
  else if (dStr1 &gt; dStr2) {
    return 1;
  }
  else {
    return -1;
  }
}

function getNumbers(date) {
  var calRE = getFormat();
  var y, m, d;

  if (calRE.test(date)) {
    var yIdx = calFormat.search(/yyyy/i);
    var mIdx = calFormat.search(/mm/i);
    var m3Idx = calFormat.search(/mon/i);
    var dIdx = calFormat.search(/dd/i);

    y=date.substring(yIdx,yIdx+4);
    if (mIdx != -1) {
      m=date.substring(mIdx,mIdx+2);
    }
    else {
      var mm=getMonthFromName(date.substring(m3Idx,m3Idx+3))+1;
      m=(mm&lt;10)?(&quot;0&quot;+mm):(&quot;&quot;+mm);
    }
    d=date.substring(dIdx,dIdx+2);

    return new Array(y,m,d);
  }
  else {
    return new Array(&quot;&quot;, &quot;&quot;, &quot;&quot;);
  }
}
// ------

if (isN4 || isN6) {
  document.captureEvents(Event.CLICK);
}
document.onclick=markClick;

&lt;/script&gt;
&lt;script language=&quot;javascript&quot;&gt;

//Define calendar(s): addCalendar (&quot;Unique Calendar Name&quot;, &quot;Window title&quot;, &quot;Form element's name&quot;, Form name&quot;)
addCalendar(&quot;Calendar1&quot;, &quot;Select Date&quot;, &quot;firstinput&quot;, &quot;sampleform&quot;);
addCalendar(&quot;Calendar2&quot;, &quot;Select Date&quot;, &quot;secondinput&quot;, &quot;sampleform&quot;);

// default settings for English
// Uncomment desired lines and modify its values
// setFont(&quot;verdana&quot;, 9);
 setWidth(90, 1, 15, 1);
// setColor(&quot;#cccccc&quot;, &quot;#cccccc&quot;, &quot;#ffffff&quot;, &quot;#ffffff&quot;, &quot;#333333&quot;, &quot;#cccccc&quot;, &quot;#333333&quot;);
// setFontColor(&quot;#333333&quot;, &quot;#333333&quot;, &quot;#333333&quot;, &quot;#ffffff&quot;, &quot;#333333&quot;);
// setFormat(&quot;yyyy/mm/dd&quot;);
// setSize(200, 200, -200, 16);

// setWeekDay(0);
// setMonthNames(&quot;January&quot;, &quot;February&quot;, &quot;March&quot;, &quot;April&quot;, &quot;May&quot;, &quot;June&quot;, &quot;July&quot;, &quot;August&quot;, &quot;September&quot;, &quot;October&quot;, &quot;November&quot;, &quot;December&quot;);
// setDayNames(&quot;Sunday&quot;, &quot;Monday&quot;, &quot;Tuesday&quot;, &quot;Wednesday&quot;, &quot;Thursday&quot;, &quot;Friday&quot;, &quot;Saturday&quot;);
// setLinkNames(&quot;[Close]&quot;, &quot;[Clear]&quot;);
&lt;/script&gt;
&lt;form name=&quot;sampleform&quot;&gt;
&lt;input type=&quot;text&quot; name=&quot;firstinput&quot; size=20&gt; &lt;small&gt;&lt;a href=&quot;javascript:showCal('Calendar1')&quot;&gt;选择日期一&lt;/a&gt;&lt;/small&gt;
&lt;p&gt;&lt;input type=&quot;text&quot; name=&quot;secondinput&quot; size=20&gt; &lt;small&gt;&lt;a href=&quot;javascript:showCal('Calendar2')&quot;&gt;选择日期二&lt;/a&gt;&lt;/small&gt;
&lt;/form&gt;




&nbsp;

</textarea>
              </td>
            </tr>
          </table>
        </div>
      </td>
    </tr>
  </table>
  <hr width="770">
   <table width="770" border="0" cellspacing="0" cellpadding="0" height="21">
    <tr>
      <td bgcolor="#CCCCCC" valign="middle">
        <div align="center"><script language=javascript src=buttom.js></script></div>
      </td>
    </tr>
    <tr>
      <td>
        <div align="center"></div>
      </td>
    </tr>
  </table>
</div>
</body>
</html>
