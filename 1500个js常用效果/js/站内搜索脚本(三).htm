<style>
<!--
BODY{FONT-FAMILY: 宋体; FONT-SIZE: 12.6px;
SCROLLBAR-HIGHLIGHT-COLOR: buttonface;
SCROLLBAR-SHADOW-COLOR: buttonface;
SCROLLBAR-3DLIGHT-COLOR: buttonhighlight;
SCROLLBAR-TRACK-COLOR: #eeeeee;
SCROLLBAR-DARKSHADOW-COLOR: buttonshadow}
td,form,select {FONT-SIZE: 12px; LINE-HEIGHT: 20px}
input {FONT-SIZE: 12px; BORDER: #000000 1px solid;height: 18px; BACKGROUND-color: #f7f7ff; COLOR: #000000;}
.small {FONT-SIZE: 1px; LINE-HEIGHT: 1px}
.mid {FONT-SIZE: 12px;LINE-HEIGHT: 20px}
A:active {COLOR: #ff0000; TEXT-DECORATION: none}
A:hover {COLOR: #ff0000; TEXT-DECORATION: underline}
A:link {COLOR: #000000; TEXT-DECORATION: none}
A:visited {COLOR: #000000; TEXT-DECORATION: none}
-->
</style>
 
<html>
<head>
<title>仲夏夜--js特效--站内搜索脚本(三)</title>
<meta http-equiv="Content-Type" content="text/html; charset=gb2312">
<LINK href="css/the9.css" 
rel=stylesheet type=text/css>
<style type="text/css">
<!--
.zf {  border: #999999; border-style: solid; border-top-width: 1px; border-right-width: 1px; border-bottom-width: 1px; border-left-width: 1px}
-->
</style>
<script src="ad.js"></script>
</head>
<body bgcolor=#FFFFFF>

<div align="center" > 
****************
    <tr> 
      **********
    </tr>
  </table>
  <table width="770" border="0" cellspacing="0" cellpadding="0" class="zf1">
    <tr>
      ***********
      ************
      *************
          <tr>
**************
 <SCRIPT LANGUAGE="JavaScript">
<!-- Begin
function addbookmark()
{
bookmarkurl="http://5icat.net.ru"
bookmarktitle="欢迎光临仲夏夜"
if (document.all)
window.external.AddFavorite(bookmarkurl,bookmarktitle)
}
//  End -->
</script>
***************</div></td>
          </tr>
          <tr>
            <td height="15"><div align="center"><img src="images/little2.gif" width="9" height="9">
 <span  onclick="var strHref=window.location.href;this.style.behavior='url(#default#homepage)';this.setHomePage('http://5icat.net.ru');"  style="CURSOR: hand"> 设为首页</a></span></div></td>
          </tr>
          <tr>
            <td><div align="center"><img src="images/little3.gif" width="9" height="9"><script src="../mail.js"></script></div></td>
          </tr>
        </table></td>
    </tr>
  </table>
   <table width="770" border="0" cellspacing="0" cellpadding="0" class="zf1">
    <tr> 
      <td  height="20"><table width="768" height="19" border="0" align="center" cellpadding="0" cellspacing="0" background="images/menubg.gif">    
          <script src="js.js"></script>
        </table></td>
    </tr>
  </table>
  <table width="770" border="0" cellspacing="0" cellpadding="0" bgcolor="#CCCCCC"class="zf1">
    <tr>
      <td class="zf3"><script language="JavaScript">
<!--
var enabled = 0; today = new Date();
var day; var date;
if(today.getDay()==0) day = "星期日"
if(today.getDay()==1) day = "星期一"
if(today.getDay()==2) day = "星期二"
if(today.getDay()==3) day = "星期三"
if(today.getDay()==4) day = "星期四"
if(today.getDay()==5) day = "星期五"
if(today.getDay()==6) day = "星期六"
date = "" + (today.getYear()) + "年" + (today.getMonth() + 1 ) + "月" + today.getDate() + "日  " + day +"";
document.write("<font color=black>" + date + "</font>");
-->
</script></td><td align=right>****************</td>
    </tr>
  </table>
<!--<IFRAME width=770 height=60 style="backgroundcolor: #CCCCCC" marginwidth="0" marginheight="0"  frameborder="0" scrolling="NO"   src="ad_top.htm"></IFRAME> -->
  <table width="770" border="0" cellspacing="0" cellpadding="0" >
    <tr>
      <td height="2"></td>
    </tr>
  </table>
  <table width="770" border="0" cellspacing="10" cellpadding="0" bgcolor="#CCCCCC">
    <tr> 
      <td bgcolor="#FFFFFF" height="501" valign="top"> 
        <div align="center"> <br>
          
          
 <table width="700" border="0" cellspacing="0" cellpadding="0">
            <tr>
              <td width="200">&nbsp;</td>
              <td> 
                <table width="300" border="1" cellspacing="0" cellpadding="0" align="center">
                  <tr> 
                    <td bgcolor="#CCCCCC" height="20" width="15">&nbsp;</td>
                    <td bgcolor="#999999" height="20" width="260"> 
					
                      <div align="center"><font color="#FFFFFF" size="3">站内搜索脚本(三)</font></div>
                    </td>
                    <td bgcolor="#CCCCCC" height="20" width="17">&nbsp;</td>
                  </tr>
                </table>
              </td>
              <td width="10"><a href="UserCollect.asp?action=add&id=1042" target="Collect">****************</a></td>
            </tr>
          </table>
          <br>
          <fieldset style="width:500;height:50"><legend>效果显示区</legend> 
         
<script language="javascript">
        var key = "";
        function makeEntry (){
                this.Name="";
                this.URL = "";
                this.Desc = "";
                this.Category = "";
                this.Target = "";
                return this;
        }

 function makeArray(n) {
                this.length = n;
                for (var k = 1; k <= n; k++) {
                                this[k] = "";
                }
                return this;
        }               

        function makeLinks(size) {
                                this.length = size;
                                for (var r=1; r<= size; r++) {
                                                        this[r] = new makeEntry();
                                                        this[r].Name = namesArray[r];
                                                        this[r].URL = urlsArray[r];
                                                        this[r].Desc = descArray[r];
                                                        this[r].Category = categoryArray[r];
                                                        this[r].Target = targetArray[r];
                                                        }
                                        return this;
                        }


var linksize=0 

datesArray = new makeArray(linksize);
namesArray = new makeArray(linksize);
urlsArray = new makeArray(linksize);
descArray = new makeArray(linksize);
categoryArray = new makeArray(linksize);
targetArray = new makeArray(linksize);


var arraycount=0

<!-- 数据库部分由此开始 -->
arraycount += 1 
urlsArray[arraycount] = "http://www.njcatv.net/javascript/index.htm"
namesArray[arraycount] = "javascript页面特效"
descArray[arraycount] = "java, javascript, scripts, applet, html, dhtml ,activex, midi, search, downloads, 脚本, free, 免费资源"
categoryArray[arraycount] = "最酷的java脚本资源站,大量详细的java源代码和实例说明!"
targetArray[arraycount] = "target=_blank"


arraycount += 1 
urlsArray[arraycount] = "http://www.si.hhs.nl/~v962343/home.html"
namesArray[arraycount] = "Richie's Place"
descArray[arraycount] = "richie's place, anime, manga, pictures, pics, movies, links, gif animations, animation, hentai, java, link"
categoryArray[arraycount] = "Richie's Place! Over 30 pages! with a picture gallery, movies, gif animations, games, java and more."
targetArray[arraycount] = "target=_blank"

linksize = arraycount;

// ----数据库结束 ------
// ----以下是输出结果检索结果的页面代码 ----

function searchLinks(links, keyword){
        document.write("<BODY fontsize='2' BGCOLOR='#000000' TEXT='#ffffff' LINK='#ccffcc' VLINK='#ffffff'>")
        document.write("搜索关键字结果: <strong>" +keyword +"</strong><br><br>");
        for (var q=1; q<=links.length; q++) {

        if (links[q].URL.toLowerCase().indexOf(keyword) != -1){
          document.write("<a href=" + links[q].URL +" " + links[q].Target + ">" + links[q].Name + "</a> - ");
          
          document.write( links[q].Category + "<br><br>");
          continue;
         }
        if (links[q].Desc.toLowerCase().indexOf(keyword) != -1) {
          document.write("<a href=" + links[q].URL +" " + links[q].Target + ">" + links[q].Name + "</a> - ");
          
          document.write( links[q].Category + "<br><br>");
          continue;
         }
        if (links[q].Name.toLowerCase().indexOf(keyword) != -1) {
          document.write("<a href=" + links[q].URL +" " + links[q].Target + ">" + links[q].Name + "</a> - ");
          
          document.write( links[q].Category + "<br><br>");
          continue;
         }

     }                                       


}

</script>
  <font size="5" color="#FF0000">站内搜索引擎<br>
  </font><font color="#FF0000"> <font color="#000000">测试：输入关键字&quot;java&quot; 
  或中文字符&quot;免费&quot; 查询。</font></font> </div>
<form name="form">
  <div align="center"> 
    <p>查询关键字： 
      <input type="text" size=20 name="search">
      <input type="button" name="submit" value="开始查询" onClick="validate_form()" class="pt9">
      <input type="reset" name="reset" value="清除" class="pt9">
      <br>
    </p>
    
  </div>
</form>
<!-- 以下是合法性检测 -->
<script>
function validate_form() {
 
  txt = document.form.search.value;
  if (txt.indexOf(".") != -1){
        alert("Search is invalid! Contains a '.'"); return;}
  if (txt.indexOf(",") != -1){
        alert("Search is invalid! Contains a ','"); return;}
  if (txt.indexOf("@") != -1){
        alert("Search is invalid! Contains a '@''"); return;}
  if (txt.indexOf("!") != -1){
        alert("Search is invalid! Contains a '!''"); return;}
  if (txt.indexOf("#") != -1){
        alert("Search is invalid! Contains a '#''"); return;}
  if (txt.indexOf("$") != -1){
        alert("Search is invalid! Contains a '$''"); return;}
  if (txt.indexOf("%") != -1){
        alert("Search is invalid! Contains a '%''"); return;}
  if (txt.indexOf("^") != -1){
        alert("Search is invalid! Contains a '^''"); return;}
  if (txt.indexOf("&") != -1){
        alert("Search is invalid! Contains a '&''"); return;}
  if (txt.indexOf("*") != -1){
        alert("Search is invalid! Contains a '*''"); return;}
  if (txt.indexOf("(") != -1){
        alert("Search is invalid! Contains a '(''"); return;}
  if (txt.indexOf(")") != -1){
        alert("Search is invalid! Contains a ')''"); return;}
  if (txt.indexOf("[") != -1){
        alert("Search is invalid! Contains a '[''"); return;}
  if (txt.indexOf("]") != -1){
        alert("Search is invalid! Contains a ']''"); return;}
  if (txt.indexOf(";") != -1){
        alert("Search is invalid! Contains a ';''"); return;}
  if (txt.indexOf(":") != -1){
        alert("Search is invalid! Contains a ':''"); return;}
  if (txt.indexOf("<") != -1){
        alert("Search is invalid! Contains a '<''"); return;}
  if (txt.indexOf(">") != -1){
        alert("Search is invalid! Contains a '>''"); return;}
  if (txt.indexOf("?") != -1){
        alert("Search is invalid! Contains a '?''"); return;}
  if (txt.indexOf("-") != -1){
        alert("Search is invalid! Contains a '-''"); return;}
  if (txt.indexOf("=") != -1){
        alert("Search is invalid! Contains a '=''"); return;}
  if (txt.indexOf("+") != -1){
        alert("Search is invalid! Contains a '+''"); return;}
  else {
        jsi = new makeLinks(linksize);
        searchLinks(jsi, txt);
document.write("<hr>");
document.write("<a href='search3.htm'>返回检索页</a><br><br> ");
//将searchabledb2.htm替换为检索页的URL，以便访问者返回检索页。
}

}
</script></fieldset>

<br><br><br>
          <table width="500" border="0" cellspacing="0" cellpadding="0">
            <tr>
              <td>
                <table width="500" border="0" cellspacing="0" cellpadding="0">
                  <tr> 
                    <td bgcolor="#CCCCCC" width="15" height="16">&nbsp;</td>
                    <td width="96" bgcolor="#000000" height="16"> 
                      <div align="center"><font color="#FFFFFF">脚本说明：</font></div>
                    </td>
                    <td width="389" height="16">&nbsp;</td>
                  </tr>
                </table>
              </td>
            </tr>
            <tr>
              <td class="zf">
                <textarea name="textfield" cols="80" rows="10" class="textfield">脚本说明: 
&nbsp;
把如下代码加入<body>区域中
&nbsp;&lt;script language=&quot;javascript&quot;&gt;
        var key = &quot;&quot;;
        function makeEntry (){
                this.Name=&quot;&quot;;
                this.URL = &quot;&quot;;
                this.Desc = &quot;&quot;;
                this.Category = &quot;&quot;;
                this.Target = &quot;&quot;;
                return this;
        }

 function makeArray(n) {
                this.length = n;
                for (var k = 1; k &lt;= n; k++) {
                                this[k] = &quot;&quot;;
                }
                return this;
        }               

        function makeLinks(size) {
                                this.length = size;
                                for (var r=1; r&lt;= size; r++) {
                                                        this[r] = new makeEntry();
                                                        this[r].Name = namesArray[r];
                                                        this[r].URL = urlsArray[r];
                                                        this[r].Desc = descArray[r];
                                                        this[r].Category = categoryArray[r];
                                                        this[r].Target = targetArray[r];
                                                        }
                                        return this;
                        }


var linksize=0 

datesArray = new makeArray(linksize);
namesArray = new makeArray(linksize);
urlsArray = new makeArray(linksize);
descArray = new makeArray(linksize);
categoryArray = new makeArray(linksize);
targetArray = new makeArray(linksize);


var arraycount=0

&lt;!-- 数据库部分由此开始 --&gt;
arraycount += 1 
urlsArray[arraycount] = &quot;http://www.njcatv.net/javascript/index.htm&quot;
namesArray[arraycount] = &quot;javascript页面特效&quot;
descArray[arraycount] = &quot;java, javascript, scripts, applet, html, dhtml ,activex, midi, search, downloads, 脚本, free, 免费资源&quot;
categoryArray[arraycount] = &quot;最酷的java脚本资源站,大量详细的java源代码和实例说明!&quot;
targetArray[arraycount] = &quot;target=_blank&quot;


arraycount += 1 
urlsArray[arraycount] = &quot;http://www.si.hhs.nl/~v962343/home.html&quot;
namesArray[arraycount] = &quot;Richie's Place&quot;
descArray[arraycount] = &quot;richie's place, anime, manga, pictures, pics, movies, links, gif animations, animation, hentai, java, link&quot;
categoryArray[arraycount] = &quot;Richie's Place! Over 30 pages! with a picture gallery, movies, gif animations, games, java and more.&quot;
targetArray[arraycount] = &quot;target=_blank&quot;

linksize = arraycount;

// ----数据库结束 ------
// ----以下是输出结果检索结果的页面代码 ----

function searchLinks(links, keyword){
        document.write(&quot;&lt;BODY fontsize='2' BGCOLOR='#000000' TEXT='#ffffff' LINK='#ccffcc' VLINK='#ffffff'&gt;&quot;)
        document.write(&quot;搜索关键字结果: &lt;strong&gt;&quot; +keyword +&quot;&lt;/strong&gt;&lt;br&gt;&lt;br&gt;&quot;);
        for (var q=1; q&lt;=links.length; q++) {

        if (links[q].URL.toLowerCase().indexOf(keyword) != -1){
          document.write(&quot;&lt;a href=&quot; + links[q].URL +&quot; &quot; + links[q].Target + &quot;&gt;&quot; + links[q].Name + &quot;&lt;/a&gt; - &quot;);
          
          document.write( links[q].Category + &quot;&lt;br&gt;&lt;br&gt;&quot;);
          continue;
         }
        if (links[q].Desc.toLowerCase().indexOf(keyword) != -1) {
          document.write(&quot;&lt;a href=&quot; + links[q].URL +&quot; &quot; + links[q].Target + &quot;&gt;&quot; + links[q].Name + &quot;&lt;/a&gt; - &quot;);
          
          document.write( links[q].Category + &quot;&lt;br&gt;&lt;br&gt;&quot;);
          continue;
         }
        if (links[q].Name.toLowerCase().indexOf(keyword) != -1) {
          document.write(&quot;&lt;a href=&quot; + links[q].URL +&quot; &quot; + links[q].Target + &quot;&gt;&quot; + links[q].Name + &quot;&lt;/a&gt; - &quot;);
          
          document.write( links[q].Category + &quot;&lt;br&gt;&lt;br&gt;&quot;);
          continue;
         }

     }                                       


}

&lt;/script&gt;
  &lt;font size=&quot;5&quot; color=&quot;#FF0000&quot;&gt;站内搜索引擎&lt;br&gt;
  &lt;/font&gt;&lt;font color=&quot;#FF0000&quot;&gt; &lt;font color=&quot;#000000&quot;&gt;测试：输入关键字&amp;quot;java&amp;quot; 
  或中文字符&amp;quot;免费&amp;quot; 查询。&lt;/font&gt;&lt;/font&gt; &lt;/div&gt;
&lt;form name=&quot;form&quot;&gt;
  &lt;div align=&quot;center&quot;&gt; 
    &lt;p&gt;查询关键字： 
      &lt;input type=&quot;text&quot; size=20 name=&quot;search&quot;&gt;
      &lt;input type=&quot;button&quot; name=&quot;submit&quot; value=&quot;开始查询&quot; onClick=&quot;validate_form()&quot; class=&quot;pt9&quot;&gt;
      &lt;input type=&quot;reset&quot; name=&quot;reset&quot; value=&quot;清除&quot; class=&quot;pt9&quot;&gt;
      &lt;br&gt;
    &lt;/p&gt;
    
  &lt;/div&gt;
&lt;/form&gt;
&lt;!-- 以下是合法性检测 --&gt;
&lt;script&gt;
function validate_form() {
 
  txt = document.form.search.value;
  if (txt.indexOf(&quot;.&quot;) != -1){
        alert(&quot;Search is invalid! Contains a '.'&quot;); return;}
  if (txt.indexOf(&quot;,&quot;) != -1){
        alert(&quot;Search is invalid! Contains a ','&quot;); return;}
  if (txt.indexOf(&quot;@&quot;) != -1){
        alert(&quot;Search is invalid! Contains a '@''&quot;); return;}
  if (txt.indexOf(&quot;!&quot;) != -1){
        alert(&quot;Search is invalid! Contains a '!''&quot;); return;}
  if (txt.indexOf(&quot;#&quot;) != -1){
        alert(&quot;Search is invalid! Contains a '#''&quot;); return;}
  if (txt.indexOf(&quot;$&quot;) != -1){
        alert(&quot;Search is invalid! Contains a '$''&quot;); return;}
  if (txt.indexOf(&quot;%&quot;) != -1){
        alert(&quot;Search is invalid! Contains a '%''&quot;); return;}
  if (txt.indexOf(&quot;^&quot;) != -1){
        alert(&quot;Search is invalid! Contains a '^''&quot;); return;}
  if (txt.indexOf(&quot;&amp;&quot;) != -1){
        alert(&quot;Search is invalid! Contains a '&amp;''&quot;); return;}
  if (txt.indexOf(&quot;*&quot;) != -1){
        alert(&quot;Search is invalid! Contains a '*''&quot;); return;}
  if (txt.indexOf(&quot;(&quot;) != -1){
        alert(&quot;Search is invalid! Contains a '(''&quot;); return;}
  if (txt.indexOf(&quot;)&quot;) != -1){
        alert(&quot;Search is invalid! Contains a ')''&quot;); return;}
  if (txt.indexOf(&quot;[&quot;) != -1){
        alert(&quot;Search is invalid! Contains a '[''&quot;); return;}
  if (txt.indexOf(&quot;]&quot;) != -1){
        alert(&quot;Search is invalid! Contains a ']''&quot;); return;}
  if (txt.indexOf(&quot;;&quot;) != -1){
        alert(&quot;Search is invalid! Contains a ';''&quot;); return;}
  if (txt.indexOf(&quot;:&quot;) != -1){
        alert(&quot;Search is invalid! Contains a ':''&quot;); return;}
  if (txt.indexOf(&quot;&lt;&quot;) != -1){
        alert(&quot;Search is invalid! Contains a '&lt;''&quot;); return;}
  if (txt.indexOf(&quot;&gt;&quot;) != -1){
        alert(&quot;Search is invalid! Contains a '&gt;''&quot;); return;}
  if (txt.indexOf(&quot;?&quot;) != -1){
        alert(&quot;Search is invalid! Contains a '?''&quot;); return;}
  if (txt.indexOf(&quot;-&quot;) != -1){
        alert(&quot;Search is invalid! Contains a '-''&quot;); return;}
  if (txt.indexOf(&quot;=&quot;) != -1){
        alert(&quot;Search is invalid! Contains a '=''&quot;); return;}
  if (txt.indexOf(&quot;+&quot;) != -1){
        alert(&quot;Search is invalid! Contains a '+''&quot;); return;}
  else {
        jsi = new makeLinks(linksize);
        searchLinks(jsi, txt);
document.write(&quot;&lt;hr&gt;&quot;);
document.write(&quot;&lt;a href='search3.htm'&gt;返回检索页&lt;/a&gt;&lt;br&gt;&lt;br&gt; &quot;);
//将searchabledb2.htm替换为检索页的URL，以便访问者返回检索页。
}

}
&lt;/script&gt;



&nbsp;

</textarea>
              </td>
            </tr>
          </table>
        </div>
      </td>
    </tr>
  </table>
  <hr width="770">
   <table width="770" border="0" cellspacing="0" cellpadding="0" height="21">
    <tr>
      <td bgcolor="#CCCCCC" valign="middle">
        <div align="center"><script language=javascript src=buttom.js></script></div>
      </td>
    </tr>
    <tr>
      <td>
        <div align="center"></div>
      </td>
    </tr>
  </table>
</div>
</body>
</html>
