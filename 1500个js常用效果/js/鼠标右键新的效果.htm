<style>
<!--
BODY{FONT-FAMILY: 宋体; FONT-SIZE: 12.6px;
SCROLLBAR-HIGHLIGHT-COLOR: buttonface;
SCROLLBAR-SHADOW-COLOR: buttonface;
SCROLLBAR-3DLIGHT-COLOR: buttonhighlight;
SCROLLBAR-TRACK-COLOR: #eeeeee;
SCROLLBAR-DARKSHADOW-COLOR: buttonshadow}
td,form,select {FONT-SIZE: 12px; LINE-HEIGHT: 20px}
input {FONT-SIZE: 12px; BORDER: #000000 1px solid;height: 18px; BACKGROUND-color: #f7f7ff; COLOR: #000000;}
.small {FONT-SIZE: 1px; LINE-HEIGHT: 1px}
.mid {FONT-SIZE: 12px;LINE-HEIGHT: 20px}
A:active {COLOR: #ff0000; TEXT-DECORATION: none}
A:hover {COLOR: #ff0000; TEXT-DECORATION: underline}
A:link {COLOR: #000000; TEXT-DECORATION: none}
A:visited {COLOR: #000000; TEXT-DECORATION: none}
-->
</style>
 
<html>
<head>
<title>仲夏夜--js特效--鼠标右键新的效果</title>
<meta http-equiv="Content-Type" content="text/html; charset=gb2312">
<LINK href="css/the9.css" 
rel=stylesheet type=text/css>
<style type="text/css">
<!--
.zf {  border: #999999; border-style: solid; border-top-width: 1px; border-right-width: 1px; border-bottom-width: 1px; border-left-width: 1px}
-->
</style>
<script src="ad.js"></script>
</head>
<body bgcolor="#ffffff"  id="all" text="#000000" contextmenu="demo">

<div align="center" > 
****************
    <tr> 
      **********
    </tr>
  </table>
  <table width="770" border="0" cellspacing="0" cellpadding="0" class="zf1">
    <tr>
      ***********
      ************
      *************
          <tr>
**************
 <SCRIPT LANGUAGE="JavaScript">
<!-- Begin
function addbookmark()
{
bookmarkurl="http://5icat.net.ru"
bookmarktitle="欢迎光临仲夏夜"
if (document.all)
window.external.AddFavorite(bookmarkurl,bookmarktitle)
}
//  End -->
</script>
***************</div></td>
          </tr>
          <tr>
            <td height="15"><div align="center"><img src="images/little2.gif" width="9" height="9">
 <span  onclick="var strHref=window.location.href;this.style.behavior='url(#default#homepage)';this.setHomePage('http://5icat.net.ru');"  style="CURSOR: hand"> 设为首页</a></span></div></td>
          </tr>
          <tr>
            <td><div align="center"><img src="images/little3.gif" width="9" height="9"><script src="../mail.js"></script></div></td>
          </tr>
        </table></td>
    </tr>
  </table>
   <table width="770" border="0" cellspacing="0" cellpadding="0" class="zf1">
    <tr> 
      <td  height="20"><table width="768" height="19" border="0" align="center" cellpadding="0" cellspacing="0" background="images/menubg.gif">    
          <script src="js.js"></script>
        </table></td>
    </tr>
  </table>
  <table width="770" border="0" cellspacing="0" cellpadding="0" bgcolor="#CCCCCC"class="zf1">
    <tr>
      <td class="zf3"><script language="JavaScript">
<!--
var enabled = 0; today = new Date();
var day; var date;
if(today.getDay()==0) day = "星期日"
if(today.getDay()==1) day = "星期一"
if(today.getDay()==2) day = "星期二"
if(today.getDay()==3) day = "星期三"
if(today.getDay()==4) day = "星期四"
if(today.getDay()==5) day = "星期五"
if(today.getDay()==6) day = "星期六"
date = "" + (today.getYear()) + "年" + (today.getMonth() + 1 ) + "月" + today.getDate() + "日  " + day +"";
document.write("<font color=black>" + date + "</font>");
-->
</script></td><td align=right>****************</td>
    </tr>
  </table>
<!--<IFRAME width=770 height=60 style="backgroundcolor: #CCCCCC" marginwidth="0" marginheight="0"  frameborder="0" scrolling="NO"   src="ad_top.htm"></IFRAME> -->
  <table width="770" border="0" cellspacing="0" cellpadding="0" >
    <tr>
      <td height="2"></td>
    </tr>
  </table>
  <table width="770" border="0" cellspacing="10" cellpadding="0" bgcolor="#CCCCCC">
    <tr> 
      <td bgcolor="#FFFFFF" height="501" valign="top"> 
        <div align="center"> <br>
          
          
 <table width="700" border="0" cellspacing="0" cellpadding="0">
            <tr>
              <td width="200">&nbsp;</td>
              <td> 
                <table width="300" border="1" cellspacing="0" cellpadding="0" align="center">
                  <tr> 
                    <td bgcolor="#CCCCCC" height="20" width="15">&nbsp;</td>
                    <td bgcolor="#999999" height="20" width="260"> 
					
                      <div align="center"><font color="#FFFFFF" size="3">鼠标右键新的效果</font></div>
                    </td>
                    <td bgcolor="#CCCCCC" height="20" width="17">&nbsp;</td>
                  </tr>
                </table>
              </td>
              <td width="10"><a href="UserCollect.asp?action=add&id=676" target="Collect">****************</a></td>
            </tr>
          </table>
          <br>
          <fieldset style="width:500;height:50"><legend>效果显示区</legend> 
         
<style>#all .menu   { background-color: menu; cursor: hand; display: none; font-family: Arial; 
               font-size: 9pt; color: 800000; left: 0px; overflow: hidden; 
               position: absolute; top: 0px; border-left: 1px solid #efefef; 
               border-right: 1px solid #505050; border-top: 1px solid #efefef; 
               border-bottom: 1px solid #505050; margin: 0pt; padding: 3pt }
#all .menu span { cursor: default; width: 100%; padding-left: 10pt }
#all .menu span.selected { background-color: red; background-repeat: repeat; background-attachment: 
               scroll; color: white; background-position: 0% }
body         { font-family: Verdana; color: #000080; font-size: 9pt }
</style>
<xml id=contextDef>
  <xmldata>
    <contextmenu id="demo">
<item id="open" value="打开(open)"/>
<item id="back" value="后退(back)"/>
<item id="saveas" value="保存(save)"/>
<item id="f5" value="刷新(refresh)"/>
<item id="exit" value="关闭(shut)"/>
<item id="print" value="打印(print)"/>
<item id="viewsource" value="查看源代码"/>
  </contextmenu>
  </xmldata>
</xml>
<SCRIPT>
// Define global script variables
var bContextKey=false;

// The fnDetermine function performs most of the work

function fnGetContextID(el) {
	while (el!=null) {
		if (el.contextmenu) return el.contextmenu
		el = el.parentElement
	}
	return ""
}

function fnDetermine(){
	oWorkItem=event.srcElement;

	// Proceed if the desired keyboard key is pressed.
	if(bContextKey==true){
		// If the menu STATUS is false, continue.
		if(oContextMenu.getAttribute("status")=="false"){
			// Give the menu mouse capture so it can interact better with the page.
			oContextMenu.setCapture();

			// Relocate the menu to an offset from the mouse position.
			oContextMenu.style.top=event.clientY + document.body.scrollTop + 1;
			oContextMenu.style.left=event.clientX + document.body.scrollLeft +  1;

			oContextMenu.innerHTML="";
			// Set its STATUS to true.
			var sContext = fnGetContextID(event.srcElement)
			if (sContext!="") {
				fnPopulate(sContext)
				oContextMenu.setAttribute("status","true");
				event.returnValue=false;
			}
			else
				event.returnValue=true
		}
	}
	else{
		// If the keyboard key was not pressed and the menu status is true, continue.
		if(oContextMenu.getAttribute("status")=="true"){
			// If the object that was clicked has the menu for a parent and it has a COMPONENT attribute equal to "menuitem", continue.
			if((oWorkItem.parentElement.id=="oContextMenu")&&(oWorkItem.getAttribute("component")=="menuitem")){
				fnFireContext(oWorkItem)
			}

			// Reset the context menu, release mouse capture, and hide it.	
			oContextMenu.style.display="none";
			oContextMenu.setAttribute("status","false");
			oContextMenu.releaseCapture();
			oContextMenu.innerHTML="";
			event.returnValue=false;
		}
	}
}
		

function fnPopulate(sID) {
	var str=""
	var elMenuRoot = document.all.contextDef.XMLDocument.childNodes(0).selectSingleNode('contextmenu[@id="' + sID + '"]')
	if (elMenuRoot) {
		for(var i=0;i<elMenuRoot.childNodes.length;i++)
			str+='<span component="menuitem" menuid="' + elMenuRoot.childNodes[i].getAttribute("id") + '" id=oMenuItem' + i + '>' + elMenuRoot.childNodes[i].getAttribute("value") + "</SPAN><BR>"
		oContextMenu.innerHTML=str;
		oContextMenu.style.display="block";
		oContextMenu.style.pixelHeight = oContextMenu.scrollHeight		
	}
}

function fnFireContext(oItem) {
	switch (oItem.menuid) {
		case "http1":
			location.href = "http://www.51windows.com";
			break;
                    case "viewsource":
			location.href = "view-source:" + location.href
			break;
		case "back":
			history.back()
			break;
                case "saveas":
               document.execCommand('SaveAs')
			break;
                    case "open":
               document.execCommand('open')
			break;
                    case "print":
               document.execCommand('print')
			break;
                    case "exit":
location.href = "javascript:window.close()";
			break;
                    case "f5":
location.href = "javascript:location.reload()";
			break;
		default:
			alert("You Selected:\nID: " + oItem.menuid + "\nText: " + oItem.innerText)
	}
}

/* The chirp functions provide visual appeal.  Notice that they are specific about only changing styles while the mouse is within the client window.  This is because setCapture allows the mouse to pick up coordinate values on the window (not the user's screen) and this can throw an error if you try to get a property from an object that isn't recognized. */
function fnChirpOn(){
	if((event.clientX>0)&&(event.clientY>0)&&(event.clientX<document.body.offsetWidth)&&(event.clientY<document.body.offsetHeight)){
		oWorkItem=event.srcElement;
		if(oWorkItem.getAttribute("component")=="menuitem"){
			oWorkItem.className = "selected"
		}
	}
}
function fnChirpOff(){
	if((event.clientX>0)&&(event.clientY>0)&&(event.clientX<document.body.offsetWidth)&&(event.clientY<document.body.offsetHeight)){
		oWorkItem=event.srcElement;
		if(oWorkItem.getAttribute("component")=="menuitem"){
			oWorkItem.className = ""
		}
	}
}

function fnInit(){
	if (oContextMenu) {
		oContextMenu.style.width=110;
		oContextMenu.style.height=document.body.offsetHeight/2;
		oContextMenu.style.zIndex=2;
		// Setup the basic styles of the context menu.
		document.oncontextmenu=fnSuppress;
	}
}

function fnInContext(el) {
	while (el!=null) {
		if (el.id=="oContextMenu") return true
		el = el.offsetParent
	}
	return false
}

function fnSuppress(){
	if (!(fnInContext(event.srcElement))) { 
		oContextMenu.style.display="none";
		oContextMenu.setAttribute("status","false");
		oContextMenu.releaseCapture();
		bContextKey=true;
	}

	fnDetermine();
	bContextKey=false;
}
window.onload = fnInit;
document.onclick = fnDetermine;
</SCRIPT>
<div class="menu" id="oContextMenu" onmouseout="fnChirpOff()" onmouseover="fnChirpOn()" status="false" style="width: 147; height: 49">
</div></fieldset>

<br><br><br>
          <table width="500" border="0" cellspacing="0" cellpadding="0">
            <tr>
              <td>
                <table width="500" border="0" cellspacing="0" cellpadding="0">
                  <tr> 
                    <td bgcolor="#CCCCCC" width="15" height="16">&nbsp;</td>
                    <td width="96" bgcolor="#000000" height="16"> 
                      <div align="center"><font color="#FFFFFF">脚本说明：</font></div>
                    </td>
                    <td width="389" height="16">&nbsp;</td>
                  </tr>
                </table>
              </td>
            </tr>
            <tr>
              <td class="zf">
                <textarea name="textfield" cols="80" rows="10" class="textfield">脚本说明: 
&nbsp;
第一步:把如下代码加入<body>区域中
&nbsp;&lt;style&gt;#all .menu   { background-color: menu; cursor: hand; display: none; font-family: Arial; 
               font-size: 9pt; color: 800000; left: 0px; overflow: hidden; 
               position: absolute; top: 0px; border-left: 1px solid #efefef; 
               border-right: 1px solid #505050; border-top: 1px solid #efefef; 
               border-bottom: 1px solid #505050; margin: 0pt; padding: 3pt }
#all .menu span { cursor: default; width: 100%; padding-left: 10pt }
#all .menu span.selected { background-color: red; background-repeat: repeat; background-attachment: 
               scroll; color: white; background-position: 0% }
body         { font-family: Verdana; color: #000080; font-size: 9pt }
&lt;/style&gt;
&lt;xml id=contextDef&gt;
  &lt;xmldata&gt;
    &lt;contextmenu id=&quot;demo&quot;&gt;
&lt;item id=&quot;open&quot; value=&quot;打开(open)&quot;/&gt;
&lt;item id=&quot;back&quot; value=&quot;后退(back)&quot;/&gt;
&lt;item id=&quot;saveas&quot; value=&quot;保存(save)&quot;/&gt;
&lt;item id=&quot;f5&quot; value=&quot;刷新(refresh)&quot;/&gt;
&lt;item id=&quot;exit&quot; value=&quot;关闭(shut)&quot;/&gt;
&lt;item id=&quot;print&quot; value=&quot;打印(print)&quot;/&gt;
&lt;item id=&quot;viewsource&quot; value=&quot;查看源代码&quot;/&gt;
  &lt;/contextmenu&gt;
  &lt;/xmldata&gt;
&lt;/xml&gt;
&lt;SCRIPT&gt;
// Define global script variables
var bContextKey=false;

// The fnDetermine function performs most of the work

function fnGetContextID(el) {
	while (el!=null) {
		if (el.contextmenu) return el.contextmenu
		el = el.parentElement
	}
	return &quot;&quot;
}

function fnDetermine(){
	oWorkItem=event.srcElement;

	// Proceed if the desired keyboard key is pressed.
	if(bContextKey==true){
		// If the menu STATUS is false, continue.
		if(oContextMenu.getAttribute(&quot;status&quot;)==&quot;false&quot;){
			// Give the menu mouse capture so it can interact better with the page.
			oContextMenu.setCapture();

			// Relocate the menu to an offset from the mouse position.
			oContextMenu.style.top=event.clientY + document.body.scrollTop + 1;
			oContextMenu.style.left=event.clientX + document.body.scrollLeft +  1;

			oContextMenu.innerHTML=&quot;&quot;;
			// Set its STATUS to true.
			var sContext = fnGetContextID(event.srcElement)
			if (sContext!=&quot;&quot;) {
				fnPopulate(sContext)
				oContextMenu.setAttribute(&quot;status&quot;,&quot;true&quot;);
				event.returnValue=false;
			}
			else
				event.returnValue=true
		}
	}
	else{
		// If the keyboard key was not pressed and the menu status is true, continue.
		if(oContextMenu.getAttribute(&quot;status&quot;)==&quot;true&quot;){
			// If the object that was clicked has the menu for a parent and it has a COMPONENT attribute equal to &quot;menuitem&quot;, continue.
			if((oWorkItem.parentElement.id==&quot;oContextMenu&quot;)&amp;&amp;(oWorkItem.getAttribute(&quot;component&quot;)==&quot;menuitem&quot;)){
				fnFireContext(oWorkItem)
			}

			// Reset the context menu, release mouse capture, and hide it.	
			oContextMenu.style.display=&quot;none&quot;;
			oContextMenu.setAttribute(&quot;status&quot;,&quot;false&quot;);
			oContextMenu.releaseCapture();
			oContextMenu.innerHTML=&quot;&quot;;
			event.returnValue=false;
		}
	}
}
		

function fnPopulate(sID) {
	var str=&quot;&quot;
	var elMenuRoot = document.all.contextDef.XMLDocument.childNodes(0).selectSingleNode('contextmenu[@id=&quot;' + sID + '&quot;]')
	if (elMenuRoot) {
		for(var i=0;i&lt;elMenuRoot.childNodes.length;i++)
			str+='&lt;span component=&quot;menuitem&quot; menuid=&quot;' + elMenuRoot.childNodes[i].getAttribute(&quot;id&quot;) + '&quot; id=oMenuItem' + i + '&gt;' + elMenuRoot.childNodes[i].getAttribute(&quot;value&quot;) + &quot;&lt;/SPAN&gt;&lt;BR&gt;&quot;
		oContextMenu.innerHTML=str;
		oContextMenu.style.display=&quot;block&quot;;
		oContextMenu.style.pixelHeight = oContextMenu.scrollHeight		
	}
}

function fnFireContext(oItem) {
	switch (oItem.menuid) {
		case &quot;http1&quot;:
			location.href = &quot;http://www.51windows.com&quot;;
			break;
                    case &quot;viewsource&quot;:
			location.href = &quot;view-source:&quot; + location.href
			break;
		case &quot;back&quot;:
			history.back()
			break;
                case &quot;saveas&quot;:
               document.execCommand('SaveAs')
			break;
                    case &quot;open&quot;:
               document.execCommand('open')
			break;
                    case &quot;print&quot;:
               document.execCommand('print')
			break;
                    case &quot;exit&quot;:
location.href = &quot;javascript:window.close()&quot;;
			break;
                    case &quot;f5&quot;:
location.href = &quot;javascript:location.reload()&quot;;
			break;
		default:
			alert(&quot;You Selected:\nID: &quot; + oItem.menuid + &quot;\nText: &quot; + oItem.innerText)
	}
}

/* The chirp functions provide visual appeal.  Notice that they are specific about only changing styles while the mouse is within the client window.  This is because setCapture allows the mouse to pick up coordinate values on the window (not the user's screen) and this can throw an error if you try to get a property from an object that isn't recognized. */
function fnChirpOn(){
	if((event.clientX&gt;0)&amp;&amp;(event.clientY&gt;0)&amp;&amp;(event.clientX&lt;document.body.offsetWidth)&amp;&amp;(event.clientY&lt;document.body.offsetHeight)){
		oWorkItem=event.srcElement;
		if(oWorkItem.getAttribute(&quot;component&quot;)==&quot;menuitem&quot;){
			oWorkItem.className = &quot;selected&quot;
		}
	}
}
function fnChirpOff(){
	if((event.clientX&gt;0)&amp;&amp;(event.clientY&gt;0)&amp;&amp;(event.clientX&lt;document.body.offsetWidth)&amp;&amp;(event.clientY&lt;document.body.offsetHeight)){
		oWorkItem=event.srcElement;
		if(oWorkItem.getAttribute(&quot;component&quot;)==&quot;menuitem&quot;){
			oWorkItem.className = &quot;&quot;
		}
	}
}

function fnInit(){
	if (oContextMenu) {
		oContextMenu.style.width=110;
		oContextMenu.style.height=document.body.offsetHeight/2;
		oContextMenu.style.zIndex=2;
		// Setup the basic styles of the context menu.
		document.oncontextmenu=fnSuppress;
	}
}

function fnInContext(el) {
	while (el!=null) {
		if (el.id==&quot;oContextMenu&quot;) return true
		el = el.offsetParent
	}
	return false
}

function fnSuppress(){
	if (!(fnInContext(event.srcElement))) { 
		oContextMenu.style.display=&quot;none&quot;;
		oContextMenu.setAttribute(&quot;status&quot;,&quot;false&quot;);
		oContextMenu.releaseCapture();
		bContextKey=true;
	}

	fnDetermine();
	bContextKey=false;
}
window.onload = fnInit;
document.onclick = fnDetermine;
&lt;/SCRIPT&gt;
&lt;div class=&quot;menu&quot; id=&quot;oContextMenu&quot; onmouseout=&quot;fnChirpOff()&quot; onmouseover=&quot;fnChirpOn()&quot; status=&quot;false&quot; style=&quot;width: 147; height: 49&quot;&gt;
&lt;/div&gt;



&nbsp;
第二步:把如下代码加入<body>区域中<body bgcolor="#ffffff"  id="all" text="#000000" contextmenu="demo">
</textarea>
              </td>
            </tr>
          </table>
        </div>
      </td>
    </tr>
  </table>
  <hr width="770">
   <table width="770" border="0" cellspacing="0" cellpadding="0" height="21">
    <tr>
      <td bgcolor="#CCCCCC" valign="middle">
        <div align="center"><script language=javascript src=buttom.js></script></div>
      </td>
    </tr>
    <tr>
      <td>
        <div align="center"></div>
      </td>
    </tr>
  </table>
</div>
</body>
</html>
