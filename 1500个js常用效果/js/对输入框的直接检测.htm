<style>
<!--
BODY{FONT-FAMILY: 宋体; FONT-SIZE: 12.6px;
SCROLLBAR-HIGHLIGHT-COLOR: buttonface;
SCROLLBAR-SHADOW-COLOR: buttonface;
SCROLLBAR-3DLIGHT-COLOR: buttonhighlight;
SCROLLBAR-TRACK-COLOR: #eeeeee;
SCROLLBAR-DARKSHADOW-COLOR: buttonshadow}
td,form,select {FONT-SIZE: 12px; LINE-HEIGHT: 20px}
input {FONT-SIZE: 12px; BORDER: #000000 1px solid;height: 18px; BACKGROUND-color: #f7f7ff; COLOR: #000000;}
.small {FONT-SIZE: 1px; LINE-HEIGHT: 1px}
.mid {FONT-SIZE: 12px;LINE-HEIGHT: 20px}
A:active {COLOR: #ff0000; TEXT-DECORATION: none}
A:hover {COLOR: #ff0000; TEXT-DECORATION: underline}
A:link {COLOR: #000000; TEXT-DECORATION: none}
A:visited {COLOR: #000000; TEXT-DECORATION: none}
-->
</style>
 
<html>
<head>
<title>仲夏夜--js特效--对输入框的直接检测</title>
<meta http-equiv="Content-Type" content="text/html; charset=gb2312">
<LINK href="css/the9.css" 
rel=stylesheet type=text/css>
<style type="text/css">
<!--
.zf {  border: #999999; border-style: solid; border-top-width: 1px; border-right-width: 1px; border-bottom-width: 1px; border-left-width: 1px}
-->
</style>
<script src="ad.js"></script>
</head>
<body bgcolor=#FFFFFF>

<div align="center" > 
****************
    <tr> 
      **********
    </tr>
  </table>
  <table width="770" border="0" cellspacing="0" cellpadding="0" class="zf1">
    <tr>
      ***********
      ************
      *************
          <tr>
**************
 <SCRIPT LANGUAGE="JavaScript">
<!-- Begin
function addbookmark()
{
bookmarkurl="http://5icat.net.ru"
bookmarktitle="欢迎光临仲夏夜"
if (document.all)
window.external.AddFavorite(bookmarkurl,bookmarktitle)
}
//  End -->
</script>
***************</div></td>
          </tr>
          <tr>
            <td height="15"><div align="center"><img src="images/little2.gif" width="9" height="9">
 <span  onclick="var strHref=window.location.href;this.style.behavior='url(#default#homepage)';this.setHomePage('http://5icat.net.ru');"  style="CURSOR: hand"> 设为首页</a></span></div></td>
          </tr>
          <tr>
            <td><div align="center"><img src="images/little3.gif" width="9" height="9"><script src="../mail.js"></script></div></td>
          </tr>
        </table></td>
    </tr>
  </table>
   <table width="770" border="0" cellspacing="0" cellpadding="0" class="zf1">
    <tr> 
      <td  height="20"><table width="768" height="19" border="0" align="center" cellpadding="0" cellspacing="0" background="images/menubg.gif">    
          <script src="js.js"></script>
        </table></td>
    </tr>
  </table>
  <table width="770" border="0" cellspacing="0" cellpadding="0" bgcolor="#CCCCCC"class="zf1">
    <tr>
      <td class="zf3"><script language="JavaScript">
<!--
var enabled = 0; today = new Date();
var day; var date;
if(today.getDay()==0) day = "星期日"
if(today.getDay()==1) day = "星期一"
if(today.getDay()==2) day = "星期二"
if(today.getDay()==3) day = "星期三"
if(today.getDay()==4) day = "星期四"
if(today.getDay()==5) day = "星期五"
if(today.getDay()==6) day = "星期六"
date = "" + (today.getYear()) + "年" + (today.getMonth() + 1 ) + "月" + today.getDate() + "日  " + day +"";
document.write("<font color=black>" + date + "</font>");
-->
</script></td><td align=right>****************</td>
    </tr>
  </table>
<!--<IFRAME width=770 height=60 style="backgroundcolor: #CCCCCC" marginwidth="0" marginheight="0"  frameborder="0" scrolling="NO"   src="ad_top.htm"></IFRAME> -->
  <table width="770" border="0" cellspacing="0" cellpadding="0" >
    <tr>
      <td height="2"></td>
    </tr>
  </table>
  <table width="770" border="0" cellspacing="10" cellpadding="0" bgcolor="#CCCCCC">
    <tr> 
      <td bgcolor="#FFFFFF" height="501" valign="top"> 
        <div align="center"> <br>
          
          
 <table width="700" border="0" cellspacing="0" cellpadding="0">
            <tr>
              <td width="200">&nbsp;</td>
              <td> 
                <table width="300" border="1" cellspacing="0" cellpadding="0" align="center">
                  <tr> 
                    <td bgcolor="#CCCCCC" height="20" width="15">&nbsp;</td>
                    <td bgcolor="#999999" height="20" width="260"> 
					
                      <div align="center"><font color="#FFFFFF" size="3">对输入框的直接检测</font></div>
                    </td>
                    <td bgcolor="#CCCCCC" height="20" width="17">&nbsp;</td>
                  </tr>
                </table>
              </td>
              <td width="10"><a href="UserCollect.asp?action=add&id=1199" target="Collect">****************</a></td>
            </tr>
          </table>
          <br>
          <fieldset style="width:500;height:50"><legend>效果显示区</legend> 
         
<script language="JavaScript">
<!--
function MM_findObj(n, d) { //v4.01
  var p,i,x;  if(!d) d=document; if((p=n.indexOf("?"))>0&&parent.frames.length) {
    d=parent.frames[n.substring(p+1)].document; n=n.substring(0,p);}
  if(!(x=d[n])&&d.all) x=d.all[n]; for (i=0;!x&&i<d.forms.length;i++) x=d.forms[i][n];
  for(i=0;!x&&d.layers&&i<d.layers.length;i++) x=MM_findObj(n,d.layers[i].document);
  if(!x && d.getElementById) x=d.getElementById(n); return x;
}

function MM_validateForm() { //v4.0
  var i,p,q,nm,test,num,min,max,errors='',args=MM_validateForm.arguments;
  for (i=0; i<(args.length-2); i+=3) { test=args[i+2]; val=MM_findObj(args[i]);
    if (val) { nm=val.name; if ((val=val.value)!="") {
      if (test.indexOf('isEmail')!=-1) { p=val.indexOf('@');
        if (p<1 || p==(val.length-1)) errors+='请填写一个有效的E-mail地址！\n';
      } else if (test!='R') {
        if (isNaN(val)) errors+='OICQ号码必须是数字！\n';
        if (test.indexOf('inRange') != -1) { p=test.indexOf(':');
          min=test.substring(8,p); max=test.substring(p+1);
          if (val<min || max<val) errors+='- '+nm+' must contain a number between '+min+' and '+max+'.\n';
    } } } else if (test.charAt(0) == 'R') errors += '红色 * 星号处不能为空！\n'; }
  } if (errors) alert('填写有误:\n\n'+errors);
  document.MM_returnValue = (errors == '');
}
//-->
</script>
  <div align="center"> 
  <form name="form1" method="POST" action="gb_add.asp">
    <table width="450" border="0" cellspacing="0" cellpadding="0">
      <tr> 
        <td bgcolor="#999966" valign="top"> 
          <table width="471" border="0" cellspacing="1" cellpadding="3" bordercolordark="#FFFFFF" bordercolorlight="#CCCCCC" class="tx9pt" align="center">
            <tr> 
              <td width="123" bgcolor="#f7f7f7"> 
                <div align="left">姓名：</div>
              </td>
              <td width="331" bgcolor="#f7f7f7"> 
                <input type="text" class="txtfield" name="gb_name" size="20" maxlength="30">
                &nbsp;&nbsp;性别： 
                <select class="txtfield" name="gb_sex">
                  <option value="先生" selected>先生</option>
                  <option value="女士">女士</option>
                  <option value="保密">保密</option>
                </select>
                <b><font color="#FFFFFF"> 
                <input type="hidden" name="gb_addtime" value="2001-11-27 16:53:39">
                <input type="hidden" name="gb_ip" value="210.51.216.29">
                </font></b> </td>
            </tr>
            <tr> 
              <td width="123" height="2" bgcolor="#f7f7f7"> 
                <div align="left">来自：</div>
              </td>
              <td width="331" bgcolor="#f7f7f7"> 
                <input type="text" class="txtfield" name="gb_address" size="20" maxlength="30">
              </td>
            </tr>
            <tr> 
              <td width="123" height="12" bgcolor="#f7f7f7"> 
                <div align="left"><b><font color="#CC0000">*</font></b> OICQ</div>
              </td>
              <td width="331" bgcolor="#f7f7f7"> 
                <input type="text" class="txtfield" name="gb_oicq" size="20" maxlength="20" onChange="MM_validateForm('gb_oicq','','NisNum');return document.MM_returnValue">
                这里会进行检测 </td>
            </tr>
            <tr> 
              <td width="123" height="12" bgcolor="#f7f7f7"> 
                <div align="left"><b><font color="#CC0000">*</font></b> 电子邮件</div>
              </td>
              <td width="331" bgcolor="#f7f7f7" height="12"> 
                <input type="text" class="txtfield" name="gb_email" size="25" maxlength="30" onChange="MM_validateForm('gb_email','','NisEmail');return document.MM_returnValue">
                这里会进行检测 </td>
            </tr>
            <tr> 
              <td width="123" bgcolor="#f7f7f7"> 
                <div align="left">主页地址：</div>
              </td>
              <td width="331" bgcolor="#f7f7f7"> 
                <input type="text" class="txtfield" name="gb_homepage" size="50" maxlength="100">
              </td>
            </tr>
            <tr> 
              <td width="123" bgcolor="#f7f7f7"> 
                <div align="left">主题：</div>
              </td>
              <td width="331" bgcolor="#f7f7f7"> 
                <input type="text" class="txtfield" name="gb_title" size="50" maxlength="100">
              </td>
            </tr>
            <tr> 
              <td width="123" bgcolor="#f7f7f7"> 
                <div align="left">留言：</div>
              </td>
              <td width="331" bgcolor="#f7f7f7"> 
                <textarea class="txtfield" name="gb_content" cols="40" rows="8" wrap="VIRTUAL"></textarea>
              </td>
            </tr>
          </table>
        </td>
      </tr>
    </table>
    <div align="center"> 
      <table width="450" border="0" cellspacing="2" cellpadding="0" class="tx9pt">
        <tr> 
          <td>
            <div align="right">注意：带 <font color="#CC0000"><b>*</b></font> 为必填项！</div>
          </td>
        </tr>
      </table>
      <br>
      <table width="450" border="0" cellspacing="0" cellpadding="0">
        <tr> 
          <td width="198"> 
            <div align="right"> 
              <input type="submit" value="提::交" name="Submit1" style="font-family:宋体; font-size:9pt; color:#ffffff; background-color:#999900; border-width:1pt; border-color:black; border-style:solid; CURSOR: hand" onClick="MM_validateForm('gb_name','','R');MM_validateForm('gb_title','','R');MM_validateForm('gb_content','','R');return document.MM_returnValue" >
            </div>
          </td>
          <td width="34">&nbsp; </td>
          <td width="218"> 
            <input type="reset"  value="重::写" name="Submit2" style="font-family:宋体; font-size:9pt; color:#ffffff; background-color:#999900; border-width:1pt; border-color:black; border-style:solid; CURSOR: hand" >
            <input type="hidden" name="MM_insert" value="true">
          </td>
        </tr>
      </table>
      <br>
    </div>
  </form>
</div></fieldset>

<br><br><br>
          <table width="500" border="0" cellspacing="0" cellpadding="0">
            <tr>
              <td>
                <table width="500" border="0" cellspacing="0" cellpadding="0">
                  <tr> 
                    <td bgcolor="#CCCCCC" width="15" height="16">&nbsp;</td>
                    <td width="96" bgcolor="#000000" height="16"> 
                      <div align="center"><font color="#FFFFFF">脚本说明：</font></div>
                    </td>
                    <td width="389" height="16">&nbsp;</td>
                  </tr>
                </table>
              </td>
            </tr>
            <tr>
              <td class="zf">
                <textarea name="textfield" cols="80" rows="10" class="textfield">脚本说明: 
&nbsp;
把如下代码加入<body>区域中
&nbsp;&lt;script language=&quot;JavaScript&quot;&gt;
&lt;!--
function MM_findObj(n, d) { //v4.01
  var p,i,x;  if(!d) d=document; if((p=n.indexOf(&quot;?&quot;))&gt;0&amp;&amp;parent.frames.length) {
    d=parent.frames[n.substring(p+1)].document; n=n.substring(0,p);}
  if(!(x=d[n])&amp;&amp;d.all) x=d.all[n]; for (i=0;!x&amp;&amp;i&lt;d.forms.length;i++) x=d.forms[i][n];
  for(i=0;!x&amp;&amp;d.layers&amp;&amp;i&lt;d.layers.length;i++) x=MM_findObj(n,d.layers[i].document);
  if(!x &amp;&amp; d.getElementById) x=d.getElementById(n); return x;
}

function MM_validateForm() { //v4.0
  var i,p,q,nm,test,num,min,max,errors='',args=MM_validateForm.arguments;
  for (i=0; i&lt;(args.length-2); i+=3) { test=args[i+2]; val=MM_findObj(args[i]);
    if (val) { nm=val.name; if ((val=val.value)!=&quot;&quot;) {
      if (test.indexOf('isEmail')!=-1) { p=val.indexOf('@');
        if (p&lt;1 || p==(val.length-1)) errors+='请填写一个有效的E-mail地址！\n';
      } else if (test!='R') {
        if (isNaN(val)) errors+='OICQ号码必须是数字！\n';
        if (test.indexOf('inRange') != -1) { p=test.indexOf(':');
          min=test.substring(8,p); max=test.substring(p+1);
          if (val&lt;min || max&lt;val) errors+='- '+nm+' must contain a number between '+min+' and '+max+'.\n';
    } } } else if (test.charAt(0) == 'R') errors += '红色 * 星号处不能为空！\n'; }
  } if (errors) alert('填写有误:\n\n'+errors);
  document.MM_returnValue = (errors == '');
}
//--&gt;
&lt;/script&gt;
  &lt;div align=&quot;center&quot;&gt; 
  &lt;form name=&quot;form1&quot; method=&quot;POST&quot; action=&quot;gb_add.asp&quot;&gt;
    &lt;table width=&quot;450&quot; border=&quot;0&quot; cellspacing=&quot;0&quot; cellpadding=&quot;0&quot;&gt;
      &lt;tr&gt; 
        &lt;td bgcolor=&quot;#999966&quot; valign=&quot;top&quot;&gt; 
          &lt;table width=&quot;471&quot; border=&quot;0&quot; cellspacing=&quot;1&quot; cellpadding=&quot;3&quot; bordercolordark=&quot;#FFFFFF&quot; bordercolorlight=&quot;#CCCCCC&quot; class=&quot;tx9pt&quot; align=&quot;center&quot;&gt;
            &lt;tr&gt; 
              &lt;td width=&quot;123&quot; bgcolor=&quot;#f7f7f7&quot;&gt; 
                &lt;div align=&quot;left&quot;&gt;姓名：&lt;/div&gt;
              &lt;/td&gt;
              &lt;td width=&quot;331&quot; bgcolor=&quot;#f7f7f7&quot;&gt; 
                &lt;input type=&quot;text&quot; class=&quot;txtfield&quot; name=&quot;gb_name&quot; size=&quot;20&quot; maxlength=&quot;30&quot;&gt;
                &amp;nbsp;&amp;nbsp;性别： 
                &lt;select class=&quot;txtfield&quot; name=&quot;gb_sex&quot;&gt;
                  &lt;option value=&quot;先生&quot; selected&gt;先生&lt;/option&gt;
                  &lt;option value=&quot;女士&quot;&gt;女士&lt;/option&gt;
                  &lt;option value=&quot;保密&quot;&gt;保密&lt;/option&gt;
                &lt;/select&gt;
                &lt;b&gt;&lt;font color=&quot;#FFFFFF&quot;&gt; 
                &lt;input type=&quot;hidden&quot; name=&quot;gb_addtime&quot; value=&quot;2001-11-27 16:53:39&quot;&gt;
                &lt;input type=&quot;hidden&quot; name=&quot;gb_ip&quot; value=&quot;210.51.216.29&quot;&gt;
                &lt;/font&gt;&lt;/b&gt; &lt;/td&gt;
            &lt;/tr&gt;
            &lt;tr&gt; 
              &lt;td width=&quot;123&quot; height=&quot;2&quot; bgcolor=&quot;#f7f7f7&quot;&gt; 
                &lt;div align=&quot;left&quot;&gt;来自：&lt;/div&gt;
              &lt;/td&gt;
              &lt;td width=&quot;331&quot; bgcolor=&quot;#f7f7f7&quot;&gt; 
                &lt;input type=&quot;text&quot; class=&quot;txtfield&quot; name=&quot;gb_address&quot; size=&quot;20&quot; maxlength=&quot;30&quot;&gt;
              &lt;/td&gt;
            &lt;/tr&gt;
            &lt;tr&gt; 
              &lt;td width=&quot;123&quot; height=&quot;12&quot; bgcolor=&quot;#f7f7f7&quot;&gt; 
                &lt;div align=&quot;left&quot;&gt;&lt;b&gt;&lt;font color=&quot;#CC0000&quot;&gt;*&lt;/font&gt;&lt;/b&gt; OICQ&lt;/div&gt;
              &lt;/td&gt;
              &lt;td width=&quot;331&quot; bgcolor=&quot;#f7f7f7&quot;&gt; 
                &lt;input type=&quot;text&quot; class=&quot;txtfield&quot; name=&quot;gb_oicq&quot; size=&quot;20&quot; maxlength=&quot;20&quot; onChange=&quot;MM_validateForm('gb_oicq','','NisNum');return document.MM_returnValue&quot;&gt;
                这里会进行检测 &lt;/td&gt;
            &lt;/tr&gt;
            &lt;tr&gt; 
              &lt;td width=&quot;123&quot; height=&quot;12&quot; bgcolor=&quot;#f7f7f7&quot;&gt; 
                &lt;div align=&quot;left&quot;&gt;&lt;b&gt;&lt;font color=&quot;#CC0000&quot;&gt;*&lt;/font&gt;&lt;/b&gt; 电子邮件&lt;/div&gt;
              &lt;/td&gt;
              &lt;td width=&quot;331&quot; bgcolor=&quot;#f7f7f7&quot; height=&quot;12&quot;&gt; 
                &lt;input type=&quot;text&quot; class=&quot;txtfield&quot; name=&quot;gb_email&quot; size=&quot;25&quot; maxlength=&quot;30&quot; onChange=&quot;MM_validateForm('gb_email','','NisEmail');return document.MM_returnValue&quot;&gt;
                这里会进行检测 &lt;/td&gt;
            &lt;/tr&gt;
            &lt;tr&gt; 
              &lt;td width=&quot;123&quot; bgcolor=&quot;#f7f7f7&quot;&gt; 
                &lt;div align=&quot;left&quot;&gt;主页地址：&lt;/div&gt;
              &lt;/td&gt;
              &lt;td width=&quot;331&quot; bgcolor=&quot;#f7f7f7&quot;&gt; 
                &lt;input type=&quot;text&quot; class=&quot;txtfield&quot; name=&quot;gb_homepage&quot; size=&quot;50&quot; maxlength=&quot;100&quot;&gt;
              &lt;/td&gt;
            &lt;/tr&gt;
            &lt;tr&gt; 
              &lt;td width=&quot;123&quot; bgcolor=&quot;#f7f7f7&quot;&gt; 
                &lt;div align=&quot;left&quot;&gt;主题：&lt;/div&gt;
              &lt;/td&gt;
              &lt;td width=&quot;331&quot; bgcolor=&quot;#f7f7f7&quot;&gt; 
                &lt;input type=&quot;text&quot; class=&quot;txtfield&quot; name=&quot;gb_title&quot; size=&quot;50&quot; maxlength=&quot;100&quot;&gt;
              &lt;/td&gt;
            &lt;/tr&gt;
            &lt;tr&gt; 
              &lt;td width=&quot;123&quot; bgcolor=&quot;#f7f7f7&quot;&gt; 
                &lt;div align=&quot;left&quot;&gt;留言：&lt;/div&gt;
              &lt;/td&gt;
              &lt;td width=&quot;331&quot; bgcolor=&quot;#f7f7f7&quot;&gt; 
                &lt;textarea class=&quot;txtfield&quot; name=&quot;gb_content&quot; cols=&quot;40&quot; rows=&quot;8&quot; wrap=&quot;VIRTUAL&quot;&gt;&lt;/textarea&gt;
              &lt;/td&gt;
            &lt;/tr&gt;
          &lt;/table&gt;
        &lt;/td&gt;
      &lt;/tr&gt;
    &lt;/table&gt;
    &lt;div align=&quot;center&quot;&gt; 
      &lt;table width=&quot;450&quot; border=&quot;0&quot; cellspacing=&quot;2&quot; cellpadding=&quot;0&quot; class=&quot;tx9pt&quot;&gt;
        &lt;tr&gt; 
          &lt;td&gt;
            &lt;div align=&quot;right&quot;&gt;注意：带 &lt;font color=&quot;#CC0000&quot;&gt;&lt;b&gt;*&lt;/b&gt;&lt;/font&gt; 为必填项！&lt;/div&gt;
          &lt;/td&gt;
        &lt;/tr&gt;
      &lt;/table&gt;
      &lt;br&gt;
      &lt;table width=&quot;450&quot; border=&quot;0&quot; cellspacing=&quot;0&quot; cellpadding=&quot;0&quot;&gt;
        &lt;tr&gt; 
          &lt;td width=&quot;198&quot;&gt; 
            &lt;div align=&quot;right&quot;&gt; 
              &lt;input type=&quot;submit&quot; value=&quot;提::交&quot; name=&quot;Submit1&quot; style=&quot;font-family:宋体; font-size:9pt; color:#ffffff; background-color:#999900; border-width:1pt; border-color:black; border-style:solid; CURSOR: hand&quot; onClick=&quot;MM_validateForm('gb_name','','R');MM_validateForm('gb_title','','R');MM_validateForm('gb_content','','R');return document.MM_returnValue&quot; &gt;
            &lt;/div&gt;
          &lt;/td&gt;
          &lt;td width=&quot;34&quot;&gt;&amp;nbsp; &lt;/td&gt;
          &lt;td width=&quot;218&quot;&gt; 
            &lt;input type=&quot;reset&quot;  value=&quot;重::写&quot; name=&quot;Submit2&quot; style=&quot;font-family:宋体; font-size:9pt; color:#ffffff; background-color:#999900; border-width:1pt; border-color:black; border-style:solid; CURSOR: hand&quot; &gt;
            &lt;input type=&quot;hidden&quot; name=&quot;MM_insert&quot; value=&quot;true&quot;&gt;
          &lt;/td&gt;
        &lt;/tr&gt;
      &lt;/table&gt;
      &lt;br&gt;
    &lt;/div&gt;
  &lt;/form&gt;
&lt;/div&gt;



&nbsp;

</textarea>
              </td>
            </tr>
          </table>
        </div>
      </td>
    </tr>
  </table>
  <hr width="770">
   <table width="770" border="0" cellspacing="0" cellpadding="0" height="21">
    <tr>
      <td bgcolor="#CCCCCC" valign="middle">
        <div align="center"><script language=javascript src=buttom.js></script></div>
      </td>
    </tr>
    <tr>
      <td>
        <div align="center"></div>
      </td>
    </tr>
  </table>
</div>
</body>
</html>
