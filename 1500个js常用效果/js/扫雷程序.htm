<style>
<!--
BODY{FONT-FAMILY: 宋体; FONT-SIZE: 12.6px;
SCROLLBAR-HIGHLIGHT-COLOR: buttonface;
SCROLLBAR-SHADOW-COLOR: buttonface;
SCROLLBAR-3DLIGHT-COLOR: buttonhighlight;
SCROLLBAR-TRACK-COLOR: #eeeeee;
SCROLLBAR-DARKSHADOW-COLOR: buttonshadow}
td,form,select {FONT-SIZE: 12px; LINE-HEIGHT: 20px}
input {FONT-SIZE: 12px; BORDER: #000000 1px solid;height: 18px; BACKGROUND-color: #f7f7ff; COLOR: #000000;}
.small {FONT-SIZE: 1px; LINE-HEIGHT: 1px}
.mid {FONT-SIZE: 12px;LINE-HEIGHT: 20px}
A:active {COLOR: #ff0000; TEXT-DECORATION: none}
A:hover {COLOR: #ff0000; TEXT-DECORATION: underline}
A:link {COLOR: #000000; TEXT-DECORATION: none}
A:visited {COLOR: #000000; TEXT-DECORATION: none}
-->
</style>
 
<html>
<head>
<title>仲夏夜--js特效--扫雷程序</title>
<meta http-equiv="Content-Type" content="text/html; charset=gb2312">
<LINK href="css/the9.css" 
rel=stylesheet type=text/css>
<style type="text/css">
<!--
.zf {  border: #999999; border-style: solid; border-top-width: 1px; border-right-width: 1px; border-bottom-width: 1px; border-left-width: 1px}
-->
</style>
<script src="ad.js"></script>
</head>
<body bgcolor=#FFFFFF>

<div align="center" > 
****************
    <tr> 
      **********
    </tr>
  </table>
  <table width="770" border="0" cellspacing="0" cellpadding="0" class="zf1">
    <tr>
      ***********
      ************
      *************
          <tr>
**************
 <SCRIPT LANGUAGE="JavaScript">
<!-- Begin
function addbookmark()
{
bookmarkurl="http://5icat.net.ru"
bookmarktitle="欢迎光临仲夏夜"
if (document.all)
window.external.AddFavorite(bookmarkurl,bookmarktitle)
}
//  End -->
</script>
***************</div></td>
          </tr>
          <tr>
            <td height="15"><div align="center"><img src="images/little2.gif" width="9" height="9">
 <span  onclick="var strHref=window.location.href;this.style.behavior='url(#default#homepage)';this.setHomePage('http://5icat.net.ru');"  style="CURSOR: hand"> 设为首页</a></span></div></td>
          </tr>
          <tr>
            <td><div align="center"><img src="images/little3.gif" width="9" height="9"><script src="../mail.js"></script></div></td>
          </tr>
        </table></td>
    </tr>
  </table>
   <table width="770" border="0" cellspacing="0" cellpadding="0" class="zf1">
    <tr> 
      <td  height="20"><table width="768" height="19" border="0" align="center" cellpadding="0" cellspacing="0" background="images/menubg.gif">    
          <script src="js.js"></script>
        </table></td>
    </tr>
  </table>
  <table width="770" border="0" cellspacing="0" cellpadding="0" bgcolor="#CCCCCC"class="zf1">
    <tr>
      <td class="zf3"><script language="JavaScript">
<!--
var enabled = 0; today = new Date();
var day; var date;
if(today.getDay()==0) day = "星期日"
if(today.getDay()==1) day = "星期一"
if(today.getDay()==2) day = "星期二"
if(today.getDay()==3) day = "星期三"
if(today.getDay()==4) day = "星期四"
if(today.getDay()==5) day = "星期五"
if(today.getDay()==6) day = "星期六"
date = "" + (today.getYear()) + "年" + (today.getMonth() + 1 ) + "月" + today.getDate() + "日  " + day +"";
document.write("<font color=black>" + date + "</font>");
-->
</script></td><td align=right>****************</td>
    </tr>
  </table>
<!--<IFRAME width=770 height=60 style="backgroundcolor: #CCCCCC" marginwidth="0" marginheight="0"  frameborder="0" scrolling="NO"   src="ad_top.htm"></IFRAME> -->
  <table width="770" border="0" cellspacing="0" cellpadding="0" >
    <tr>
      <td height="2"></td>
    </tr>
  </table>
  <table width="770" border="0" cellspacing="10" cellpadding="0" bgcolor="#CCCCCC">
    <tr> 
      <td bgcolor="#FFFFFF" height="501" valign="top"> 
        <div align="center"> <br>
          
          
 <table width="700" border="0" cellspacing="0" cellpadding="0">
            <tr>
              <td width="200">&nbsp;</td>
              <td> 
                <table width="300" border="1" cellspacing="0" cellpadding="0" align="center">
                  <tr> 
                    <td bgcolor="#CCCCCC" height="20" width="15">&nbsp;</td>
                    <td bgcolor="#999999" height="20" width="260"> 
					
                      <div align="center"><font color="#FFFFFF" size="3">扫雷程序</font></div>
                    </td>
                    <td bgcolor="#CCCCCC" height="20" width="17">&nbsp;</td>
                  </tr>
                </table>
              </td>
              <td width="10"><a href="UserCollect.asp?action=add&id=1430" target="Collect">****************</a></td>
            </tr>
          </table>
          <br>
          <fieldset style="width:500;height:50"><legend>效果显示区</legend> 
         
<SCRIPT LANGUAGE="JavaScript">

<!-- Begin
dir = "";
var mines = [];
var shown = [];
var gridx, gridy, maxmines;
gridx = window.prompt("请输入你想要的行数","8");
gridxverify();
function gridxaccept(){
gridy = window.prompt("请输入你想要的列数","8");
gridyverify();
}
function gridyaccept(){
maxmines = window.prompt("请输入你想要的地雷数目","10");
maxminesverify();
}
function gridxverify(){
if (gridx > 50){
alert("你输入的数字不能超过50.");
gridxreenter();
}
else if (gridx < 8){
alert("你输入的数字不能小于8.");
gridxreenter();
}
else gridxaccept();
}

function gridyverify(){
if (gridy > 50){
alert("That height is too big. Please enter a new height.");
gridyreenter();
}
else if (gridy < 8){
alert("That height is too small. Please enter a new height.");
gridyreenter();
}
else gridyaccept();
}
function maxminesverify(){
if (maxmines > 500){
alert("That number is too big. Please enter a new number of mines.");
maxminesreenter();
}
else if (maxmines < 10){
alert("That number is too small. Please enter a new number of mines.");
maxminesreenter();
}
else accepted();
}
// Functions for reentering key variables, if necessary.
function gridxreenter(){
gridx = window.prompt("Please enter a width.","8");
gridxverify();
}
function gridyreenter(){
gridy = window.prompt("Please enter a height.","8");
gridyverify();
}
function maxminesreenter(){
maxmines = window.prompt("Please enter the number of mines you want.","10");
maxminesverify();
}
function accepted(){
var squaresleft, flagsleft;
var elapsedtime;
var playing;
var placeflag;
var clicked;
}
var gridSq = gridx * 16;
var grid8 = gridSq - 128;
var grid16 = gridx - 8
var grid32 = grid16 * 8
var grid64 = grid16 * 16
var topBarWidth = 8 + grid64;
var menuBarWidth = 86 + grid64;
var wideWidth = gridx * 16;
var highHeight = gridy * 16;
var cplLeft = 6 + grid32;
var cplRight = 4 + grid32;
var totalWidth = gridSq + 32;
var tW6 = totalWidth - 6;
var ww2 = wideWidth + 2;
num=new Array(10);
for (var i=0;i<10;i++) {
num[i]=new Image()
num[i].src=i+".gif"
}
function keyDown(e) {
if(document.layers)
placeflag = (e.modifiers & Event.CONTROL_MASK) > 0;
else
placeflag = window.event.ctrlKey;
setStatus();
}
function keyUp(e) {
placeflag = false;
setStatus();
}
function newgame() {
// reset state arrays. mines holds the position of each mine. shown keeps
// track of the image shown at each grid location
var y;
for(y = 0; y < gridy; ++y)
{
mines[y] = [false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false];
shown[y] = [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0];
}
// Place the mines, making sure positions are unique
var m;
for(m = 0; m < maxmines; ++m) {
var x,y;
do {
x = Math.floor(Math.random() * gridx);
y = Math.floor(Math.random() * gridy);
} while(mines[y][x]);
mines[y][x] = true;
}
// initialize game variables
squaresleft = gridy * gridx;
flagsleft = maxmines;
elapsedtime = 0;
playing = true;
clicked = false
placeflag = false;
// insert the grid into the document
buildgrid();
// Set up keypress handlers
if (document.layers)
window.captureEvents(Event.KEYDOWN | Event.KEYUP);
window.onKeyDown = keyDown;
window.onKeyUp = keyUp;
// start the clock
setInterval("ticker()", 1000);
}
// clock tick handler
function ticker() {
if (playing) {
if (clicked) {
elapsedtime++;
setStatus();
   }
  }
}

// Refreshing control panel
function setStatus() {
document.images.elapse3.src=num[elapsedtime-(Math.floor(elapsedtime/10))*10].src;
document.images.elapse2.src=num[Math.floor((elapsedtime-(Math.floor(elapsedtime/100))*100)/10)].src;
document.images.elapse1.src=num[Math.floor(elapsedtime/100)].src;
document.images.flag3.src=num[flagsleft-(Math.floor(flagsleft/10))*10].src;
document.images.flag2.src=num[Math.floor((flagsleft-(Math.floor(flagsleft/100))*100)/10)].src;
document.images.flag1.src=num[Math.floor(flagsleft/100)].src;
}
//function to insert all the IMG tags into the document
function buildgrid() {
document.write("<!-- Window --><DIV align=center> "
 +"<!-- Top Bar --> <table width="
 + totalWidth
 +" border=0 cells"
 +"pacing=0 cellpadding=0> <tr bgcolor=#bbbbbb heigh"
 +"t=1> <td width=1 bgcolor=#bbbbbb></td><td width"
 +"=1 bgcolor=#bbbbbb></td> <td width=1 bgcolor=#bbb"
 +"bbb></td><td width="
 + tW6
 +" bgcolor=#bbbbbb></td> <t"
 +"d width=1 bgcolor=#bbbbbb></td> <td width=1 bgcol"
 +"or=#bbbbbb></td> <td width=1 bgcolor=#000000></td"
 +"></tr><tr height=1><td width=1 bgcolor=#bbbb"
 +"bb></td><td width=1 bgcolor=#ffffff></td><td w"
 +"idth=1 bgcolor=#ffffff></td><td bgcolor=#ffffff>"
 +"</td><td width=1 bgcolor=#ffffff></td><td widt"
 +"h=1 bgcolor=#888888></td><td width=1 bgcolor=#00"
 +"0000></td></tr><tr height=1><td width=1 bgco"
 +"lor=#bbbbbb></td><td width=1 bgcolor=#ffffff></t"
 +"d><td width=1 bgcolor=#bbbbbb></td><td bgcolor"
 +"=#bbbbbb></td><td width=1 bgcolor=#bbbbbb></td> "
 +"<td width=1 bgcolor=#888888></td><td width=1 bg"
 +"color=#000000></td></tr></table><!-- Title -->"
 +"<table border=0 cellspacing=0 cellpadding=0><t"
 +"r height=18><td width=1 bgcolor=#bbbbbb></td><"
 +"td width=1 bgcolor=#ffffff></td><td width=1 bgco"
 +"lor=#bbbbbb></td><td bgcolor=#000088><img src='photo/shao/title.gif'><img src='photo/shao/a.gif' height=1 width="
 + topBarWidth
 +" name="
 +"'titleBarEmptySpace'></td><td><img src='photo/shao/buttons.gif'></td><td width=1 bgcolor=#bbbbbb></td><td"
 +" width=1 bgcolor=#888888></td><td width=1 bgcolo"
 +"r=#000000></td></tr></table><!-- Menu Bar --> "
 +"<table border=0 cellspacing=0 cellpadding=0> <tr"
 +" height=20 bgcolor=#bbbbbb> <td width=1 bgcolor=#"
 +"bbbbbb></td> <td><img src='photo/shao/menu.gif'></td><td> <"
 +"img src='photo/shao/a.gif' height=1 width="
 + menuBarWidth
 +" name='menuBarEmp"
 +"tySpace'></td> <td width=1 bgcolor=#bbbbbb></td> "
 +"<td width=1 bgcolor=#888888></td> <td width=1 bg"
 +"color=#000000></td> </tr></table> <!-- Mine Fiel"
 +"d --> <table border=0 cellspacing=0 cellpadding=0"
 +"> <tr height=11 width=160> <td width=1 bgcolor=#"
 +"bbbbbb></td> <td width=1 bgcolor=#ffffff></td> <"
 +"td width=1 bgcolor=#bbbbbb></td> <td><img src='photo/shao/tl.gif'></td> <td><img src='photo/shao/header.gif' width="
 + ww2
 +" height=11></td> <td><img src='photo/shao/tr.gif'></td><td><"
 +"img src='photo/shao/right.gif' width=5 height=11></td> </tr>"
 +"</table><table width="
 + totalWidth
 +" border=0 cellspacing=0 cellpadd"
 +"ing=0> <tr height=33> <td width=1 bgcolor=#bbbbb"
 +"b></td> <td width=1 bgcolor=#ffffff></td> <td wi"
 +"dth=1 bgcolor=#bbbbbb></td> <td><img src='photo/shao/cplleft.gif' height=33 width=11></td> <td> <!-- Control"
 +" Panel --> <table width="
 + ww2
 +" border=0 cellspacing="
 +"0 cellpadding=0><tr height=4 width="
 + ww2
 +"><td bgcolor=#bbbbbb"
 +"></td></tr></table> <table width="
 + ww2
 +" border=0 cel"
 +"lspacing=0 cellpadding=0><tr height=26><td "
 +"width=5 bgcolor=#bbbbbb></td><td><!-- Mines Remai"
 +"ning --> <table width=41 border=0 cellspacing=0 c"
 +"ellpadding=0><tr bgcolor=#888888><td></td><td>"
 +"</td><td></td> <td></td><td></td><td></td> <td><"
 +"/td><td></td> <td width=1 bgcolor=#bbbbbb></td></"
 +"tr> <tr bgcolor=#000000> <td width=1 bgcolor=#88"
 +"8888></td> <td></td><td></td> <td></td><td></td>"
 +"<td></td><td></td><td></td> <td width=1 bgcolor"
 +"=#ffffff></td></tr> <tr bgcolor=#000000> <td wid"
 +"th=1 bgcolor=#888888></td> <td width=1 bgcolor=#0"
 +"00000></td> <td><img src='photo/shao/0.gif' name='flag1'></t"
 +"d><td width=2></td><td><img src='photo/shao/1.gif' name='"
 +"flag2'></td><td width=2></td><td><img src='photo/shao/0.gif' name='flag3'></td><td width=1></td> <td wid"
 +"th=1 bgcolor=#ffffff></td></tr> <tr bgcolor=#0000"
 +"00> <td width=1 bgcolor=#888888></td> <td></td><"
 +"td></td> <td></td><td></td><td></td> <td></td><t"
 +"d></td> <td width=1 bgcolor=#ffffff></td></tr> <"
 +"tr bgcolor=#ffffff> <td width=1 bgcolor=#bbbbbb><"
 +"/td> <td></td><td></td> <td></td><td></td><td></"
 +"td> <td></td><td></td> <td></td></tr><"
 +"tr bgcolor=#bbbbbb> <td width=1 bgcolor=#bbbbbb><"
 +"/td> <td></td><td></td> <td></td><td></td><td></"
 +"td> <td></td><td></td> <td></td></tr></table><!--"
 +" End Mines Remaini"
 +"ng --> </td> <td bgcolor=#bbbbbb><img height=1 "
 +"src='a.gif' width=" + cplLeft + "name='cplLeft'>"
 +"<td><img src='photo/shao/btnsmile.gif' name='condition' onmo"
 +"usedown='document.images.condition.s"
 +'rc="photo/shao/btnsmil2.gif"'
 +";' onmouseu"
 +"p='document.images.condition.s"
 +'rc="photo/shao/btnsmile.gif";location.reload();'
 +";'></td> <td width=4 bgcolor=#bbbbbb>"
 +"<img height=1 src='photo/shao/a.gif'"
 +" width=" + cplRight + ">"
 +"</td> <td> <!-- Elapsed Time --> <table width=4"
 +"1 border=0 cellspacing=0 cellpadding=0> <tr bgcol"
 +"or=#888888> <td></td><td></td><td></td> <td></td"
 +"><td></td><td></td><td></td><td></td> <td width"
 +"=1 bgcolor=#bbbbbb></td></tr> <tr bgcolor=#000000"
 +"> <td width=1 bgcolor=#888888></td> <td></td><td"
 +"></td> <td></td><td></td><td></td> <td></td><td>"
 +"</td> <td width=1 bgcolor=#ffffff></td></tr> <tr"
 +" bgcolor=#000000> <td width=1 bgcolor=#888888></t"
 +"d> <td width=1 bgcolor=#000000></td> <td><img sr"
 +"c='photo/shao/0.gif' name='elapse1'></td> <td width=2></td> "
 +"<td><img src='photo/shao/0.gif' name='elapse2'></td> <td wi"
 +"dth=2></td> <td><img src='photo/shao/0.gif' name='elapse3'><"
 +"/td> <td width=1></td> <td width=1 bgcolor=#ffff"
 +"ff></td></tr> <tr bgcolor=#000000> <td width=1 b"
 +"gcolor=#888888></td> <td></td><td></td> <td></td"
 +"><td></td><td></td> <td></td><td></td> <td width"
 +"=1 bgcolor=#ffffff></td></tr> <tr bgcolor=#ffffff"
 +"> <td width=1 bgcolor=#bbbbbb></td> <td></td><td"
 +"></td> <td></td><td></td><td></td> <td></td><td>"
 +"</td> <td></td></tr> <"
 +"tr bgcolor=#bbbbbb> <td width=1 bgcolor=#bbbbbb><"
 +"/td> <td></td><td></td> <td></td><td></td><td></"
 +"td> <td></td><td></td> <td></td></tr> "
 +"</table> <!-- End Elapsed Time --> </td> <td "
 +"width=7 bgcolor=#bbbbbb></td></tr></table><table "
 +"width=" 
 + ww2
 +" border=0 cellspacing=0 cellpadding=0> "
 +"<tr height=3><td bgcolor=#bbbbbb></td></tr></table"
 +"> <!-- End Control Panel --> </td> <td><img src"
 +"='photo/shao/cplright.gif' height=33 width=11></td> <td><img"
 +" src='photo/shao/right.gif' height=33 width=5></td> </tr></t"
 +"able><!-- Separator --> <table border=0 cells"
 +"pacing=0 cellpadding=0> <tr height=11 width="
 + totalWidth
 +"> "
 +"<td width=1 bgcolor=#bbbbbb></td> <td width=1 bg"
 +"color=#ffffff></td> <td width=1 bgcolor=#bbbbbb><"
 +"/td> <td><img src='photo/shao/ml.gif'></td><td><img src='"
 +"photo/shao/separatr.gif' width="
 + wideWidth
 +" height=11></td><td><img"
 +" src='photo/shao/mr.gif'></td><td><img src='photo/shao/right.gif' width"
 +"=5></td></tr></table> <!-- Mine Field --> <table"
 +" width="
 + totalWidth
 +" border=0 cellspacing=0 cellpadding=0> "
 +"<tr height="
 + highHeight
 +"> <td width=1 bgcolor=#bbbbbb></td>"
 +" <td width=1 bgcolor=#ffffff></td> <td width=1 b"
 +"gcolor=#bbbbbb></td> <td><img src='photo/shao/fielside.gif' "
 +"width=12 height="
 + highHeight
 +"></td> <td> <!-- Game Field -"
 +"->");
var s = "";
var x, y;
for(y = 0; y < gridy; ++y) {
for(x = 0; x < gridx; ++x) {
s = s + '<a href="javascript:gridclick(' + y + ',' + x +');">' +
'<img src="' + dir + 'photo/shao/sqt0.gif" name="grd'+y+'_'+x+'" border=0></a>'
}
s = s + "<br>";
}
document.write(s);
document.write('<!-- End Game Field --></td><td'
 +' valign=right><img src="photo/shao/fielside.gif" width=12 heig'
 +'ht='
 + highHeight
 +'></td> <td valign=right><img src="photo/shao/right.gif'
 +'" width=5 height='
 + highHeight
 +'></td></tr></table><!-- En'
 +'d Mine Field --><!-- Footer --><table width='
 + totalWidth
 +' border=0 cellspacing=0 cellpadding=0><tr heigh'
 +'t=12> <td width=1 bgcolor=#bbbbbb></td> <td widt'
 +'h=1 bgcolor=#ffffff></td> <td width=1 bgcolor=#bb'
 +'bbbb></td> <td><img src="photo/shao/bl.gif"></td> <td><img '
 +'src="photo/shao/footer.gif" width='
 + wideWidth
 +' height=12></td> <td><i'
 +'mg src="photo/shao/br.gif"></td> <td><img src="photo/shao/right.gif" he'
 +'ight=12></td></tr></table><!-- Bottom --> <ta'
 +'ble width='
 + totalWidth
 +' border=0 cellspacing=0 cellpadding=0'
 +'> <tr bgcolor=#bbbbbb height=1> <td width=1 bgco'
 +'lor=#bbbbbb></td><td width=1 bgcolor=#ffffff></t'
 +'d> <td width=1 bgcolor=#bbbbbb></td><td width='
 + tW6
 +' bgcolor=#bbbbbb></td><td width=1 bgcolor=#bbb'
 +'bbb></td> <td width=1 bgcolor=#888888></td> <td '
 +'width=1 bgcolor=#000000></td> </tr> <tr height=1'
 +'> <td width=1 bgcolor=#bbbbbb></td> <td width=1 '
 +'bgcolor=#888888></td> <td width=1 bgcolor=#888888'
 +'></td> <td bgcolor=#888888></td> <td width=1 bgc'
 +'olor=#888888></td> <td width=1 bgcolor=#888888></'
 +'td> <td width=1 bgcolor=#000000></td> </tr> <tr'
 +' height=1> <td width=1 bgcolor=#000000></td> <td'
 +' width=1 bgcolor=#000000></td> <td width=1 bgcolo'
 +'r=#000000></td> <td bgcolor=#000000></td> <td wi'
 +'dth=1 bgcolor=#000000></td> <td width=1 bgcolor=#'
 +'000000></td> <td width=1 bgcolor=#000000></td> <'
 +'/tr></table> </div>');
}
// Function to calculate the number of mines adjacent to a grid location
function surrounding(y,x) {
var count = 0;
if (y > 0 && x > 0 && mines[y-1][x-1]) count++;
if (y > 0 && mines[y-1][x]) count++;
if (y > 0 && x < gridx-1 && mines[y-1][x+1]) count++;
if (x > 0 && mines[y][x-1]) count++;
if (x < gridx-1 && mines[y][x+1]) count++;
if (y < gridy-1 && x > 0 && mines[y+1][x-1]) count++;
if (y < gridy-1 && mines[y+1][x]) count++;
if (y < gridy-1 && x < gridx-1 && mines[y+1][x+1]) count++;
return count;
}
// Recursive function to 'roll back' the grid when user clicks on a tile
// with no surrounding mines
function rollback(y,x) {
if (y >= 0 && y < gridy && x >=0 && x < gridx) {
if (shown[y][x] != 3) {
var c = surrounding(y,x);
shown[y][x] = 3;
squaresleft--;
document.images["grd"+y+"_"+x].src = dir + "photo/shao/sq"+c+".gif";
if (c == 0) {
rollback(y-1,x-1);
rollback(y-1,x);
rollback(y-1,x+1);
rollback(y,x-1);
rollback(y,x+1);
rollback(y+1,x-1);
rollback(y+1,x);
rollback(y+1,x+1);
         }
      }
   }
}
// Function called when player steps on a mine. All mine locations are uncovered
function dead() {
var y, x;
for(y = 0; y < gridy; ++y) {
for(x = 0; x < gridx; ++x) {
if (mines[y][x]) {
if (shown[y][x] != 1) {
document.images["grd"+y+"_"+x].src = dir + "photo/shao/mine.gif";
   }
}
else if (shown[y][x] == 1) {
document.images["grd"+y+"_"+x].src = dir + "photo/shao/nomine.gif";
      }
   }
}
document.images.condition.src = dir + "photo/shao/btndead.gif";
playing = false;
clicked = false;
}
// handler called whenever the grid is clicked
function gridclick(y, x) {
if (playing) {
clicked = true;
if (placeflag) {
if (shown[y][x] < 3) {
var s = shown[y][x];
var change = true;
if (s == 1) {
flagsleft++;
squaresleft++;
}
if (flagsleft == 0 && s == 0) {
change = false;
}
else {
if (s == 2) s = 0;
else s++;
if (s == 1) {
flagsleft--;
squaresleft--;
   }
}
if (change) {
shown[y][x] = s;
document.images["grd"+y+"_"+x].src = dir + "photo/shao/sqt"+s+".gif";
setStatus();
}
if (squaresleft == 0) {
document.images.condition.src = dir + "photo/shao/btncool.gif";
playing = false;
      }
   }
}
// check not flagged as a mine
else if (shown[y][x] != 1) {
if (mines[y][x]) {
document.images["grd"+y+"_"+x].src = dir + "photo/shao/minered.gif";
dead();
}
else  {
rollback(y,x);
         }
      }
   }
}
// Start the game
newgame();
//  End -->
</script></fieldset>

<br><br><br>
          <table width="500" border="0" cellspacing="0" cellpadding="0">
            <tr>
              <td>
                <table width="500" border="0" cellspacing="0" cellpadding="0">
                  <tr> 
                    <td bgcolor="#CCCCCC" width="15" height="16">&nbsp;</td>
                    <td width="96" bgcolor="#000000" height="16"> 
                      <div align="center"><font color="#FFFFFF">脚本说明：</font></div>
                    </td>
                    <td width="389" height="16">&nbsp;</td>
                  </tr>
                </table>
              </td>
            </tr>
            <tr>
              <td class="zf">
                <textarea name="textfield" cols="80" rows="10" class="textfield">脚本说明: 
&nbsp;
把如下代码加入<body>区域中
&nbsp;&lt;SCRIPT LANGUAGE=&quot;JavaScript&quot;&gt;

&lt;!-- Begin
dir = &quot;&quot;;
var mines = [];
var shown = [];
var gridx, gridy, maxmines;
gridx = window.prompt(&quot;请输入你想要的行数&quot;,&quot;8&quot;);
gridxverify();
function gridxaccept(){
gridy = window.prompt(&quot;请输入你想要的列数&quot;,&quot;8&quot;);
gridyverify();
}
function gridyaccept(){
maxmines = window.prompt(&quot;请输入你想要的地雷数目&quot;,&quot;10&quot;);
maxminesverify();
}
function gridxverify(){
if (gridx &gt; 50){
alert(&quot;你输入的数字不能超过50.&quot;);
gridxreenter();
}
else if (gridx &lt; 8){
alert(&quot;你输入的数字不能小于8.&quot;);
gridxreenter();
}
else gridxaccept();
}

function gridyverify(){
if (gridy &gt; 50){
alert(&quot;That height is too big. Please enter a new height.&quot;);
gridyreenter();
}
else if (gridy &lt; 8){
alert(&quot;That height is too small. Please enter a new height.&quot;);
gridyreenter();
}
else gridyaccept();
}
function maxminesverify(){
if (maxmines &gt; 500){
alert(&quot;That number is too big. Please enter a new number of mines.&quot;);
maxminesreenter();
}
else if (maxmines &lt; 10){
alert(&quot;That number is too small. Please enter a new number of mines.&quot;);
maxminesreenter();
}
else accepted();
}
// Functions for reentering key variables, if necessary.
function gridxreenter(){
gridx = window.prompt(&quot;Please enter a width.&quot;,&quot;8&quot;);
gridxverify();
}
function gridyreenter(){
gridy = window.prompt(&quot;Please enter a height.&quot;,&quot;8&quot;);
gridyverify();
}
function maxminesreenter(){
maxmines = window.prompt(&quot;Please enter the number of mines you want.&quot;,&quot;10&quot;);
maxminesverify();
}
function accepted(){
var squaresleft, flagsleft;
var elapsedtime;
var playing;
var placeflag;
var clicked;
}
var gridSq = gridx * 16;
var grid8 = gridSq - 128;
var grid16 = gridx - 8
var grid32 = grid16 * 8
var grid64 = grid16 * 16
var topBarWidth = 8 + grid64;
var menuBarWidth = 86 + grid64;
var wideWidth = gridx * 16;
var highHeight = gridy * 16;
var cplLeft = 6 + grid32;
var cplRight = 4 + grid32;
var totalWidth = gridSq + 32;
var tW6 = totalWidth - 6;
var ww2 = wideWidth + 2;
num=new Array(10);
for (var i=0;i&lt;10;i++) {
num[i]=new Image()
num[i].src=i+&quot;.gif&quot;
}
function keyDown(e) {
if(document.layers)
placeflag = (e.modifiers &amp; Event.CONTROL_MASK) &gt; 0;
else
placeflag = window.event.ctrlKey;
setStatus();
}
function keyUp(e) {
placeflag = false;
setStatus();
}
function newgame() {
// reset state arrays. mines holds the position of each mine. shown keeps
// track of the image shown at each grid location
var y;
for(y = 0; y &lt; gridy; ++y)
{
mines[y] = [false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false];
shown[y] = [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0];
}
// Place the mines, making sure positions are unique
var m;
for(m = 0; m &lt; maxmines; ++m) {
var x,y;
do {
x = Math.floor(Math.random() * gridx);
y = Math.floor(Math.random() * gridy);
} while(mines[y][x]);
mines[y][x] = true;
}
// initialize game variables
squaresleft = gridy * gridx;
flagsleft = maxmines;
elapsedtime = 0;
playing = true;
clicked = false
placeflag = false;
// insert the grid into the document
buildgrid();
// Set up keypress handlers
if (document.layers)
window.captureEvents(Event.KEYDOWN | Event.KEYUP);
window.onKeyDown = keyDown;
window.onKeyUp = keyUp;
// start the clock
setInterval(&quot;ticker()&quot;, 1000);
}
// clock tick handler
function ticker() {
if (playing) {
if (clicked) {
elapsedtime++;
setStatus();
   }
  }
}

// Refreshing control panel
function setStatus() {
document.images.elapse3.src=num[elapsedtime-(Math.floor(elapsedtime/10))*10].src;
document.images.elapse2.src=num[Math.floor((elapsedtime-(Math.floor(elapsedtime/100))*100)/10)].src;
document.images.elapse1.src=num[Math.floor(elapsedtime/100)].src;
document.images.flag3.src=num[flagsleft-(Math.floor(flagsleft/10))*10].src;
document.images.flag2.src=num[Math.floor((flagsleft-(Math.floor(flagsleft/100))*100)/10)].src;
document.images.flag1.src=num[Math.floor(flagsleft/100)].src;
}
//function to insert all the IMG tags into the document
function buildgrid() {
document.write(&quot;&lt;!-- Window --&gt;&lt;DIV align=center&gt; &quot;
 +&quot;&lt;!-- Top Bar --&gt; &lt;table width=&quot;
 + totalWidth
 +&quot; border=0 cells&quot;
 +&quot;pacing=0 cellpadding=0&gt; &lt;tr bgcolor=#bbbbbb heigh&quot;
 +&quot;t=1&gt; &lt;td width=1 bgcolor=#bbbbbb&gt;&lt;/td&gt;&lt;td width&quot;
 +&quot;=1 bgcolor=#bbbbbb&gt;&lt;/td&gt; &lt;td width=1 bgcolor=#bbb&quot;
 +&quot;bbb&gt;&lt;/td&gt;&lt;td width=&quot;
 + tW6
 +&quot; bgcolor=#bbbbbb&gt;&lt;/td&gt; &lt;t&quot;
 +&quot;d width=1 bgcolor=#bbbbbb&gt;&lt;/td&gt; &lt;td width=1 bgcol&quot;
 +&quot;or=#bbbbbb&gt;&lt;/td&gt; &lt;td width=1 bgcolor=#000000&gt;&lt;/td&quot;
 +&quot;&gt;&lt;/tr&gt;&lt;tr height=1&gt;&lt;td width=1 bgcolor=#bbbb&quot;
 +&quot;bb&gt;&lt;/td&gt;&lt;td width=1 bgcolor=#ffffff&gt;&lt;/td&gt;&lt;td w&quot;
 +&quot;idth=1 bgcolor=#ffffff&gt;&lt;/td&gt;&lt;td bgcolor=#ffffff&gt;&quot;
 +&quot;&lt;/td&gt;&lt;td width=1 bgcolor=#ffffff&gt;&lt;/td&gt;&lt;td widt&quot;
 +&quot;h=1 bgcolor=#888888&gt;&lt;/td&gt;&lt;td width=1 bgcolor=#00&quot;
 +&quot;0000&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr height=1&gt;&lt;td width=1 bgco&quot;
 +&quot;lor=#bbbbbb&gt;&lt;/td&gt;&lt;td width=1 bgcolor=#ffffff&gt;&lt;/t&quot;
 +&quot;d&gt;&lt;td width=1 bgcolor=#bbbbbb&gt;&lt;/td&gt;&lt;td bgcolor&quot;
 +&quot;=#bbbbbb&gt;&lt;/td&gt;&lt;td width=1 bgcolor=#bbbbbb&gt;&lt;/td&gt; &quot;
 +&quot;&lt;td width=1 bgcolor=#888888&gt;&lt;/td&gt;&lt;td width=1 bg&quot;
 +&quot;color=#000000&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;!-- Title --&gt;&quot;
 +&quot;&lt;table border=0 cellspacing=0 cellpadding=0&gt;&lt;t&quot;
 +&quot;r height=18&gt;&lt;td width=1 bgcolor=#bbbbbb&gt;&lt;/td&gt;&lt;&quot;
 +&quot;td width=1 bgcolor=#ffffff&gt;&lt;/td&gt;&lt;td width=1 bgco&quot;
 +&quot;lor=#bbbbbb&gt;&lt;/td&gt;&lt;td bgcolor=#000088&gt;&lt;img src='photo/shao/title.gif'&gt;&lt;img src='photo/shao/a.gif' height=1 width=&quot;
 + topBarWidth
 +&quot; name=&quot;
 +&quot;'titleBarEmptySpace'&gt;&lt;/td&gt;&lt;td&gt;&lt;img src='photo/shao/buttons.gif'&gt;&lt;/td&gt;&lt;td width=1 bgcolor=#bbbbbb&gt;&lt;/td&gt;&lt;td&quot;
 +&quot; width=1 bgcolor=#888888&gt;&lt;/td&gt;&lt;td width=1 bgcolo&quot;
 +&quot;r=#000000&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;!-- Menu Bar --&gt; &quot;
 +&quot;&lt;table border=0 cellspacing=0 cellpadding=0&gt; &lt;tr&quot;
 +&quot; height=20 bgcolor=#bbbbbb&gt; &lt;td width=1 bgcolor=#&quot;
 +&quot;bbbbbb&gt;&lt;/td&gt; &lt;td&gt;&lt;img src='photo/shao/menu.gif'&gt;&lt;/td&gt;&lt;td&gt; &lt;&quot;
 +&quot;img src='photo/shao/a.gif' height=1 width=&quot;
 + menuBarWidth
 +&quot; name='menuBarEmp&quot;
 +&quot;tySpace'&gt;&lt;/td&gt; &lt;td width=1 bgcolor=#bbbbbb&gt;&lt;/td&gt; &quot;
 +&quot;&lt;td width=1 bgcolor=#888888&gt;&lt;/td&gt; &lt;td width=1 bg&quot;
 +&quot;color=#000000&gt;&lt;/td&gt; &lt;/tr&gt;&lt;/table&gt; &lt;!-- Mine Fiel&quot;
 +&quot;d --&gt; &lt;table border=0 cellspacing=0 cellpadding=0&quot;
 +&quot;&gt; &lt;tr height=11 width=160&gt; &lt;td width=1 bgcolor=#&quot;
 +&quot;bbbbbb&gt;&lt;/td&gt; &lt;td width=1 bgcolor=#ffffff&gt;&lt;/td&gt; &lt;&quot;
 +&quot;td width=1 bgcolor=#bbbbbb&gt;&lt;/td&gt; &lt;td&gt;&lt;img src='photo/shao/tl.gif'&gt;&lt;/td&gt; &lt;td&gt;&lt;img src='photo/shao/header.gif' width=&quot;
 + ww2
 +&quot; height=11&gt;&lt;/td&gt; &lt;td&gt;&lt;img src='photo/shao/tr.gif'&gt;&lt;/td&gt;&lt;td&gt;&lt;&quot;
 +&quot;img src='photo/shao/right.gif' width=5 height=11&gt;&lt;/td&gt; &lt;/tr&gt;&quot;
 +&quot;&lt;/table&gt;&lt;table width=&quot;
 + totalWidth
 +&quot; border=0 cellspacing=0 cellpadd&quot;
 +&quot;ing=0&gt; &lt;tr height=33&gt; &lt;td width=1 bgcolor=#bbbbb&quot;
 +&quot;b&gt;&lt;/td&gt; &lt;td width=1 bgcolor=#ffffff&gt;&lt;/td&gt; &lt;td wi&quot;
 +&quot;dth=1 bgcolor=#bbbbbb&gt;&lt;/td&gt; &lt;td&gt;&lt;img src='photo/shao/cplleft.gif' height=33 width=11&gt;&lt;/td&gt; &lt;td&gt; &lt;!-- Control&quot;
 +&quot; Panel --&gt; &lt;table width=&quot;
 + ww2
 +&quot; border=0 cellspacing=&quot;
 +&quot;0 cellpadding=0&gt;&lt;tr height=4 width=&quot;
 + ww2
 +&quot;&gt;&lt;td bgcolor=#bbbbbb&quot;
 +&quot;&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt; &lt;table width=&quot;
 + ww2
 +&quot; border=0 cel&quot;
 +&quot;lspacing=0 cellpadding=0&gt;&lt;tr height=26&gt;&lt;td &quot;
 +&quot;width=5 bgcolor=#bbbbbb&gt;&lt;/td&gt;&lt;td&gt;&lt;!-- Mines Remai&quot;
 +&quot;ning --&gt; &lt;table width=41 border=0 cellspacing=0 c&quot;
 +&quot;ellpadding=0&gt;&lt;tr bgcolor=#888888&gt;&lt;td&gt;&lt;/td&gt;&lt;td&gt;&quot;
 +&quot;&lt;/td&gt;&lt;td&gt;&lt;/td&gt; &lt;td&gt;&lt;/td&gt;&lt;td&gt;&lt;/td&gt;&lt;td&gt;&lt;/td&gt; &lt;td&gt;&lt;&quot;
 +&quot;/td&gt;&lt;td&gt;&lt;/td&gt; &lt;td width=1 bgcolor=#bbbbbb&gt;&lt;/td&gt;&lt;/&quot;
 +&quot;tr&gt; &lt;tr bgcolor=#000000&gt; &lt;td width=1 bgcolor=#88&quot;
 +&quot;8888&gt;&lt;/td&gt; &lt;td&gt;&lt;/td&gt;&lt;td&gt;&lt;/td&gt; &lt;td&gt;&lt;/td&gt;&lt;td&gt;&lt;/td&gt;&quot;
 +&quot;&lt;td&gt;&lt;/td&gt;&lt;td&gt;&lt;/td&gt;&lt;td&gt;&lt;/td&gt; &lt;td width=1 bgcolor&quot;
 +&quot;=#ffffff&gt;&lt;/td&gt;&lt;/tr&gt; &lt;tr bgcolor=#000000&gt; &lt;td wid&quot;
 +&quot;th=1 bgcolor=#888888&gt;&lt;/td&gt; &lt;td width=1 bgcolor=#0&quot;
 +&quot;00000&gt;&lt;/td&gt; &lt;td&gt;&lt;img src='photo/shao/0.gif' name='flag1'&gt;&lt;/t&quot;
 +&quot;d&gt;&lt;td width=2&gt;&lt;/td&gt;&lt;td&gt;&lt;img src='photo/shao/1.gif' name='&quot;
 +&quot;flag2'&gt;&lt;/td&gt;&lt;td width=2&gt;&lt;/td&gt;&lt;td&gt;&lt;img src='photo/shao/0.gif' name='flag3'&gt;&lt;/td&gt;&lt;td width=1&gt;&lt;/td&gt; &lt;td wid&quot;
 +&quot;th=1 bgcolor=#ffffff&gt;&lt;/td&gt;&lt;/tr&gt; &lt;tr bgcolor=#0000&quot;
 +&quot;00&gt; &lt;td width=1 bgcolor=#888888&gt;&lt;/td&gt; &lt;td&gt;&lt;/td&gt;&lt;&quot;
 +&quot;td&gt;&lt;/td&gt; &lt;td&gt;&lt;/td&gt;&lt;td&gt;&lt;/td&gt;&lt;td&gt;&lt;/td&gt; &lt;td&gt;&lt;/td&gt;&lt;t&quot;
 +&quot;d&gt;&lt;/td&gt; &lt;td width=1 bgcolor=#ffffff&gt;&lt;/td&gt;&lt;/tr&gt; &lt;&quot;
 +&quot;tr bgcolor=#ffffff&gt; &lt;td width=1 bgcolor=#bbbbbb&gt;&lt;&quot;
 +&quot;/td&gt; &lt;td&gt;&lt;/td&gt;&lt;td&gt;&lt;/td&gt; &lt;td&gt;&lt;/td&gt;&lt;td&gt;&lt;/td&gt;&lt;td&gt;&lt;/&quot;
 +&quot;td&gt; &lt;td&gt;&lt;/td&gt;&lt;td&gt;&lt;/td&gt; &lt;td&gt;&lt;/td&gt;&lt;/tr&gt;&lt;&quot;
 +&quot;tr bgcolor=#bbbbbb&gt; &lt;td width=1 bgcolor=#bbbbbb&gt;&lt;&quot;
 +&quot;/td&gt; &lt;td&gt;&lt;/td&gt;&lt;td&gt;&lt;/td&gt; &lt;td&gt;&lt;/td&gt;&lt;td&gt;&lt;/td&gt;&lt;td&gt;&lt;/&quot;
 +&quot;td&gt; &lt;td&gt;&lt;/td&gt;&lt;td&gt;&lt;/td&gt; &lt;td&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;!--&quot;
 +&quot; End Mines Remaini&quot;
 +&quot;ng --&gt; &lt;/td&gt; &lt;td bgcolor=#bbbbbb&gt;&lt;img height=1 &quot;
 +&quot;src='a.gif' width=&quot; + cplLeft + &quot;name='cplLeft'&gt;&quot;
 +&quot;&lt;td&gt;&lt;img src='photo/shao/btnsmile.gif' name='condition' onmo&quot;
 +&quot;usedown='document.images.condition.s&quot;
 +'rc=&quot;photo/shao/btnsmil2.gif&quot;'
 +&quot;;' onmouseu&quot;
 +&quot;p='document.images.condition.s&quot;
 +'rc=&quot;photo/shao/btnsmile.gif&quot;;location.reload();'
 +&quot;;'&gt;&lt;/td&gt; &lt;td width=4 bgcolor=#bbbbbb&gt;&quot;
 +&quot;&lt;img height=1 src='photo/shao/a.gif'&quot;
 +&quot; width=&quot; + cplRight + &quot;&gt;&quot;
 +&quot;&lt;/td&gt; &lt;td&gt; &lt;!-- Elapsed Time --&gt; &lt;table width=4&quot;
 +&quot;1 border=0 cellspacing=0 cellpadding=0&gt; &lt;tr bgcol&quot;
 +&quot;or=#888888&gt; &lt;td&gt;&lt;/td&gt;&lt;td&gt;&lt;/td&gt;&lt;td&gt;&lt;/td&gt; &lt;td&gt;&lt;/td&quot;
 +&quot;&gt;&lt;td&gt;&lt;/td&gt;&lt;td&gt;&lt;/td&gt;&lt;td&gt;&lt;/td&gt;&lt;td&gt;&lt;/td&gt; &lt;td width&quot;
 +&quot;=1 bgcolor=#bbbbbb&gt;&lt;/td&gt;&lt;/tr&gt; &lt;tr bgcolor=#000000&quot;
 +&quot;&gt; &lt;td width=1 bgcolor=#888888&gt;&lt;/td&gt; &lt;td&gt;&lt;/td&gt;&lt;td&quot;
 +&quot;&gt;&lt;/td&gt; &lt;td&gt;&lt;/td&gt;&lt;td&gt;&lt;/td&gt;&lt;td&gt;&lt;/td&gt; &lt;td&gt;&lt;/td&gt;&lt;td&gt;&quot;
 +&quot;&lt;/td&gt; &lt;td width=1 bgcolor=#ffffff&gt;&lt;/td&gt;&lt;/tr&gt; &lt;tr&quot;
 +&quot; bgcolor=#000000&gt; &lt;td width=1 bgcolor=#888888&gt;&lt;/t&quot;
 +&quot;d&gt; &lt;td width=1 bgcolor=#000000&gt;&lt;/td&gt; &lt;td&gt;&lt;img sr&quot;
 +&quot;c='photo/shao/0.gif' name='elapse1'&gt;&lt;/td&gt; &lt;td width=2&gt;&lt;/td&gt; &quot;
 +&quot;&lt;td&gt;&lt;img src='photo/shao/0.gif' name='elapse2'&gt;&lt;/td&gt; &lt;td wi&quot;
 +&quot;dth=2&gt;&lt;/td&gt; &lt;td&gt;&lt;img src='photo/shao/0.gif' name='elapse3'&gt;&lt;&quot;
 +&quot;/td&gt; &lt;td width=1&gt;&lt;/td&gt; &lt;td width=1 bgcolor=#ffff&quot;
 +&quot;ff&gt;&lt;/td&gt;&lt;/tr&gt; &lt;tr bgcolor=#000000&gt; &lt;td width=1 b&quot;
 +&quot;gcolor=#888888&gt;&lt;/td&gt; &lt;td&gt;&lt;/td&gt;&lt;td&gt;&lt;/td&gt; &lt;td&gt;&lt;/td&quot;
 +&quot;&gt;&lt;td&gt;&lt;/td&gt;&lt;td&gt;&lt;/td&gt; &lt;td&gt;&lt;/td&gt;&lt;td&gt;&lt;/td&gt; &lt;td width&quot;
 +&quot;=1 bgcolor=#ffffff&gt;&lt;/td&gt;&lt;/tr&gt; &lt;tr bgcolor=#ffffff&quot;
 +&quot;&gt; &lt;td width=1 bgcolor=#bbbbbb&gt;&lt;/td&gt; &lt;td&gt;&lt;/td&gt;&lt;td&quot;
 +&quot;&gt;&lt;/td&gt; &lt;td&gt;&lt;/td&gt;&lt;td&gt;&lt;/td&gt;&lt;td&gt;&lt;/td&gt; &lt;td&gt;&lt;/td&gt;&lt;td&gt;&quot;
 +&quot;&lt;/td&gt; &lt;td&gt;&lt;/td&gt;&lt;/tr&gt; &lt;&quot;
 +&quot;tr bgcolor=#bbbbbb&gt; &lt;td width=1 bgcolor=#bbbbbb&gt;&lt;&quot;
 +&quot;/td&gt; &lt;td&gt;&lt;/td&gt;&lt;td&gt;&lt;/td&gt; &lt;td&gt;&lt;/td&gt;&lt;td&gt;&lt;/td&gt;&lt;td&gt;&lt;/&quot;
 +&quot;td&gt; &lt;td&gt;&lt;/td&gt;&lt;td&gt;&lt;/td&gt; &lt;td&gt;&lt;/td&gt;&lt;/tr&gt; &quot;
 +&quot;&lt;/table&gt; &lt;!-- End Elapsed Time --&gt; &lt;/td&gt; &lt;td &quot;
 +&quot;width=7 bgcolor=#bbbbbb&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;table &quot;
 +&quot;width=&quot; 
 + ww2
 +&quot; border=0 cellspacing=0 cellpadding=0&gt; &quot;
 +&quot;&lt;tr height=3&gt;&lt;td bgcolor=#bbbbbb&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&quot;
 +&quot;&gt; &lt;!-- End Control Panel --&gt; &lt;/td&gt; &lt;td&gt;&lt;img src&quot;
 +&quot;='photo/shao/cplright.gif' height=33 width=11&gt;&lt;/td&gt; &lt;td&gt;&lt;img&quot;
 +&quot; src='photo/shao/right.gif' height=33 width=5&gt;&lt;/td&gt; &lt;/tr&gt;&lt;/t&quot;
 +&quot;able&gt;&lt;!-- Separator --&gt; &lt;table border=0 cells&quot;
 +&quot;pacing=0 cellpadding=0&gt; &lt;tr height=11 width=&quot;
 + totalWidth
 +&quot;&gt; &quot;
 +&quot;&lt;td width=1 bgcolor=#bbbbbb&gt;&lt;/td&gt; &lt;td width=1 bg&quot;
 +&quot;color=#ffffff&gt;&lt;/td&gt; &lt;td width=1 bgcolor=#bbbbbb&gt;&lt;&quot;
 +&quot;/td&gt; &lt;td&gt;&lt;img src='photo/shao/ml.gif'&gt;&lt;/td&gt;&lt;td&gt;&lt;img src='&quot;
 +&quot;photo/shao/separatr.gif' width=&quot;
 + wideWidth
 +&quot; height=11&gt;&lt;/td&gt;&lt;td&gt;&lt;img&quot;
 +&quot; src='photo/shao/mr.gif'&gt;&lt;/td&gt;&lt;td&gt;&lt;img src='photo/shao/right.gif' width&quot;
 +&quot;=5&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt; &lt;!-- Mine Field --&gt; &lt;table&quot;
 +&quot; width=&quot;
 + totalWidth
 +&quot; border=0 cellspacing=0 cellpadding=0&gt; &quot;
 +&quot;&lt;tr height=&quot;
 + highHeight
 +&quot;&gt; &lt;td width=1 bgcolor=#bbbbbb&gt;&lt;/td&gt;&quot;
 +&quot; &lt;td width=1 bgcolor=#ffffff&gt;&lt;/td&gt; &lt;td width=1 b&quot;
 +&quot;gcolor=#bbbbbb&gt;&lt;/td&gt; &lt;td&gt;&lt;img src='photo/shao/fielside.gif' &quot;
 +&quot;width=12 height=&quot;
 + highHeight
 +&quot;&gt;&lt;/td&gt; &lt;td&gt; &lt;!-- Game Field -&quot;
 +&quot;-&gt;&quot;);
var s = &quot;&quot;;
var x, y;
for(y = 0; y &lt; gridy; ++y) {
for(x = 0; x &lt; gridx; ++x) {
s = s + '&lt;a href=&quot;javascript:gridclick(' + y + ',' + x +');&quot;&gt;' +
'&lt;img src=&quot;' + dir + 'photo/shao/sqt0.gif&quot; name=&quot;grd'+y+'_'+x+'&quot; border=0&gt;&lt;/a&gt;'
}
s = s + &quot;&lt;br&gt;&quot;;
}
document.write(s);
document.write('&lt;!-- End Game Field --&gt;&lt;/td&gt;&lt;td'
 +' valign=right&gt;&lt;img src=&quot;photo/shao/fielside.gif&quot; width=12 heig'
 +'ht='
 + highHeight
 +'&gt;&lt;/td&gt; &lt;td valign=right&gt;&lt;img src=&quot;photo/shao/right.gif'
 +'&quot; width=5 height='
 + highHeight
 +'&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;!-- En'
 +'d Mine Field --&gt;&lt;!-- Footer --&gt;&lt;table width='
 + totalWidth
 +' border=0 cellspacing=0 cellpadding=0&gt;&lt;tr heigh'
 +'t=12&gt; &lt;td width=1 bgcolor=#bbbbbb&gt;&lt;/td&gt; &lt;td widt'
 +'h=1 bgcolor=#ffffff&gt;&lt;/td&gt; &lt;td width=1 bgcolor=#bb'
 +'bbbb&gt;&lt;/td&gt; &lt;td&gt;&lt;img src=&quot;photo/shao/bl.gif&quot;&gt;&lt;/td&gt; &lt;td&gt;&lt;img '
 +'src=&quot;photo/shao/footer.gif&quot; width='
 + wideWidth
 +' height=12&gt;&lt;/td&gt; &lt;td&gt;&lt;i'
 +'mg src=&quot;photo/shao/br.gif&quot;&gt;&lt;/td&gt; &lt;td&gt;&lt;img src=&quot;photo/shao/right.gif&quot; he'
 +'ight=12&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;!-- Bottom --&gt; &lt;ta'
 +'ble width='
 + totalWidth
 +' border=0 cellspacing=0 cellpadding=0'
 +'&gt; &lt;tr bgcolor=#bbbbbb height=1&gt; &lt;td width=1 bgco'
 +'lor=#bbbbbb&gt;&lt;/td&gt;&lt;td width=1 bgcolor=#ffffff&gt;&lt;/t'
 +'d&gt; &lt;td width=1 bgcolor=#bbbbbb&gt;&lt;/td&gt;&lt;td width='
 + tW6
 +' bgcolor=#bbbbbb&gt;&lt;/td&gt;&lt;td width=1 bgcolor=#bbb'
 +'bbb&gt;&lt;/td&gt; &lt;td width=1 bgcolor=#888888&gt;&lt;/td&gt; &lt;td '
 +'width=1 bgcolor=#000000&gt;&lt;/td&gt; &lt;/tr&gt; &lt;tr height=1'
 +'&gt; &lt;td width=1 bgcolor=#bbbbbb&gt;&lt;/td&gt; &lt;td width=1 '
 +'bgcolor=#888888&gt;&lt;/td&gt; &lt;td width=1 bgcolor=#888888'
 +'&gt;&lt;/td&gt; &lt;td bgcolor=#888888&gt;&lt;/td&gt; &lt;td width=1 bgc'
 +'olor=#888888&gt;&lt;/td&gt; &lt;td width=1 bgcolor=#888888&gt;&lt;/'
 +'td&gt; &lt;td width=1 bgcolor=#000000&gt;&lt;/td&gt; &lt;/tr&gt; &lt;tr'
 +' height=1&gt; &lt;td width=1 bgcolor=#000000&gt;&lt;/td&gt; &lt;td'
 +' width=1 bgcolor=#000000&gt;&lt;/td&gt; &lt;td width=1 bgcolo'
 +'r=#000000&gt;&lt;/td&gt; &lt;td bgcolor=#000000&gt;&lt;/td&gt; &lt;td wi'
 +'dth=1 bgcolor=#000000&gt;&lt;/td&gt; &lt;td width=1 bgcolor=#'
 +'000000&gt;&lt;/td&gt; &lt;td width=1 bgcolor=#000000&gt;&lt;/td&gt; &lt;'
 +'/tr&gt;&lt;/table&gt; &lt;/div&gt;');
}
// Function to calculate the number of mines adjacent to a grid location
function surrounding(y,x) {
var count = 0;
if (y &gt; 0 &amp;&amp; x &gt; 0 &amp;&amp; mines[y-1][x-1]) count++;
if (y &gt; 0 &amp;&amp; mines[y-1][x]) count++;
if (y &gt; 0 &amp;&amp; x &lt; gridx-1 &amp;&amp; mines[y-1][x+1]) count++;
if (x &gt; 0 &amp;&amp; mines[y][x-1]) count++;
if (x &lt; gridx-1 &amp;&amp; mines[y][x+1]) count++;
if (y &lt; gridy-1 &amp;&amp; x &gt; 0 &amp;&amp; mines[y+1][x-1]) count++;
if (y &lt; gridy-1 &amp;&amp; mines[y+1][x]) count++;
if (y &lt; gridy-1 &amp;&amp; x &lt; gridx-1 &amp;&amp; mines[y+1][x+1]) count++;
return count;
}
// Recursive function to 'roll back' the grid when user clicks on a tile
// with no surrounding mines
function rollback(y,x) {
if (y &gt;= 0 &amp;&amp; y &lt; gridy &amp;&amp; x &gt;=0 &amp;&amp; x &lt; gridx) {
if (shown[y][x] != 3) {
var c = surrounding(y,x);
shown[y][x] = 3;
squaresleft--;
document.images[&quot;grd&quot;+y+&quot;_&quot;+x].src = dir + &quot;photo/shao/sq&quot;+c+&quot;.gif&quot;;
if (c == 0) {
rollback(y-1,x-1);
rollback(y-1,x);
rollback(y-1,x+1);
rollback(y,x-1);
rollback(y,x+1);
rollback(y+1,x-1);
rollback(y+1,x);
rollback(y+1,x+1);
         }
      }
   }
}
// Function called when player steps on a mine. All mine locations are uncovered
function dead() {
var y, x;
for(y = 0; y &lt; gridy; ++y) {
for(x = 0; x &lt; gridx; ++x) {
if (mines[y][x]) {
if (shown[y][x] != 1) {
document.images[&quot;grd&quot;+y+&quot;_&quot;+x].src = dir + &quot;photo/shao/mine.gif&quot;;
   }
}
else if (shown[y][x] == 1) {
document.images[&quot;grd&quot;+y+&quot;_&quot;+x].src = dir + &quot;photo/shao/nomine.gif&quot;;
      }
   }
}
document.images.condition.src = dir + &quot;photo/shao/btndead.gif&quot;;
playing = false;
clicked = false;
}
// handler called whenever the grid is clicked
function gridclick(y, x) {
if (playing) {
clicked = true;
if (placeflag) {
if (shown[y][x] &lt; 3) {
var s = shown[y][x];
var change = true;
if (s == 1) {
flagsleft++;
squaresleft++;
}
if (flagsleft == 0 &amp;&amp; s == 0) {
change = false;
}
else {
if (s == 2) s = 0;
else s++;
if (s == 1) {
flagsleft--;
squaresleft--;
   }
}
if (change) {
shown[y][x] = s;
document.images[&quot;grd&quot;+y+&quot;_&quot;+x].src = dir + &quot;photo/shao/sqt&quot;+s+&quot;.gif&quot;;
setStatus();
}
if (squaresleft == 0) {
document.images.condition.src = dir + &quot;photo/shao/btncool.gif&quot;;
playing = false;
      }
   }
}
// check not flagged as a mine
else if (shown[y][x] != 1) {
if (mines[y][x]) {
document.images[&quot;grd&quot;+y+&quot;_&quot;+x].src = dir + &quot;photo/shao/minered.gif&quot;;
dead();
}
else  {
rollback(y,x);
         }
      }
   }
}
// Start the game
newgame();
//  End --&gt;
&lt;/script&gt;



&nbsp;

</textarea>
              </td>
            </tr>
          </table>
        </div>
      </td>
    </tr>
  </table>
  <hr width="770">
   <table width="770" border="0" cellspacing="0" cellpadding="0" height="21">
    <tr>
      <td bgcolor="#CCCCCC" valign="middle">
        <div align="center"><script language=javascript src=buttom.js></script></div>
      </td>
    </tr>
    <tr>
      <td>
        <div align="center"></div>
      </td>
    </tr>
  </table>
</div>
</body>
</html>
